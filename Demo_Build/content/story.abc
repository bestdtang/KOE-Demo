@resume
	*say
		Welcome back! Do you want to continue your story from where you last left
        off? [Action]
	*then
		hear yes,sure {
            >> RESUME
        }
        hear no {
            -> start
        }

@start
	*show
		template: 'default'
        background:'https://koetest.s3.amazonaws.com/visuals/Dessert/dessertAll.png'
        title: ''
        subtitle: ''
	*say
		<audio src='https://koetest.s3.amazonaws.com/bgm/musicBeginning.mp3'/>
		Greetings, explorer. [Short_Pause] Welcome to the Desert Traveler experience! [Short_Pause] In this five-act interactive story, you can stop and come back at any time. Now you can start from the very beginning and experience the exciting journey; And you can also jump to the in-game puzzles directly and enjoy solving it, which will take shorter time. Which do you prefer? Story or puzzle?[Action]
	*then
		set currentLocation as 'desert'
		hear story {
			unflag skip
		    -> Lost in Desert
	    }
	    hear puzzle {
			flag skip
	        -> jumptopuzzle
        }

@Quit Game
	*say
        OK. Bye~
    *then
        >> END

@Lost in Desert
	*say
		Ok then. Sit back and enjoy.
		<audio src='https://koetest.s3.amazonaws.com/Act1/wind.mp3'/>
		Oh dear, it's a hot, hot desert. You walk aimlessly in the sand, thirsty for water. 
		//The wind is hot, the sun is hot, and the air is burning hot. [Pause] 
		<audio src='https://koetest.s3.amazonaws.com/Act1/gulp.mp3'/>
		In the middle of the hot desert, you find a rusty, old signpost. It has two arrows pointing to the right and the left. However, the letters have faded away.
	*then
		-> Tutorial 1: Direction Questions

@Tutorial 1: Direction Questions
	*say
		Do you want to go left, or go right? [Action]
	*then
		hear go left, left {
			-> Look Left
		}

		hear go right, right {
			-> Look Right
		}
	*reprompt
		You can say, look left or look right.
	*recap
		[Pause]

@Look Right
	*show
		template: 'default'
        background:'https://koetest.s3.amazonaws.com/visuals/Dessert/walking2.png'
        title: ''
        subtitle: ''
	*say
		You wipe your face with your dry hands and decide to turn right. Then, you keep treading the sea of sand wearily.
		
	*then
		-> Tutorial 1A: Check Around

@Tutorial 1A: Check Around
	*show
		template: 'default'
        background:'https://koetest.s3.amazonaws.com/visuals/Dessert/walking2.png'
        title: ''
        subtitle: ''
	*say
		<audio src='https://koetest.s3.amazonaws.com/Act1/windFootsteps.mp3'/> 
		You walk under the hot sun until you reach the top of a little sand hill. 
		It let's you see a little bit further away. Now you can see what's around you. [Pause] Sometimes, paths aren't obvious at first glance.
		You can check around first by saying what's around me. Go on, give it a try. [Action]
		
		
	*then
		hear what's around me,check, what is around me, check what's around me, around me {
            -> Check Around the Hill
        }
	*reprompt
		You can check around by saying "what's around me".
	*recap
		You can check around by saying "what's around me".

@Check Around the Hill
	*show
		template: 'default'
        background:'https://koetest.s3.amazonaws.com/visuals/Dessert/dessertAll.png'
        title: ''
        subtitle: ''
	*say
		You look around. 
		//You don't find anything particularly interesting. [Pause] Wait! 
		You see a few specks on the yellow surfaces of Earth. It shines under the burning sun! 
		//You squint your eyes and look closer. [Pause] 
		It's a town! [Short_Pause]
		There's a good chance that they have some water there.
		[Action]
	*then
		hear go to the town, go towards the town, town, the town, go, ok, yes {
		    set currentLocation as 'town'
             -> Go to Town
         }
	*reprompt
		You're thirsty, and there's seems like a town out there.
	*recap
		You're thirsty, and there's seems like a town out there. Perhaps you should go there?

@Go to Town
	*say
		//Quick! There might be water there.
		<audio src='https://koetest.s3.amazonaws.com/Act1/sandRun3s.mp3'/> 
		The promise of cold water entering you drags your weary feet to the entrance of the town. 
	*then
		-> Town

@Town
	*say
		//The urge of letting cold water pass enter you drags your weary feet to the entrance of the town. 
		Surely the townspeople will rush to help a thirsty traveler, [Short_Pause] but No-one came. Where is everyone?
		Where should you go? [Action]
	*recap
		Try to saying, what's around me.[Action]
	*reprompt
		Try to saying, what's around me.[Action]
	*then
		hear what's around me {
			-> Around 
		}

@Around
	*say
		You're at the entrance of the town. Some small buildings align on the sides of the street. But all of their doors are shut tight. 
		Only a few people are walking on the streets. It's almost as if they're trying to avoid having eye-contact with you. [Short_Pause] Also. Something smells bad.
	*reprompt
		There are a few establishments right in front of you. A general store and the mayor's office. Which one should you go to?
	*recap
		There are a few establishments right in front of you. A general store and the mayor's office. Which one should you go to?
	*then
		-> Around_1

@Around_1
	*say
		There are a few establishments right in front of you. A general store and the mayor's office. Which one should you go to? [Action]
	*recap
		There are a few establishments right in front of you. A general store and the mayor's office. Which one should you go to?[Action]
	*reprompt
		Do you want to go to the general store or the mayor's office?
	*then
		hear mayor's office, office, mayor, go to mayor's office {
		    set currentLocation as 'mayors office'
			-> Mayor Office
		}
		hear general store, general, store, go to the general store {
		    set currentLocation as 'general store'
			-> Store
		}

@Store
	*say
		Upon approaching the general store, you see a boy. He wears a red coat, and he looks very surprised. [Pause]
		[Kid] 
		You are a new face here. Do you need help? [Short_Pause] You don't look well. Is there anything I can help you? [EOA] 
		//Maybe the little boy has water. 
		//[Action]
		//Perhaps you should try asking. 
		//[Conversation] 
		//When you hear this sound, you decide what to say to the other person next. For example, right now you can ask the boy for water. [Short_Pause] Try it! [Conversation]
	*then
		hear thirsty, water, can I have some water, can you give me water, do you have water, do you have any water, ask for water, ask the boy, ask the boy for water, give me some water, give me water {
			-> Boy
		}
	*recap
		Try asking the boy for water [Conversation]
	*reprompt
		Try asking the boy for water [Conversation]

@Boy
	*say
		//You asked the boy for some water. 
		[Kid] 
	    I can help you with that. [Short_Pause] 
	    //But I must warn you before I take you into our place. 
	    Just a heads up. You probably already noticed that there's a bad smell. Well, it gets worse indoors. [Short_Pause]
	    [EOA] [Pause]
		The boy takes you around the building and enters the store from the backdoor. 
		<audio src='https://koetest.s3.amazonaws.com/Act1/openWoodDoor.mp3'/>
		Oh dear. [Pause] The store stinks, like really really stinks. it smells like someone's wearing the same pair of socks for over a year. [Pause]
		[Kid] Yeah. Told you! [Pause] [EOA] 
		[Pause] A bald, middle-aged man slowly walks down the stairs.
		<audio src='https://koetest.s3.amazonaws.com/Act1/woodenFloorCracking.mp3'/>
		[Kid] Papa! [Pause] [EOA] 
		//Small pieces of tissue paper are rolled and stuck in his nose. He looks like he could use some more sunshine.
	*recap
		The boy took you to his father's general store.
	*then
		-> Shopkeeper

@Shopkeeper
	*say
		[Man]
        Who is this person? [Pause] Why did you bring a stranger that looks like a dying cactus to this place? [EOA] 
        [Kid] 
        [Pause]Relax, papa. He's just a traveler. And he needs water. [Pause]A lot of water.[EOA] 
        //[Man] 
        //Water? [Pause] Hah! I got lots of water. As if water would do anything to wash this stench away.[EOA] 
        [Pause] 
        The young boy's father handed you a big glass of water. 
        [Man]
        Hey. Don't worry. I know it smells bad in here. But I assure you, the water is clean. [EOA]
		
        The water looks ok, but it smells bad. Are you sure you want to drink it? [Action]
	*then
		hear drink water, use water, use the water, water, chug, yes {
			-> Finding Out
		}
		hear don't drink the water, don't, no, do nothing {
			-> Don't Drink
		}
	*recap
		The water looks ok, but it smells bad. Are you sure you want to drink it? [Action]
	*reprompt
		The water looks ok, but it smells bad. Are you sure you want to drink it? [Action]

@Don't Drink
	*say
		You hold the glass of water at your hand, but you don't drink from it. [Pause]
		//[Man]
		//<emphasis level="strong">Hmmmm.</emphasis> [Pause] [EOA]
		The shopkeeper looks at the glass of water. He then looks down on the dusty floor.
		//[Man]
		//Suit yourself. Thought you were really thirsty. [EOA]
		//[Long_Pause] At least you're in the shade, so you're starting to feel a little bit less thirsty. But still, the stench is unbearable.
		[Man]
		Maybe the smell even went into the water. [Pause] It wasn't like this before the incident. [EOA]
		[Action]
	*recap
		You can drink water or ask more about the incident.
	*reprompt
		You can drink water or ask more about the incident.
	*then
		hear use water, drink water {
			-> Finding Out
		}
		hear talk to the shopkeeper, what incident, incident, ask about the incident, ask, talk, talk to the shopkeeper, ask papa {
			-> Ask Shopkeeper
		}

@Finding Out
	*say
		//The father has given you his word that the water is clean for drinking. But even without his promise you'd still chug the whole glass of water, bottoms-up.
		You chug the whole glass of water, bottoms-up.
		<audio src='https://koetest.s3.amazonaws.com/Act1/drinkingNoises.mp3'/>
        //Ahhhh. Refreshing! Although the water smells a bit off, you don't care. What's important is, you're saved from becoming human beef jerky.
        [Man]
        Feel better? You really looked like the desert's going to get you. [EOA] 
        Now it's just the stench that's really giving you a headache.

        [Man]
        Strange for you to show up. This town has never had a single visitor for a long time. Not after the incident.[EOA]
        [Conversation]
	//You should ask him.
	*reprompt
		You can talk to him by saying talk to the shopkeeper
	*recap
		You can talk to him by saying talk to the shopkeeper
	*then
		hear talk to the shopkeeper, what incident, incident, ask about the incident, ask, talk, talk to the shopkeeper, ask papa, ask him, tell me, more, tell me more {
			-> Ask Shopkeeper
		}

@Ask Shopkeeper
	*say
		[Man]A while ago the town was famed for our Shawarma. People would come all the way from cities to this dune for a taste of it.[Pause] 
		By the way. What's your name, traveler? [EOA]
		[Action] [LongPause]

	*then
		-> Ask for Help

@Ask for Help
	*say
		[Man] 
		That's a rare name around here. 
		[Pause] This is a desert so you could imagine it never rains here [Short_Pause] until that fateful night. [EOA]

		<audio src='https://koetest.s3.amazonaws.com/Act1/thunder11s.mp3'/>

		[Man] 
		On that night. We saw the greatest thunderstorm of the town's history, [Short_Pause] but no-one anticipated what happened next.[EOA]
		
        [Kid]
        [Pause] Next morning, my dad started sweating like a cow. So did everyone else. [EOA]
		
        [Man]
        Yes. [Pause] What's worse was what happened afterward. [Short_Pause]That's right. The stench. This stench. It keeps everyone from talking to each other. It drives tourists away. And now, no-one wants to come to our town anymore.[EOA]
        
        The shopkeeper points to a poster on the left wall. It pictures a determined face of a bearded man.
        
		[Man]
        The mayor is still trying to find people to help. Even set up a great reward for anyone who lifts the curse. 
        [Pause]
        Say, Since you're here, maybe you could help us? The mayor's reward could all be yours! [EOA]

        It seems like they really need your help. Do you want to help them?[Action]
	*reprompt
		It seems like they really need your help.
	*recap
		It seems like they really need your help. Do you want to help them?
	*then
		hear yes, sure, help {
			-> Decide to Help
		}

@Mayor Office
	*say
		You arrive at the mayor's office. It's the largest building in the town, but it's doors and windows are tightly shut and locked. [Short_Pause] 
		//When you get close to the front door, there's a sharp smell of hot pepper. 
		Looks like there's no way in.
	*recap
		It looks like there's no way in to the mayor's office. Perhaps you should visit somewhere else and try again later. [Conversation] If you don't know where to go, remember to say What's around me. 
		||
		Maybe go to the general store instead?
	*then
		hear store, general store, go to the general store {
			-> Store
		}
		hear what is around me,around me {
			-> Around_1
		}
	*reprompt
		If you don't know where to go, remember to say [Short_Pause] what's around me.

@Look Left
	*say
		You wipe your face with your dry hands and decide to turn left. [Pause] Then, you keep treading the infinite sea of sand wearily.
	*then
		-> Tutorial 1A: Check Around


////////////// Act1 END ////////////////
////////////// ACT 2 START //////////////

@Decide to Help
	*say
		[MAN_JOY]

		[Man]
		This is our lucky day. Finally a person who is willing to help us. Well, I guess I shouldn't be keeping you here for too long. [EOA]

		[Kid] 
		But papa, you haven't told anything about how to solve the problem. [EOA]

		[Man]
		Oh Yes, yes. Well, I'd like to help you, but what I've told you is all I know. Hey, perhaps you should go find the mayor! He must know more than anyone of us. [EOA]

		[Kid] 
		But the mayor is also locking himself up. No one has seen him for a while. [EOA]

		[Man] 
		Ha! This, my son, is when being the owner of the ONLY general store in the town comes in handy [Short_Pause] you see, the mayor has a secret craving for Super-Duper Hot Blue Pepper Sauce. [Short_Pause] And guess who's the only one selling it? Me! Ha haaah! [EOA]
	*then
		-> Decide to Help 2

@Decide to Help 2
	*say 
		The shopkeeper mentions the mayor, and the hot sauce with a ridiculously long name that you can't remember. [Conversation] Although it's pretty obvious that you would need to ask for one bottle in order to get the mayor's attention, but it never hurts to ask about the sauce, or the mayor. [Action]
	*recap
		You can ask about the mayor, ask about the sauce, or ask for one bottle
	*then
		hear buy, buy a bottle, can I have a bottle of hot sauce, could I, can you, can I, one, ask for one bottle, ask one, please give me, give me {
	        -> One Bottle of Sauce
	    }
	    hear ask about the mayor, about the mayor, the mayor, mayor, what about the mayor {
	        -> Ask Shopkeeper About the Mayor
	    }
	    hear ask about the sauce, about the sauce, the sauce, sauce, super, hot, blue, pepper {
	        -> Ask Shopkeeper About the Sauce
	    }
	*reprompt
		You can ask about the mayor, ask about the sauce, or ask for one bottle.

@Ask Shopkeeper About the Mayor
	*say
		[Man]
        About the mayor [Short_Pause], well, he hasn't accepted to see anyone since the incident. [Short_Pause] He wasn't like this before. He tried really hard to promote this little town to the world outside, that's why we had so many tourists before. [Short_Pause] By the way, after the disaster took place, he became oddly addicted to the hot sauce. What else would you like to know?[EOA] 
		
		[Conversation] You can ask about the sauce, or ask for one bottle. [Action]
	*then
		hear buy, buy a bottle, can I have a bottle of hot sauce, could I, can you, can I, one, ask for one bottle, ask one, please give me, one bottle  {
            -> One Bottle of Sauce
        }
        hear ask about the sauce, about the sauce, the sauce {
            -> Ask Shopkeeper About the Sauce
        }

@Ask Shopkeeper About the Sauce
	*say
		[Man]
        I can only say, the hot sauce is really hot, [Short_Pause] and it looks blue, for some reason. Like the gas stoves you see in your kitchen, hot, hot, hot! [EOA]

		[Kid]
		Yeah, when I was little, I thought it was cake frosting in a bottle.[Short_Pause] Well, I was wrong. [EOA]

		[Man]
		When I was little, [Short_Pause] Speaking like a grown-up, aren't you? [EOA]

		[Kid]
		I am a grown up. [EOA]

		[Man]
		Ha Ha Ha. Well, what else would you like to know?[EOA] 
		
		[Conversation] You can ask about the mayor, or ask for one bottle. [Action]
	*then
		hear buy, buy a bottle, can I have a bottle of hot sauce, could I, can you, can I, one, ask for one bottle, ask one, please give me, a bottle, bottle  {
            -> One Bottle of Sauce
        }
        hear ask about the mayor, about the mayor, the mayor {
            -> Ask Shopkeeper About the Mayor
        }

@One Bottle of Sauce
	*say
		[Man]  
        One bottle of Super-Duper Hot Blue Pepper Sauce, coming right up! [EOA] 
        <audio src="https://koetest.s3.amazonaws.com/new_demo_stereo/findingThings1.mp3"/> 
        [Man]  
        Hmmm, where is it? [EOA] 
        <audio src="https://koetest.s3.amazonaws.com/new_demo_stereo/findingThings2.mp3"/> 
        [Kid]  
        Dad, didn't you just sell the last one to Mrs. Chilirosa yesterday? [EOA] 
        [Man]  
        Hmm, Oh yes! I did sell one to her. [Short_Pause] That was our last one? This is embarrassing. [EOA] 
        [Kid]  
        Anyways, if you go ask Mrs. Chilirosa, she might still have some left for you. She's right down the street.[EOA]
	*then
		-> One Bottle of Sauce 2

@One Bottle of Sauce 2
	*say
		[Conversation] Now you can leave the store, or ask more about Mrs. Chilirosa. [Action]
	*recap
		Now you can leave the store or ask more about Mrs. Chilirosa.
	*then
		hear leave the store, leave {
            -> Leave the Store
        }
        hear ask more, tell me more about, ask more about Mrs Chilirosa, Misses Chilirosa, she {
            -> Ask more about Chilirosa
        }

@Ask more about Chilirosa
	*say
		[Man] 
        She's a stubborn old lady who owns a beauty salon down the street. Like the mayor, she also has a craving for spicy things. [EOA]
        [Kid] 
        Yeah! All my friends who visited her shop came out with hair that smelled spicy for days! [EOA]
        [Man] 
        But I know what she also likes. [MAN_LAUGH] As funny as it may sound, she also likes roses. But I doubt you'll be finding any of them around. Not in this desert.[EOA]
        [Conversation]Now you can leave the store, or ask again. [Action]
	*recap
		Now you can leave the store, or ask again
	*then
		hear leave the store, leave, go out {
            -> Leave the Store
        }
        hear ask again, ask {
            -> Ask more about Chilirosa
        }

@Leave the Store
	*say
        [Man]
        Wait. Sorry for the bad manners back there. I didn't mean it. Many of us had already lost hope on getting rid of this curse, and we've never had a visitor who agrees to help us. Thank you, and I wish you good luck. [EOA]
        <audio src='https://koetest.s3.amazonaws.com/new_demo_stereo/doorOpen2.mp3'/>
        You step out of the store. 
	
	This is the end of act one. You can stop here and come back later. Or you can continue to act 2. Would you like to continue?
	*then
		hear yes, yeah, sure {
			set currentLocation as 'a cross'
            -> The Cross
        }
		hear no {
			-> Quit Game
	}

@The Cross
	*say
		//[Action]
		There are a few things that you may want to check: [Conversation] The mayor's office to your left, or you can go find the beauty salon. [Action]
	*then
        hear mayor's office, check mayor's office {
            set currentLocation as 'mayors office'
            -> Mayor's Office
        }
        hear salon,beauty salon, go find the beauty salon, find the beauty salon {
            set currentLocation as 'outside of the beauty saloon'
            -> Beauty Salon
        }
	*recap
		There are a few things that you may want to check: A signpost, the mayor's office to your left, or you can go find the beauty salon.
	*reprompt
		There are a few things that you may want to check: A signpost, the mayor's office to your left, or you can go find the beauty salon.

@Mayor's Office
	*say
		You're at the mayor's office. The doors are shut tight, and they seem like locked. Somehow with the stench, it also smells very spicy.
           You need to talk to the mayor, but how do you get his attention? Hmmm. Perhaps you can knock the door, or, you can bash hardly on it. Perhaps you can also shout something to get the mayor. What would you do?
		   [Action]
	*then
		hear knock {
            -> Knock On Mayor's Office
        }
        hear bash {
            -> Bash On Mayor's Office
        }
        hear go to another location, another location {
            set currentLocation as 'a cross'
            -> The Cross
        }

		// TODO: What is this?
		hear go to scene Mayor's Office_1 {									 
			-> Mayor's Office_anotherlocation
		}

@Mayor's Office_anotherlocation
	*say
		There are a few other things that you may want to check: [Conversation] A signpost, or you can go find the beauty salon. [Action]
	*then	
		hear salon, beauty salon, go to beauty salon, go find the beauty salon {
	    	set currentLocation as 'outside of the beauty saloon'
			-> Beauty Salon
		}

@Knock On Mayor's Office
	*say
		You knock on the door,
		<audio src='https://koetest.s3.amazonaws.com/Act2/knockDoor.mp3'/>
		but nobody answers.
	*then
		-> Mayor's Office

@Bash On Mayor's Office
	*say
		You bash heavily on the door,
		<audio src='https://koetest.s3.amazonaws.com/Act2/bashDoor.mp3'/>
		but nothing happens.
	*then
		-> Mayor's Office

@Beauty Salon
	*say
		You walk towards the end of the street.
		<audio src='https://koetest.s3.amazonaws.com/Act2/windCurtain.mp3'/>
        Nothing but the sandy gusts of wind scratch your ears. The buildings on the way look pretty modern, but they are all coated with a thick layer of dust. While you're on your way, you noticed something peculiar in the corner of one of the buildings. Oh my! It's a patch of green.
        <audio src="https://koetest.s3.amazonaws.com/new_demo_stereo/footsteps2.mp3"/>
		You're now at the frontsteps of misses Chilirosa's beauty salon. Looks like its doors are shut tight, but they don't look locked, and you hear the sounds of radio inside. Anyways, you should talk to Misses Chilirosa, but what should you do to get her attention?
	*then
		unflag flower
	    unflag angry
		-> Arrive Beauty Salon

@Arrive Beauty Salon
	*say
		[Conversation] Normally, you could knock on the door. But you can also try bashing on the door, or just open the door and sneak in. You can also go back and inspect the patch of green.[Action]
	*then
		hear knock, knock on the door, try knock {
		    set currentLocation as 'inside of the beaty saloon'
            -> Knock On Beauty Salon
        }
        hear bash, bash on the door, try bashing {
            set currentLocation as 'inside of the beaty saloon'
            -> Bash On Beauty Salon
        }
		hear open the door, open the door directly, sneak in, sneak, try open, open {
			-> Open the Beauty Salon Directly
        }
        hear check the green patch before, green patch, check, go back, green, back {
            if flower{
                -> Check the Green Patch Again
            }
            -> check the Green Patch
        }
	*recap
		Now you can: Knock on the door, bash on the door, open the door directly, or check on the green patch before.
	*reprompt
		Now you can: Knock on the door, bash on the door, open the door directly, or check on the green patch before.

@Check the Green Patch Again
	*say
		You walk back to the patch of green sitting in the corner of a building. You've picked up a rose from here before.
	*then
		-> Arrive Beauty Salon

@Knock On Beauty Salon
	*say
		<audio src='https://koetest.s3.amazonaws.com/Act2/knockDoor.mp3'/>
		No one responds. [Conversation] Knock again ,bash on the door, or try to open it directly?[Action]
	*recap
		You can try knock again, knock harder, or open the door directly.
	*then
		hear knock, knock again{
	        -> Knock On Beauty Salon 2
	    }
	    hear bash, know harder, bash on the door {
	        -> Bash On Beauty Salon
	    }
		hear open the door, open the door directly, sneak in, sneak {
			-> Open the Beauty Salon Directly
        }

@Knock On Beauty Salon 2
	*say
		You hear a crack in the house, but still no response. Maybe we should just open the door directly and sneak in? [Action]
	*reprompt
		You can try to say: open the door directly, or you can keep trying knocking.
	*then
		hear knock again, again, knock {
            flag angry
            -> Chilirosa Annoyed
        }
		hear open the door, open the door directly, sneak in, sneak, yes, sure {
			-> Open the Beauty Salon Directly
        }

@Chilirosa Annoyed
	*show
		template: 'default'
        background:'https://koetest.s3.amazonaws.com/visuals/Chilirosa+puzzle/Angry.png'
        title: ''
        subtitle: ''
	*say
		<audio src='https://koetest.s3.amazonaws.com/new_demo_stereo/peopleWalkingFast.mp3'/>
		<audio src='https://koetest.s3.amazonaws.com/new_demo_stereo/doorOpen2.mp3'/>
        [MrsChilirosa]
        Yes? What do you want?[EOA] 
	*then
		if flower {
            unflag angry
            -> Meet Mrs Chilirosa with flower
        }
        -> Meet Mrs Chilirosa

@Chilirosa Angered
	*show
		template: 'default'
        background:'https://koetest.s3.amazonaws.com/visuals/Chilirosa+puzzle/Angry.png'
        title: ''
        subtitle: ''
	*say
		<audio src='https://koetest.s3.amazonaws.com/new_demo_stereo/peopleWalkingFast.mp3'/>
		<audio src='https://koetest.s3.amazonaws.com/new_demo_stereo/doorOpen2.mp3'/>
        [MrsChilirosa]
        Hey? Show some manners![EOA] 
	*then
		if flower {
            unflag angry
            -> Meet Mrs Chilirosa with flower
        }
        -> Meet Mrs Chilirosa

@Bash On Beauty Salon
	*say
		You bashed on the door. 
		<audio src='https://koetest.s3.amazonaws.com/Act2/bashDoor.mp3'/>
	*then
		flag angry
		-> Chilirosa Angered

@Meet Mrs Chilirosa with flower
	*say
		[MrsChilirosa]
        Oh, my! Is THAT for me?[EOA]
	*recap
		[MrsChilirosa]
        I believe it is for me, right?[EOA] [Action]
	*then
		hear yes, sure {
            -> Give Mrs Chilirosa the flower
        }
        hear no, nope {
            -> Chilirosa Bargains
        }

@Chilirosa Bargains
	*say
		[MrsChilirosa]
        Please, roses are very hard to find in this stinky town. I can pay you.[EOA] [Action]
	*then
		hear yes, sure {
            -> Give Mrs Chilirosa the flower
        }
        hear hot sauce, sauce, I want the hot sauce, give me the hot sauce {
            -> Chilirosa Give Hot Sauce
        }
        hear no, nope {
            flag angry
            -> Chilirosa No Rose Annoyed
        }

@Chilirosa No Rose Annoyed
	*say
		[MrsChilirosa]
        What do you want? If you have nothing else please leave. This town is already a skunk and I would appreciate if you close the door to stop the stinky air coming in.[EOA] 
        [Conversation] 
        Probably a good idea to ask about the hot sauce. [Action]
	*then
		hear ask about the hot sauce, the sauce, hot sauce, super, pepper, blue, sauce {
            -> Ask about the Sauce
        }

@Give Mrs Chilirosa the flower
	*say
		[MrsChilirosa]
        Why, thank you, dear... 
        What's your name? 
        [EOA]
        <amazon:effect name="whispered">say your name!</amazon:effect>. [Action]
	
	*recap
		Maybe try some common names instead? For example, You can say: my name is Shawn.

	*reprompt
		Say your name to the shopkepper. For example, You can say: my name is Brian.
	*then
		slot playerName to 'AMAZON.US_FIRST_NAME'
		hear {playerName}, my name is {playerName} {
			-> Answer Your Name
        }

@Answer Your Name
	*say
		[MrsChilirosa]
        Oh, thank you, dear {playerName}. 
        What can I give you in exchange? [EOA]
	*then
		-> Meet Mrs Chilirosa

@Meet Mrs Chilirosa
	*say
		[Action]Now, it's time to ask her about the sauce.
	*recap
		You can try to say "Ask about the sauce".
	*reprompt
		She is waiting for your response.
	*then
		hear ask about the sauce, the sauce, hot sauce, could you, give, sauce {
            if angry{
                -> Ask about the Sauce 1
            }
            -> Ask about the Sauce
        }

@Ask about the Sauce 1
	*say
		[MrsChilirosa]
        yeah, what about it? You want it? [EOA]
        [Action]
	*then
		hear yes, sure {
            -> Ask about the Sauce
        }

@Ask about the Sauce
	*say
		[MrsChilirosa]
        Give me a reason why you need hot sauce. You want hot sauce because? [EOA]
        [Conversation] Wait a minute. We now have two plans here: first plan, You tell her how much you like the sauce. second plan. tell her that you need it to get the mayor's attention. Which plan should you go with? [Action] 
	*recap
		We have two plans here: [Conversation] First one, make up a random reason. Second one, tell her that you need it to get the mayor's attention. Which plan you do you want to go? [Action]
	*then
		hear one, first, make up, reason, lie, A {
            -> Tell Mrs Chilirose you like the Sauce
        }
		hear two, second, tell her that I need it to get the mayor's attention, need, B {
			-> Tell Mrs Chilirose Honestly
        }

@Tell Mrs Chilirose you like the Sauce
	*say
		Ok. Now make up a good reason why you like the sauce. You like the sauce because? [Action] [LongPause]
	*then
		-> Tell Mrs Chilirose you like the Sauce 2

@Tell Mrs Chilirose you like the Sauce 2
	*say
		[MrsChilirosa]
        [CHILI_HAPPY] That is an extraordinary reason. You see, I can't live without the sauce. I need it for my breakfast, lunch and supper! [EOA]
		Misses Chilirosa lets a drop of sauce on to her index finger as she exclaims about her attachment to the sauce.
		[MrsChilirosa] But I can't believe it! It's another friend who appreciates the sauce. Here, I only share with friends who understand true beauty. [EOA]

        She gleefully hands over the hot sauce to you. You leave the building as she happily waves goodbye to you.
	*then
		-> Get the Hot Sauce

@Tell Mrs Chilirose Honestly
	*say
		[MrsChilirosa]
        Don't mention the mayor to me. He's been dominating all the hot sauce. but seeing that you're not a hot sauce, i guess you have a good reason to meet him. I'll give you half a bottle. [EOA]
	*then
		-> Chilirosa Give Hot Sauce

@Chilirosa Give Hot Sauce
	*show
		template: 'default'
        background:'https://koetest.s3.amazonaws.com/visuals/Chilirosa+puzzle/sauce.png'
        title: ''
        subtitle: ''
	*say
		[MrsChilirosa]
        Here is the hot sauce, take it.[EOA]
        She hands over the hot sauce to you. You exit the building.
	*then
		set currentLocation as 'mayors office'
		-> Get the Hot Sauce

@Open the Beauty Salon Directly
	*say
		You carefully and quietly opened the door. You entered! The beauty salon is connected to Misses Chilirosa's house.

	*then
		-> chilirosa_steal_puzzle_start

@check the Green Patch
	*say
		You walk back to the patch of green sitting in the corner of a building. Oh dear, in a dry desert like this, you found a rose with a bright red color on it. You pick up the rose and hold it in your hand, and go back to Misses Chilirosa's house. Now you can: [Conversation] Knock on the door, bash on the door, or open the door directly. [Action]
	*then
		flag flower
		hear knock, knock on the door {
		    set currentLocation as 'inside of the beaty saloon'
            -> Knock On Beauty Salon
        }
        hear bash, bash on the door {
            set currentLocation as 'inside of the beaty saloon'
            -> Bash On Beauty Salon
        }
		hear open the door, open the door directly {
			-> Open the Beauty Salon Directly
        }
	*recap
		Now you can: Knock on the door, bash on the door, or open the door directly. [Action]
	*reprompt
		Now you can: Knock on the door, bash on the door, or open the door directly. [Action]

@Get the Hot Sauce
	*show
		template: 'default'
        background:'https://koetest.s3.amazonaws.com/visuals/Dessert/dessertAll.png'
        title: ''
        subtitle: ''
	*say
		You're at the mayor's office. The doors are shut tight, and they seem like locked. Somehow with the stench, it also smells very spicy. Besides knocking on the door, the office is so big that you probably need to shout to get his attention.[Conversation] Do you want to wave to the window, or shout to the his attention?[Action]
	*reprompt
		Wave to the window? Knock on the door? Or shout at the mayor?
	*recap
		Wave to the window? Knock on the door? Or shout at the mayor?
	*then
		hear Knock on the door, knock, door {
			-> Knock Knock Knock
        }
        hear shout, shout at the mayor {
            -> Shout At the Mayor
        }
		hear wave, window, wave at the window {
			-> Wave at window
		}


@Wave at window
	*say
		You wave at the window, but no-one responds. You need to make a bigger noise. [Action]
	*then
		hear shout, shout at the mayor {
			-> Shout At the Mayor
		}

		hear knock, knock on the door, door {
			-> Knock Knock Knock
		}


@Knock Knock Knock
	*say
		You knock the door, 
		
		<audio src='https://koetest.s3.amazonaws.com/Act2/knockDoor.mp3'/>
		
		but no-one respond. [Conversation] You need to make a bigger noise. [Action]
	*reprompt
		It seems that shouting at the mayor is the only way to get his attention
	*recap
		It seems that shouting at the mayor is the only way to get his attention
	*then
		hear shout, shout at the mayor {
	        -> Shout At the Mayor
	    }

@Shout At the Mayor
	*say
		Ok then. Shout something loud and clear so that the mayor can hear you. Now let's shout![Action]
	*recap
		Seems like he is not interested in what you said. Shout something else? maybe mention that you have the super duper hot blue pepper sauce? [Action]
	*reprompt
		Ok then. Shout something loud and clear so that the mayor can hear you. Now let's shout![Action]
	*then
		hear super duper hot blue pepper sauce, sauce, hot , pepper, super duper, hot sauce, pepper sauce, blue sauce, blue {
			-> Shout At the Mayor_1
		}

@Shout At the Mayor_1
	*say
		<audio src='https://koetest.s3.amazonaws.com/new_demo_stereo/openWindows.mp3'/>

		[Mayor]
        Who's shouting? Did I just hear super duper hot blue pepper sauce? [EOA]
		
		The mayor finds you below the window.

		[Mayor]
		Ah! It's you. Please! Come in. [EOA]

		[DOOR_UNLOCK]

		The door unlocks. As soon as you meet the mayor,

		You hand over the sauce. The mayor quickly jerks open the bottle cap, and walks hastily to one of the doors and pours the sauce under it. He looks at you and smiles awkwardly.
		
		[Mayor]
		You see. I actually don't like the sauce. I use it only to block off the smell. This bothering smell has been so long that I almost forgot when it happened. [Conversation] So. why did you come? [Action] [EOA]
	*then
		hear smell, incident, help, yes, right {
			-> Mayor Talks More About the Incident
		}
		hear who are you{
		    -> Mayor Self Introduction
		}
	*recap
		You come here because you need more information on the smell. right?
	*reprompt
		Wait, you come here because you need more information on the smell. right?

@Mayor Talks More About the Incident
	*say
		[Mayor]
        Wait. Are you saying that you're willing to help us get rid of this disgusting smell? Oh please, sit down, sit down.[EOA]
		You sit down on the old couch in the office. The couch releases a spicy smell that stings.
		[Mayor]
		Want some tea? [EOA] [Action]
	*then
		hear yes, sure, yes please, ok {
			-> Mayor Brings Tea To You
		}
		hear no, no thanks {
			-> Mayor Doesn't Bring Tea To You
		}

@Mayor Brings Tea To You
	*say
		In a split second, the mayor brings you a cup of tea. You drink from the cup. You feel like a a volcano is erupting in your mouth. It's not just hot. It's spicy.
		[Mayor]
		Ha. This tea is brewed with the spicy hot sauce! This tea makes your nose so numb that you can't smell that awful stench. [Short_Pause] Ok, where were we? Ah, yes.[EOA]
	*then
		-> Mayor Talks About the Incident Part 2

@Mayor Doesn't Bring Tea To You
	*say
		[Mayor] Alright then. [EOA]
		The mayor makes himself a cup of tea.
		[Mayor] Ah! Hot. This tea is very, very hot. So hot that it lets you forget about the stench! [EOA]
		I wonder what that tea is made of.
		[Mayor] Anyway, where were we? Oh, yes. [EOA]
	*then
		-> Mayor Talks About the Incident Part 2

@Mayor Talks About the Incident Part 2
	*say
		[Mayor]
		This curse is the work by one of our own, or formerly one of our own. Her name is Barette the Alchemist. That coward ran away from the town, though. Can't even face her own wrongdoings. Because of her, we have lost tourists and people don't want to come here anymore. People are even afraid to mention her name. [EOA]
		The mayor looks at the map on the wall.
		[Mayor]
		The legend out there says there's a precious gemstone called the citrine hidden in the valleys to the East, and that the precious gem is the key ingredient to lifting the curse. 
		What the legend didn't tell, is that the cavern is guarded by a mysterious puzzle. [EOA]
		you can ask about: [Conversation] the cave, puzzles, eastern valleys, the town, or leave to the cave [Action]

	*then
		-> Mayor Talks about the Incident Part 3
	
		
@Mayor Talks about the Incident Part 3
    
    *say
    
    *recap
        You can not do that. you can ask about: [Conversation] the cave, puzzles, eastern valleys, the town, or leave to the cave [Action]
    
    *reprompt
		you can ask about: [Conversation] the cave, puzzles, eastern valleys, the town, or leave to the cave [Action]
	*then
		hear cave, about the cave {
            -> Ask Mayor The Cave
        }
        hear puzzles, challenges, what is the puzzle, ask about the puzzle {
            -> Ask Mayor Challenges
        }
        hear valleys, eastern valleys {
            -> Ask Mayor the valleys
        }
        hear town, about the town {
            -> Ask Mayor The Town
        }
        hear leave, leave to the cave {
            -> Leave the Cave
        }	
	
	

@Ask Mayor the valleys
	*say
		[Mayor]
        The Eastern valleys is a long way from here. You better bring food and water. Or else you'll not make it.[EOA]
	*then
		-> Mayor Talks about the Incident Part 3

@Ask Mayor Challenges
	*say
		[Mayor]
        A while ago we sent our best people to retrieve the stone. When they returned, the were smelly, even nastier than what we are enduring here. [Short_Pause] But what's worse was that they could barely remember anything. The doctor said that probably the smell was too unbearable that they lose their memories. All they could remember when they returned was they were lost in a puzzle.[EOA]
	*then
		>> BACK

@Mayor Self Introduction
	*say
		[Mayor]
        I'm the Mayor. There's no question about it.[EOA]
	*then
		>> BACK

@Ask Mayor The Cave
	*say
		[Mayor]
        Well, there's not much to talk about the cave, other than it's hidden in the valleys to the East... wait. Ah, yes, nearly missed this: It is said that there were plant roots that lead into the cave. A real miracle since green is sparse in the desert.[EOA]
	*then
		-> Mayor Talks about the Incident Part 3

@Ask Mayor The Town
	*say
		[Mayor]
        We were once a happy little town in the desert. At one point it even became a tourist spot! It's crazy to think that people would come from everywhere, just to get a taste of our famous dish, Shawarma.[EOA]
	*then
		-> Mayor Talks about the Incident Part 3	

//not using

@Agree to Help the Mayor
	*say
		[Mayor]
		Wait. [Short_Pause] Are you saying that you're willing to help us get rid of this disgusting smell? Oh please, sit down, sit down[EOA]

        You sit down on the old couch in the mayor's office. The couch releases a spicy smell that stings.  
      
    	[Mayor]
        So, the legend out there says there's a precious gem hidden in the valleys to the East, and that the precious gem is the key ingredient to lifting the curse.[EOA]
        <audio src='https://koetest.s3.amazonaws.com/Act2/windCurtain.mp3'/>
		that the don't know, is that the cavern is guarded by puzzles and challenges. But what's beyond that- nobody knows. Nobody remembers[EOA]

	*then
		unflag cave
	    unflag town
		-> Ask the Mayor

//not using

@Ask the Mayor
	*say
		[Conversation] You can ask about how he knows all this, about the cave, or about the town itself. [Action]
	*recap
		Well, the options are: [Conversation] A. ask about how he knows all this; B. ask about the cave; C. ask about the town it self. [Action]
	*then
		hear A, a, how he knows all this, all this {
			-> Ask Mayor How He knows
        }
        hear B, b, about the cave, cave {
            -> Ask Mayor The Cave
        }
        hear C, c, about the town, town {
            -> Ask Mayor The Town
        }

//not using

@Ask Mayor How He knows
	*say
		[Mayor]
        A while ago we sent our best people to go and retrieve the stone. When they returned, they were covered in smell even nastier than what we have in the town. But what's worse was that they could barely remember anything. The doctor said that probably the smell was too unbearable that they passed out at some point and lost all the memory. This is all they could remember.[EOA]
	*then
		>> BACK

//not using

@Continue Ask Mayor The Town
	*say
		[Mayor]
        Speaking of which, [Short_Pause] this reminds me of a character, [Short_Pause] yes, quite a character in our town. [EOA]
        The mayor pauses to sip a cup of water. He also spreads some of the hot sauce on his nose. 
        [Mayor] 
        We had this guy who worked in one of the most famous Shawarma places in town. Everything was normal except he sweats a lot, and a lot. It's like he wasn't born for the desert. [EOA]
        The hot sauce made the mayor to sweat a little bit, as he tries to wipe of some of them from his cheeks.
        [Mayor]
        But it doesn't just stop there. Oh dear, he has this odor. It was offending the guests. A great embarrassment. [EOA]
        The mayor leans back and waves his hands while he talks. 
        [Mayor] So, in the end, we had to make him leave. That's just a story. I don't know if anyone has hired him again, but that was just some time before this smell found its way into the town. [EOA]
	*then
		flag town
        -> Ask the Mayor

//not using

@Before Leave For the Cave
	*say
		and you can also heave for the cave.[Action]
	*recap
		Well, the options are: A. leave for the cave; B. ask mayor about something else
	*then
		hear A, a, leave, leave for the cave {
            -> Leave the Cave
        }
        hear B, b, ask, ask mayor about something else, something else {
            -> Ask Mayor The Cave
        }

@Leave the Cave
	*say
		[Mayor]
        I hope that these information are useful to you. We're all looking forward to seeing the town coming back to life some day. Good luck! [EOA]
        You leave the mayor's office, back on to the streets. The shopkeeper stands outside.
        [Man]
        Are you leaving? If you're ready, the horse over there is ready for you; but if you are tired. take some rest. [Conversation] Would you like to leave or take some rest?[EOA] [Action]
	*then
		hear rest, take some rest {
	        >>END
	    }
	    hear ready,leave {
	        -> Been Walking For Days
	    }

/////////// END OF ACT 2 //////////////
/////////// START OF ACT 3 ////////////

@Been Walking For Days
	*show
		template: 'default'
        background:'https://koetest.s3.amazonaws.com/Images/CowPlant.png'
        title: ''
        subtitle: ''

	*say
		You've been walking for days, but still no sign of valleys, only desert. 
		
		<audio src='https://koetest.s3.amazonaws.com/Act3/horseNeighing_01.mp3'/> 
		
		It's been a A couple of days since you left the town. Although having a horse to carry you across the wilderness is fortunate, but now it seems very tired as well. 
		
		<audio src='https://koetest.s3.amazonaws.com/Act3/smallWind_01.mp3'/> 
		
		Your vision starts to get blurry again. Strangely, this blurriness seems a bit, a bit yellow. You tried to muster your consciousness, only to find out that you're heading in to an inevitable sandstorm. As unwilling as you may be, this is the only way to the Eastern Valleys. You ride into the furious sandstorm. 
		
		<audio src='https://koetest.s3.amazonaws.com/Act3/strongWinds_01.mp3'/> 
		
		But soon, the sandstorm has devoured you into the yellow fog. The wind is so strong an unbearable that you couldn't go on anymore. You slowly close your eyes. 
		
		[SeedTrader]
	    Wake up! Wake up! Don't fall asleep! [EOA]
	    
	    A faint sound reaches your ear amidst the noise of the storm.
	    
	    [SeedTrader]
	    We're getting out now, so don't fall on me! [EOA]
        
        You feel like you were being carried onto a bed, so you close your eyes and let yourself drift away.
	*then
		-> cowplant_puzzle_start

@MysMan Introduces Himself
	*say
		[SeedTrader]
        my name is Luke, nothing but a humble merchant in the desert. I sell seeds and plants. I also sell other fascinating little gimmicks that be found nowhere else but in my awesome tent. [EOA]
        
        Luke looks at the sun for a bit.
        
        [SeedTrader]
        The sun sure is hot. Let's head back in to the tent first.[Pause] [EOA]
    
        You hesitated a little because you still have to find your way to the cave. You still followed him.
        
        [SeedTrader]
        Hmm. That wasn't very clever for you to travel through the sandstorm like that. You may have become a part of the desert, you know. [EOA]
        
        As he enters the tent, he jumps into the center of tent, like a graceful dancer.
        
        You are inside Luke's tent. There is a giant brown seed on the table beside you. 

        
        [SeedTrader]
        Welcome, to Luke's tent of peculiar collections. 
        Would you be interested in any of the items I have? 
        Would you be interested in a seed that grows nothing but more seeds? 
        [EOA]
        
        Don't forget, you need to get to the cave, fast. 
        What should you ask?
        
	*then
		unflag anotherItem
        unflag plot12
        unflag plot3
        unflag plot4
        -> MysMan Introduces Himself 2

@MysMan Introduces Himself 2
	*say
		<audio src='https://koetest.s3.amazonaws.com/Act3/goingThroughShelvesGlassy.mp3'/>
		[SeedTrader]
        This is a seed that grows more seeds. Would you like to know how it works? [EOA]
        
		[Conversation]
        You can ask more about the seed or ask how to get to the cave. You can also thank him and leave. [Action]
        
	*reprompt
		You can ask more about the seed or ask how to get to the cave. You can also thank him and leave.
	*recap
		You walked to the tent with Luke, the seed trader. You can ask more about the seed or ask how to get to the cave. You can also thank him and leave. 
	*then
		hear seed, tell me more about the seed {
            -> More About the Seed
        }
        hear thank him and leave, no, leave {
            -> MysMan Says Wait
        }
        hear how to get to the cave, the cave, cave {
            -> Another Item
        }

@More About the Seed
	*say
	    [SeedTrader]
		Ah, yes. This is a seed that makes more seeds. No plant roots, no flowers, just... seeds! I personally use it for seasoning. A great match for all dishes, even junk food. [EOA]
		
		Luke eagerly waits for your response.

	*then
		>> BACK

@MysMan Says Wait
	*say
		[SeedTrader]
        Wait, wait, wait! What did I miss? [EOA]
	*then
		if anotherItem{
            -> Next Item
        }
        -> Another Item

@Another Item
	*say
		<audio src='https://koetest.s3.amazonaws.com/Act3/goingThroughShelvesGlassy.mp3'/>

		[SeedTrader]
        Uh, how about this? This is a plant that glows in the day! [EOA]
       
        He takes out a small flower that glows strongly in the tent. 
        
        [Conversation] You can ask more about the flower or ask how to get to the cave. You can also thank him and leave.[Action]
	*reprompt
		You can ask more about the flower or ask how to get to the cave. You can also thank him and leave.
	*recap
		Luke took out a plant that glows in the day. You can ask more about the flower or ask how to get to the cave. You can also thank him and leave.
	*then
		flag anotherItem
        hear ask more about the flower, tell me more, more, flower, tell me more about the flower {
            -> More About the Glowing Plant
        }
        hear about the cave, the cave {
            -> Next Item
        }
        hear go, leave, thank him and leave, leave {
            -> MysMan Says Wait
        }

@More About the Glowing Plant
	*say
	    [SeedTrader]
		Ha! Glad that you've asked. This plant is a tremendous existence in our world. It glows when there's sunlight. If there is no sun, it doesn't glow! Ha! [EOA]
		
		[Conversation] You can ask how to get to the cave. You can also thank him and leave.[Action]
		
	*reprompt
	    You can ask how to get to the cave. You can also thank him and leave.
	*recap
		You can ask how to get to the cave. You can also thank him and leave.
	*then
		hear how to get to the cave, about the cave, cave {
            -> Next Item
        }
        hear leave, thank him and leave {
            -> MysMan Says Wait
        }

@Next Item
	*say
	    Strangely, Luke starts to panic. He goes through all of his inventory, again and again. Then, he picks up a glass vial that was immediately in front of him before.
		
		<audio src='https://koetest.s3.amazonaws.com/Act3/goingThroughShelvesGlassy.mp3'/>

		[SeedTrader]
        There! Found you. This, oh my dear, is a rare find out here in the desert. This, is a stinky plant. [EOA]
    
        He seems really unsettled, but not because of the plant he's holding up to you. 
        [Conversation] You can ask how to get to the cave. You can also thank him and leave. [Action]

	*reprompt
		You can ask about the plant, ask him how to get to the cave. You can also thank him and leave.
	*recap
		Luke shows you a stinky plant. You can ask about the plant, ask him how to get to the cave.  You can also thank him and leave.
	*then
		hear about the cave, cave {
            -> MysMan Says Stop
        }
        hear leave, thank {
            -> MysMan Says Wait I Know
        }
        hear more about the plant, the plant {
            -> MysMan Spills the Tea
        }

@MysMan Says Stop
	*say
		<audio src='https://koetest.s3.amazonaws.com/Act3/handSmacking_01.mp3'/>
		[SeedTrader]
        Stop! Stop asking me how to get to the cave! Can you not see me trying to avoid your question? How can you be so stupid? [EOA]

        As soon as the word stupid comes out of his mouth, he immediately knows that he said something that he shouldn't have.

        [SeedTrader]
        I'm sorry. It's just that I've waited so long for someone to come and ask me about the cave. I'm sorry. [EOA] [Action]
	*recap
		Luke keeps apologizing to you. You should talk to him, probably just tell him, it is alright?
	*reprompt
		You should talk to him, probably just tell him, it is alright? 
	*then
		hear it's OK, OK, alright, fine {
            -> MysMan Story
        }

@MysMan Story
	*say
		[SeedTrader]
        It all happened a long time ago. Do you know why the town was cursed? [EOA] [Action]
    *recap
		Luke asks you if you know that the town is cursed. 
	*reprompt
		You can say yes or no. 
	*then
		hear yes {
            -> MysMan Story Plot 1
        }
        hear no {
            -> MysMan Story Plot 2
        }

@MysMan Story Plot 1
	*say
		[SeedTrader]
        So you've heard what the townsfolk and the mayor had to say. Well, they never mentioned to you about me, did they? [EOA] 
        
        Luke looks away into the holes in the tent.
        
        [SeedTrader]
        They say that it was the alchemist that was responsible for the curse. First of all, it wasn't a curse. It's merely an experiment gone wrong. We were trying to transform the smell of the stinky plant into something enjoyable. But instead, it went wrong. [EOA]
        
        Luke picks up the bottle with the stinky plant sealed within, and stares into it.
        
        [SeedTrader]
        The failed potion accidentally went into the soil and contaminated the land. That's how the stench got to everyone. [EOA]
        
        He sighs and puts down the bottle.
        
        [SeedTrader]
        But that wasn't all. I wasn't thinking properly. I knew that the townsfolk will be angry at us, and I was afraid. I wasn't prepared to take the blame, so I went out and told the townsfolk all about it. I told that it was the alchemist's fault. I thought that would make me feel safer from the anger of these people. [EOA]
        
        The wind blows a little bit outside the tent. Luke holds his hands together and covers his face.
        
        [SeedTrader]
        The next thing I know was that when I came back, the alchemist was being yelled at, and banished from the town. [EOA]
        
        He breathes sharply, as if he's trying to get himself together.
        
        [SeedTrader]
        Well. I left the town soon after. Looking at his old place every day like that, it's just not possible. [EOA]
        
        Luke musters his strength and stands up, then look back at you.
	*recap
		Luke tells you that town people blames the alchemist because of an experient that went wrong.
	
	*then
		flag plot12
		-> Luke Explains the Cave

@Luke Explains the Cave
	*say
		[SeedTrader]
        The cave is guarded by a thick forest. You're probably wondering how a forest could grow in the middle of the desert. Well, the alchemist is an expert in botany. His knowledge allows him to grow anything anywhere, even in the desert. [EOA]
        
        //(Sound Effect: Going through shelves)
        <audio src='https://koetest.s3.amazonaws.com/Act3/goingThroughShelves_01.mp3'/>
		
        Luke goes through his shelf of specimens for a second, and returns with a compass, a small bottle of potion, and a vial of a small, but beautiful flower. Carefully, he uncovers the vial.
        
        [SeedTrader]
        Anyways, the forest is a maze. If you make the wrong turn, you'll get lost. This is where the leading flower comes in to play. [EOA]
        
        He holds up the flower.
        
        [SeedTrader]
        This flower tells directions. As long as you give it a clear destination, it will lead you to it accurately and timely. Here, hold these two for me, will you? [EOA]
        
        Luke then hands over the flower and the compass to you. Suddenly, with an exaggerating pose, Luke throws the potion into the air. 
		
		<audio src='https://koetest.s3.amazonaws.com/Act3/grabDust.mp3'/>
		
		But instead, the potion only traveled for a second or two before it landed. The potion breaks. Magically, a garden surrounded by bushes appears in the middle of nothing.
        
		<audio src='https://koetest.s3.amazonaws.com/Act3/sparklingSound.mp3'/>

        [SeedTrader]
        Now. You will use this flower and guide yourself to garden, which is in the center of this maze. [Conversation] First, say to the flower [Pause] "Lead me to the garden." [EOA] [Action]
	*recap
		Luke gives you a magic flower that can lead you. Try to say, lead me to the garden.
	*reprompt
	    Try to say, lead me to the garden.
	*then
	    hear lead me to the garden{
	    	-> leading_start
	    }

@MysMan Story Plot 2
	*say
		[SeedTrader]
        So you've heard what the townsfolk and the mayor had to say. Well, they never mentioned to you about me, did they? [EOA]
        
        Luke away into the holes in the ceiling. 
        
        [SeedTrader]
        They say that it was the alchemist who was responsible for the incident. And they were right, except for one spot: I was beside him when it took place. [EOA]
        
        Luke strokes his chin for a bit.
        [SeedTrader]
        It was merely an accident. We were experimenting with the stinky plant and see if its unbearable smell can become an extraordinary perfume. [EOA]
        
        Luke picks up the bottle with the plant sealed in.
        
        //(Sound Effect: Sigh)
        <audio src='https://koetest.s3.amazonaws.com/Act3/sigh_01.mp3'/>

        [SeedTrader]
        I knew that it was going to fail, but he disagreed. We had a big fight, and I left the lab for the night. The next thing I know, is that the town was flooded with the flower's smell, and the townsfolk were angry at the alchemist. In the end, they drove him away. [EOA]

        Luke pauses for a while, as if he was trying to talk to himself in his head.

        [SeedTrader]
        If I had been there to stop him, none of this would've happened. It was my fault. [EOA]

        Luke then puts the plant back on the table.
        
        [SeedTrader]
        I know why you're here. You came from the town, didn't you? You're here for the cave, where the alchemist resides. I can tell you about the puzzles in the cave. [EOA]
	*recap
		Luke tells you that everything comes from an accident. 
	*then
		flag plot12
		-> Luke Explains the Cave

@One Last Thing
	*say
		[SeedTrader]
		That's pretty much it. Oh. Wait. [EOA]

		<audio src='https://koetest.s3.amazonaws.com/Act3/goingThroughShelvesGlassy.mp3'/>

		Luke goes to a locked chest and retrieves a purple seed.

		[SeedTrader]
		There's another thing about the citrine that you're looking for. The antidote cannot be made without this other ingredient. I guess she doesn't know this yet, since the town still smells awful. [EOA]

		Luke hands the seed to you.
		
		[SeedTrader]
		Here, take it. After all I've done to him, I don't think I'm ready to confront him yet. Bring this seed to him for me. [EOA]
		
		Luke walks to the entrance and sticks his head out.

		[SeedTrader]
		The day is not young. You must go before the sandstorm comes and catch you again. Or if you want to, you can stay here for a while to wait for the storm to leave. [EOA]

		You can pause your journey and take some rest here, or you can continue and hurry to the cave.[Conversation] Would you like to leave for the cave? [Action]
	
	*reprompt
		Luke has handed you a purple seed that is crucial to producing the antidote. Now you may choose to pause your journey and take some rest here, or you may leave and continue to the cave. Would you like to leave for the cave? 
	*recap 
		You may choose to pause, or leave and continue to the cave. Would you like to leave for the cave?
	*then
		flag plot12
		hear yes, leave for the cave, continue {
            -> End of ACT III, 1&2
        }
        hear no, puase, rest {
            -> Quit Game
        }

@End of ACT III, 1&2
	*say
		//(Sound Effect: Horse Neighing)
		<audio src='https://koetest.s3.amazonaws.com/Act3/horseNeighing_01.mp3'/>

		[SeedTrader]
		Very well then. Keep riding to the East. The valley is close. Follow the plant roots and you will reach the cave eventually. [EOA]

		Both of you walk slowly outside the tent. It looks like Luke has something to tell you, but he's trying to keep it to himself.

		[SeedTrader]
		Hey, {playerName}![EOA]

		As you make yourself comfortable on the saddle, Luke calls you.

		[SeedTrader] 
		When you do meet the alchemist, please tell him I'm sorry. [EOA]
		
		<audio src='https://koetest.s3.amazonaws.com/Act3/Slap.mp3'/>
		He then gives your horse a big slap. The horse charges into the East, leaving Luke behind in the desert.
	*recap
		Luke asks you to keep going to the east. He also asks you to tell the alchemsit that he is sorry. 
	*then
		-> End of ACT III, all

@MysMan Says Wait I Know
	*say
		Just as you're about to leave, Luke grabs your hand and stops you from leaving.

        [SeedTrader]
        Wait! Stop! You can't leave. If you leave, you won't make it to the cave. [EOA]
        
        He looks at you with determined eyes.

        [SeedTrader]
        Yes. I know why you're here. You're here because you need to get to the cave. You're here because you needed the citrine to lift the curse. And I'm the only one who knows how. [EOA] [Action]

    *recap
		Luke stops you as you are about to leave. He says that he knows why you are here. [Conversation] Do you want to ask Luke why does he know that you are going to the cave? 
	*reprompt
		Do you want to ask Luke why does he know that you are going to the cave? Or just ask him about the cave?
	*then
		hear how did you know, how, why, yes {
            -> Luke Explains How He Knows
        }
        hear cave, about the cave, no {
			flag plot3
            -> Luke Explains the Cave
        }

@Luke Explains How He Knows
	*say
		[SeedTrader]
        When I first met you, you still had that stinky smell that I could recognize anywhere. You came from the West, and there's only one reason for anyone to travel this far in the desert for a cave they've never heard before. I know all of this, because I was a part of the story. [EOA]
	*then
		-> Luke Explains Plot 3

@Luke Explains Plot 3
	*say
		[SeedTrader]
        I learned from the townsfolk that the curse was caused by an alchemist. I am also an alchemist, hence all these vials and bottles I carry; but any alchemist would know that a curse is not something that we would do. [EOA]
        
        Luke let's go of your hand. 
        
        [SeedTrader]
        Oh, I'm sorry. Anyways, as a fellow alchemist, I've been searching for ingredients that might help alleviate the situation. From time to time I've traveled back to the town and asked for any clues or information about the alchemist. [EOA]
        
		<audio src='https://koetest.s3.amazonaws.com/Act3/goingThroughShelves_01.mp3'/>
        Luke then goes through the piles of notes on the ground and retrieves a black little book.
        
        [SeedTrader]
        From the information I gathered regarding the alchemist, the cave and what-not, I think I have a good guess on a challenge that lies in the cave.[EOA] [Action]
        
    *reprompt
        Luke reveals that he is also an alchemist, volunteered to help with the cause whenever he can. He also knows what challenge is in the cave, which you might want to ask?

    *recap
        Luke looks confused and didn't understand. [Conversation] You might want to ask about the challenge in the cave.
        
	*then
		hear why, why don't you go {
            -> Luke Explains Why He Can't Go plot 3
        }
        hear what are the puzzles, the challenges, what challenge, challenge {
			flag plot3
            -> Luke Explains the Cave
        }

@Luke Explains Why He Can't Go plot 3
	*say
		[SeedTrader]
        I wanted to go, but I have my own business to look after. Living in the desert is not something particularly easy, you know. On the other hand, you are going, and I can tell you about the challenges, so let's get to it?[EOA] [Pause]
	*then
		hear what are the challenges, the challenges, sure, yes {
		    flag plot3
            -> Luke Explains the Cave
        }

@One More Thing Plot 3
	*say
		[SeedTrader]
        Oh, by the way. [EOA]
        
		<audio src='https://koetest.s3.amazonaws.com/Act3/goingThroughShelves_01.mp3'/>
        Luke goes to an old wooden chest and takes out a purple seed.

        [SeedTrader]
        This is what you'll need for the antidote. It's called the Eureka seed. The townsfolk may have told you that the citrine is the key ingredient, but they were only half-right. Only combining the citrine and the Eureka seed can one brew a successful antidote. Take it with you. [EOA]
        
        Luke walks to the entrance and sticks his head out.

        [SeedTrader]
        The day is not young. You must go before the sandstorm comes and catch you again. Or if you want to, you can stay here for a while to wait for the storm to leave. [EOA]
        
        You can pause your journey and take some rest here, or you can continue and hurry to the cave. [Conversation] Would you like to leave for the cave? [Action]
	*reprompt
		uke has handed you a purple seed that is crucial to producing the antidote. Now you may choose to pause your journey and take some rest here, or you may leave and continue to the cave. Would you like to leave for the cave?
	*recap
		Luke gives you a purple seed called Eureka seed. You may choose to pause, or leave and continue to the cave. Would you like to leave for the cave?
	*then
		flag plot3
        hear yes, leave for the cave, continue {
            -> End of ACT III, 3
        }
        hear no, rest {
            -> Quit Game
        }

@End of ACT III, 3
	*say
		//(Sound Effect: Horse Neighing)
		<audio src='https://koetest.s3.amazonaws.com/Act3/horseNeighing_01.mp3'/>

        [SeedTrader]
		Very well then. Keep riding to the East. The valley is close. Follow the plant roots and you will reach the cave eventually. Both of you walk slowly outside the tent. [EOA]
		
		It looks like Luke has something to tell you, but he's trying to keep it to himself.
		
		[SeedTrader]
		Hey! {playerName}! [EOA]
		
		As you make yourself comfortable on the saddle, Luke calls you.

		[SeedTrader]
		If you do meet the alchemist in the end, I would imagine that he demanded the name of this seed. You know, alchemists are all alike, can't trust anything unless they know what it is. Make sure you tell him the name, won't you? [EOA]
		<audio src='https://koetest.s3.amazonaws.com/Act3/Slap.mp3'/>
		He then gives your horse a big slap. The horse charges into the East, leaving Luke behind in the desert.
	*then
		-> End of ACT III, all

@MysMan Spills the Tea
	*say
		[SeedTrader]
		Yes, this stinky plant emits a funny and unsettling smell. So unsettling that it can, it can, pollute the water. [EOA]

		//(Sound Effect, cloth flapping in the blowing wind)

		Luke silences for a long 3 seconds. All you can hear is the wind and the tent flapping in the wind. He doesn't look right. [Conversation] You can ask him what happened.  [Action]
	*recap
		Luke reluctantly tells you that the stinky plant can pollute water. You can ask him what happened. 
	*reprompt
		You can ask him what happened. 
	*then
		hear what happened, tell me more {
            -> Mysman Tells the Story Plot 4
        }

@Mysman Tells the Story Plot 4
	*say
		[SeedTrader]
		It's nothing. [EOA]

		Luke smirks a bit.

		[SeedTrader]
		Some time ago, a friend of mine was experimenting with this plant. [EOA]
		
		Luke points to the vial of stinky plant.

		[SeedTrader]
		He believes that he can turn this unpleasant smell into something lovable and out of this world. But he failed, very hard. The scent became so bad that he had to abandon his lab. [EOA]
		
		Luke looks to the ground for a bit, then turns away from you.

		[SeedTrader]
		That's the last time I heard from him. [EOA]
		[Action]

		Before you could ask any questions, he presses on with the conversation.

		[SeedTrader]
		You, on the other hand. [Pause] I know what you want. Yes. You want to go to the cave, don't you? Some town in the west needs your help. I've heard travelers here and there trying to get into the cave, and I've seen it myself too. I know that a challenge awaits you in the cave. [EOA] [Action] 
		
		*reprompt
		Luke tells you the story of  his friend who friend experimented the stinky plant but ended up failing miserably.
		Then, he mentions a challenge that awaits you in the cave.
		You may want to ask him more on that.

		
		*recap
		Luke squints his eyes and puts his ears closer to you, like he didn't understand. You might want to ask him more about the challenge?

	*then
		hear what is the challenge, tell me more, the challenge, more about the challenge, more about{
			flag plot4
            -> Luke Explains the Cave
        }
        hear why didn't you enter the cave, why, you {
            -> Luke Explains Why He Can't Go plot 4
        }

@Luke Explains Why He Can't Go plot 4
	*say
		[SeedTrader]
        Why I can't go? Well, as you can see how I ended up with that cow plantout there, I'm not the physical type. [EOA] [Action]
	*recap
		Luke squints his eyes and puts his ears closer to you, like he didn't understand. You might want to ask him more about the challenge?

	*then
		hear what is the challenge, tell me more, the challenge, more about the challenge, more about{
			flag plot4
            -> Luke Explains the Cave
        }

@One Last Thing Plot 4
	*say
		[SeedTrader]
		Oh, almost forgot. [EOA]

		Luke heads under his bed and pulls out an old chest. In it he takes out a vial that contains a purple seed.

		[SeedTrader]
		I've been also researching on how to get rid of this mess. It seems like besides the Citrine, you would also need this seed to make the antidote. [EOA]
		
		Luke hands over the vial to you.
		
		[SeedTrader]
		This is the Eureka seed. Take it with you. You'll need it. [EOA]

		Luke walks to the entrance and sticks his head out.
		
		[SeedTrader]
		The day is not young. You must go before the sandstorm comes and catch you again. Or if you want to, you can stay here for a while to wait for the storm to leave. [EOA]

		You can pause your journey and take some rest here, or you can continue and hurry to the cave. [Conversation] Would you like to leave for the cave? [Action]

	*reprompt
		Luke has handed you a purple seed that is crucial to producing the antidote. Now you may choose to pause your journey and take some rest here, or you may leave and continue to the cave. Would you like to leave for the cave?

	*recap
		You may choose to pause, or leave and continue to the cave. Would you like to leave for the cave?
	*then
		flag plot4
		hear yes, leave for the cave, continue {
            -> End of ACT III, 4
        }
        hear no, puase, rest {
            -> Quit Game
        }

@End of ACT III, 4
	*say
		//(Sound Effect: Horse Neighing)
		[SeedTrader]
		Very well then. Keep riding to the East. The valley is close. Follow the plant roots and you will reach the cave eventually. [EOA]
		
		Both of you walk slowly outside the tent. It looks like Luke has something to tell you, but he's trying to keep it to himself.

		[SeedTrader]
		Hey, {playerName}! [EOA]

		As you make yourself comfortable on the saddle, Luke calls you.

		[SeedTrader]
		Good luck. I hope you find the solution and restore the town to its former glory. [EOA]

		<audio src='https://koetest.s3.amazonaws.com/Act3/Slap.mp3'/>
		He then gives your horse a big slap. The horse charges into the East, leaving Luke behind in the desert.

	*then
		-> End of ACT III, all

@End of ACT III, all
	*then
		-> leading_puzzle_start

@global append
	*then
		hear restart, start over {
            >> RESTART
        }
        //hear jump to saloon {
        //    -> Leave the Store
        //}
        // hear get the hot sauce, I have your sauce, I have the hot sauce {
        //     set currentLocation as 'Mayors Office'
        //     -> Get the Hot Sauce
        // }
		hear test name input {
			-> Ask Shopkeeper
		}

        hear where am I, current location, tell me my location {
            -> Where am I
        }
        hear help {
            -> Help
        }
        //hear enter puzzle {
        //    -> PuzzleDemoStart
        //}
        //hear puzzle hint, hint {
        //   -> puzzle_help
        //}
		hear test audio {
			-> Test Audio
		}

		hear jump {
			-> jumpto
		}

@jumpto
	*say
		Do you want to jump to puzzle or act?
	*then
	    hear act{
	        -> jumptoact
	    }
	    hear puzzle{
	        -> jumptopuzzle
	    }

@jumptoact
	*say
		which act
	*then
	    hear two{
	        -> The Cross
	    }
	    hear three{
	        -> MysMan Introduces Himself
	    }
	    hear four{
	        -> leading_puzzle_start
	    }
	    hear five{
	        -> Arrival At The Inner Cave
	    }

@jumptopuzzle
	*say
		which puzzle would you like play? We have four puzzles with difficulty levels from easy to hard. They are hot sauce puzzle, cow plant puzzle, leading flower puzzle, and escape the lab puzzle.
	*then
	    hear hot sauce, hot{
	        -> puzzle_intro_sneaking
	    }
	    hear cow plant, cow, plant, cowplant{
	        -> puzzle_intro_cowplant
	    }
	    hear leading flower{
	        -> puzzle_intro_leadingflower
	    }
	    hear escape room, escape{
	        -> puzzle_intro_escape
	    }

@puzzle_intro_sneaking
	*say
		You thanked the shopkeeper and left the store. Now you are in front of Misses Chilirosa's beauty salon. It's in a house.
		Misses Chilirosa has the only bottle of super duper hot blue pepper sauce. You need to get the hot sauce from her.
	*then
		-> Open the Beauty Salon Directly

@puzzle_intro_cowplant
	*say
		On your journey to the oasis, a stranger saved you from the sandstorm. 
		You wake up and find yourself in a tent. You decide to find out what's going on.
	*then
		-> Been Walking For Days

@puzzle_intro_leadingflower
	*say
		Luke thanked you for saving him from the nasty cowplant. He not only told you about the cave but also gave you a magical singing flower. 
		With this magical flower, you can walk across the foggy forest.
	*then
		-> Luke Explains the Cave

@puzzle_intro_escape
	*say
		You finally see the alchemist in this distant oasis from the desert town. You were excited but nervous to meet her. However for some reason she locked you inside her lab. You still have tasks to do, and you have to get our of here.
	*then
		-> Escape The Room

@Test Audio
	*say
		<audio src='https://koetest.s3.amazonaws.com/Act5/Act5puzzle/closebook_01.mp3'/>
		<audio src='https://koetest.s3.amazonaws.com/Act5/Act5puzzle/openbook_01.mp3'/>
		<audio src='https://koetest.s3.amazonaws.com/Act5/Act5puzzle/ice_01.mp3'/>
		<audio src='https://koetest.s3.amazonaws.com/Act5/Act5puzzle/metalcrack_01.mp3'/>
		<audio src='https://koetest.s3.amazonaws.com/Act5/Act5puzzle/newspaper_01.mp3'/>
		// <audio src='https://koetest.s3.amazonaws.com/afa/af4_worry.mp3'/>
		// <audio src='https://koetest.s3.amazonaws.com/afa/afa11_fail_angry.mp3'/>
		// <audio src='https://koetest.s3.amazonaws.com/afa/afa16_whoah+.mp3'/>
		// <audio src='https://koetest.s3.amazonaws.com/afa/afa18_suprise+.mp3'/>
		// <audio src='https://koetest.s3.amazonaws.com/afa/afa19_face_disgust.mp3'/>
	*then
		hear continue {
		    -> TA2
	    }

@TA2
	*say
		
		<audio src='https://koetest.s3.amazonaws.com/Act5/Act5puzzle/portalopen_01.mp3'/>
		<audio src='https://koetest.s3.amazonaws.com/Act5/Act5puzzle/portaltravel_01.mp3'/>
		<audio src='https://koetest.s3.amazonaws.com/AchievementSounds/achievement01.mp3'/>
		<audio src='https://koetest.s3.amazonaws.com/AchievementSounds/achievement02.mp3'/>
		// <audio src='https://koetest.s3.amazonaws.com/Act1/drinkingNoises.mp3'/>
		// <audio src='https://koetest.s3.amazonaws.com/Act1/thunder11s.mp3'/>
		// <audio src='https://koetest.s3.amazonaws.com/Act1/thunder22s.mp3'/>
		// <audio src='https://koetest.s3.amazonaws.com/Act1/sandRun3s.mp3'/>  
		// <audio src='https://koetest.s3.amazonaws.com/Act1/sandRun7s.mp3'/>
		
	*then 
		hear continue {
			-> TA3
		}

@TA3
	*say
		<audio src='https://koetest.s3.amazonaws.com/Act2/footstepsTowardsYou.mp3'/>
		<audio src='https://koetest.s3.amazonaws.com/Act2/SlowlyTowardsYou.mp3'/>
		<audio src='https://koetest.s3.amazonaws.com/new_demo_stereo/openWindows.mp3'/>
		//<audio src='https://koetest.s3.amazonaws.com/new_demo_stereo/doorOpen1.mp3'/> // guale
		<audio src='https://koetest.s3.amazonaws.com/new_demo_stereo/doorOpen2.mp3'/>
	*then 
		hear continue {
			-> TA4
		}

@TA4
	*say
		<audio src='https://koetest.s3.amazonaws.com/Act2/windCurtain.mp3'/>
		<audio src='https://koetest.s3.amazonaws.com/Act3/horseGalloping.mp3'/>
		<audio src='https://koetest.s3.amazonaws.com/Act2/knockDoor.mp3'/>
		<audio src='https://koetest.s3.amazonaws.com/Act2/bashDoor.mp3'/>
		<audio src='https://koetest.s3.amazonaws.com/new_demo_stereo/strongWind.mp3'/>
	*then
		hear continue {
			-> TA5
		}

@TA5
	*say	
		<audio src='https://koetest.s3.amazonaws.com/Act3/cowplantSounds_01.mp3'/>
		<audio src='https://koetest.s3.amazonaws.com/Act3/goingThroughShelvesGlassy.mp3'/>
		<audio src='https://koetest.s3.amazonaws.com/Act3/handSmacking_01.mp3'/>
		<audio src='https://koetest.s3.amazonaws.com/Act3/aPersonThrowingHimself_01.mp3'/>
		<audio src='https://koetest.s3.amazonaws.com/Act3/smallWind_01.mp3'/>
		
		
	*then
		hear continue {
			-> TA6
		}

@TA6
	*say
		<audio src='https://koetest.s3.amazonaws.com/Act3/goingThroughShelves_01.mp3'/>
		<audio src='https://koetest.s3.amazonaws.com/Act3/grabDust.mp3'/>
		<audio src='https://koetest.s3.amazonaws.com/Act3/sparklingSound.mp3'/>
		<audio src='https://koetest.s3.amazonaws.com/Act5/magicSound01.mp3'/>
		//<audio src='https://koetest.s3.amazonaws.com/Act5/magicSound02.mp3'/>  // gua le
		
		
	*then
		hear continue {
			-> TA7
		}

@TA7
	*say
		<audio src='https://koetest.s3.amazonaws.com/Act5/magicSound03.mp3'/>
		<audio src='https://koetest.s3.amazonaws.com/Act5/magicSound04.mp3'/>
		<audio src='https://koetest.s3.amazonaws.com/Act3/horseNeighing_01.mp3'/>
		<audio src='https://koetest.s3.amazonaws.com/Act3/strongWinds_01.mp3'/>
		<audio src='https://koetest.s3.amazonaws.com/Act3/clothFlapping_01.mp3'/>
		
	*then
		hear continue {
			-> TA8
		}

@TA8
	*say
		<audio src='https://koetest.s3.amazonaws.com/Act3/Slap.mp3'/>
		<audio src='https://koetest.s3.amazonaws.com/Act3/horseGalloping.mp3'/>
		<audio src='https://koetest.s3.amazonaws.com/Act5/stoneDoor.mp3'/>
		<audio src='https://koetest.s3.amazonaws.com/Act5/bushRustling.mp3'/>
		<audio src='https://koetest.s3.amazonaws.com/Act5/stoneDoor.mp3'/>
	*then
		hear continue {
			-> TA9
		}

@TA9
	*say
		
		<audio src='https://koetest.s3.amazonaws.com/Act5/VinGrowing.mp3'/>
		<audio src='https://koetest.s3.amazonaws.com/Act5/magicSound01.mp3'/>
		//<audio src='https://koetest.s3.amazonaws.com/Act5/magicSound02.mp3'/>
		<audio src='https://koetest.s3.amazonaws.com/Act5/magicSound03.mp3'/>
		<audio src='https://koetest.s3.amazonaws.com/Act5/magicSound04.mp3'/>
	*then
		hear continue {
			-> TA10
		}

@TA10
	*say
		
		<audio src='https://koetest.s3.amazonaws.com/Act5/explode01.mp3'/>
		<audio src='https://koetest.s3.amazonaws.com/Act5/explode02.mp3'/>
		<audio src='https://koetest.s3.amazonaws.com/Act5/explode03.mp3'/>
		<audio src='https://koetest.s3.amazonaws.com/Act5/walkOnDirt.mp3'/>
		<audio src='https://koetest.s3.amazonaws.com/Act5/smokePoof.mp3'/>
	*then
		hear continue {
			-> TA11
		}

@TA11
	*say
		
		<audio src='https://koetest.s3.amazonaws.com/Act5/PouringRain.mp3'/>
		<audio src='https://koetest.s3.amazonaws.com/Act5/PouringRain02.mp3'/>
		<audio src='https://koetest.s3.amazonaws.com/Act5/townBell.mp3'/>
		<audio src='https://koetest.s3.amazonaws.com/Act5/townBell2.mp3'/>
		<audio src='https://koetest.s3.amazonaws.com/Act5/openBottle.mp3'/>
	*then
		hear continue {
			-> TA12
		}

@TA12
	*say
		
		<audio src='https://koetest.s3.amazonaws.com/Act5/takePhoto.mp3'/>
	*then
		>> END

@Where am I
	*say
		Now you are in {currentLocation}.
	*then
		>> BACK

//TODO: update the help content

@Help
	*say
		Here is what you can do: 
            if you want to know your current location, say: where am I; 
            if you want to restart the whole game, say: restart; 
            if you want to revisit the beauty saloon, say: go to saloon.
            if you want to revisit the mayor's office, say: get the hot sauce.
	*then
		>> BACK

// ACT V Start

@Arrival At The Inner Cave
	*show
		template: 'default'
        background:'https://koetest.s3.amazonaws.com/visuals/Cave/caveLight2.png'
        title: ''
        subtitle: ''
	*say
		You push through the stone doors.
		//(SE: stone doors)
		<audio src='https://koetest.s3.amazonaws.com/Act5/stoneDoor.mp3'/>
		Immediately, you are greeted with glaring rays of light. 
		Isn't this supposed to be a cave?

	*then
		-> Arrival At The Inner Cave 2

@Arrival At The Inner Cave 2
	*show
		template: 'default'
        background:'https://koetest.s3.amazonaws.com/visuals/Cave/plant2.png'
        title: ''
        subtitle: ''
	*say
		Because right in front of you is not a cave, but a sinkhole 
		filled with all kinds of greens and plants.
	*then
		-> Arrival At The Inner Cave 3

@Arrival At The Inner Cave 3
	*show	
		template: 'default'
        background:'https://koetest.s3.amazonaws.com/visuals/Cave/plant1.png'
        title: ''
        subtitle: ''
	*say
		//(SE: sounds of bushes bristling)
		<audio src='https://koetest.s3.amazonaws.com/Act5/OasisAmbience.mp3'/>
		
		Suddenly, you hear the tall grass rustling. Something's
		coming towards you.
		
		//(SE: sounds of bushes, with dramatic effect)
		<audio src='https://koetest.s3.amazonaws.com/Act5/bushRustling.mp3'/>
		From the bushes, pops out the head of a woman with faded purple
		hair. Should you tell her who you are and why you're here? [Action]
				
	*reprompt
		You passed the forest maze, into a hollowed space
		underground filled with natural sunlight, and life. Then, a
		woman with faded purple hair showed up in your face. Oh, and she also stinks.
		
	*recap
		The woman stands there like a statue. You should try say 
		something to get her attention? maybe just a "hi"?
	*then
		hear hi, hello, I am, I need, yes, no {
			-> Alchemist Grabs You
		}

@Alchemist Grabs You
	*say
		She stood there and looked at you as you speak. Her eyes are
		looking at you, but you can easily tell that She's nervous.

		[Alchemist]
		Um. Here. Please. [EOA]

		The woman takes your hand suddenly and almost pulls you
		towards a little hut in the cave.
		
		[Alchemist]
		Oh welcome to the cave. ok I need to
		work on something. please don't come
		out. I will be right with you in a
		moment. please don't come out, ok? [EOA]
		
		She puts you in the hut and closes the door.
		
		//(SE: Door closes)
		<audio src='https://koetest.s3.amazonaws.com/Act5/stoneDoor.mp3'/>
		//(SE: something grows)
		<audio src='https://koetest.s3.amazonaws.com/Act5/VinGrowing.mp3'/>
		As She closes the door, you see vines magically growing and
		tying up the hinges. You try to open it, but it
		didn't work. Oh no. You're locked inside.
	*then
		->Escape The Room

@Escape The Room
	*then
		-> escape_puzzle_intro

@Exit The Room
	*say
		[BAR_SURPRISED]

		As you finally figured out a way to leave the hut, you see
		the woman in your face, but terrified. She takes a few steps
		back, then stumbles on the ground.
		
		[Alchemist]
		Please don't hurt me! I've been trying
		to figure out a way to fix the problem
		I've caused. Wait, you don't look like
		you're from the town. [EOA]

		She looks at you for a moment. Then she stands up from the
		ground, getting the dirt off of her clothes. The dirt still clings to them, though.

		[Alchemist]
		Sorry, it's been a long time since
		I've talked to anyone. My name is Berette, an
		alchemist, and a botanist. I'm working
		on the last step to my latest work,
		care to join? [EOA] [Action]
	*reprompt
		Would you like to join?
		
	*recap
		The alchemist introduced herself and asked if you want to join her on the last step out of her work. Would you like to join?

	*then
		hear yes, sure {
            -> Join The Alchemist At the Cauldron
        }
        hear no, nope {
            -> Alchemist Asks Again
        }
        hear hand her the seed, the seed {
            -> Alchemist Asks
        }
        hear hand her the eureka plant, the plant {
            -> Alchemist Asks More
        }

@Join The Alchemist At the Cauldron
	*say

		[BAR_HAPPY]

		[Alchemist]
		Wonderful! I'll show you the way to my
		station. [EOA]

		Berette leads you to a cauldron set up outside. It's bubbling
		with many stuff that you don't know.

		[Alchemist]
		A long time ago, I did something
		terribly wrong. I've kept myself
		behind these stone doors so I can work
		on a solution to undo my mistakes. I
		think, today is my lucky day. [EOA]

		Berette walks to the cauldron.
		
		[Alchemist]
		Alright, ingredients, check. Solvent,
		check. Ok. Let's see if this works. [EOA]
		
	*recap
		The alchemist confessed to you. She kept her self behind the stone doors to work on a solution to undo her mistakes.
	*then
		-> Join The Alchemist At the Cauldron 2

@Join The Alchemist At the Cauldron 2
	*show
		template: 'default'
        background:'https://koetest.s3.amazonaws.com/visuals/Cave/waterAndCitrine.png'
        title: ''
        subtitle: ''
	*say
		The alchemist walks into the pond in the middle, towards the
		floating citrine in the middle. She takes out a vial and puts
		it under the gemstone.
		
	*then
		-> Join The Alchemist At the Cauldron 3

@Join The Alchemist At the Cauldron 3
	*show
		template: 'default'
        background:'https://koetest.s3.amazonaws.com/visuals/Cave/citrine.png'
        title: ''
        subtitle: ''
	*say
		//(SE: Miracles sounds)
		[MiracleSound01]
		Miraculously, a drop of a glowing
		liquid emerges from the gemstone.  It's so bright that it could be a star in
		the night.
		
		//(SE: Miracle sounds)
		[MiracleSound02]
		The pot starts to glow. A golden color emits from the
		cauldron.
		
		// (SE: Explosion)
		[Explosion]
		
		Suddenly, the contents of the pot explodes into Berette's
		face. 
				
		Berette slowly finds herself a chair, then sits down
		and cries.

		[Alchemist]
		I don't know! Why? I thought I had it all solved. I was hoping it would be ready by the time someone from the town arrived. [EOA] [Action]

	*reprompt 
		Berette extracts a magical substance from the
		citrine in the middle, and adds it into the cauldron she is
		working on. But the content explodes and Berette's experiment
		has failed again. Disappointed and depressed, she asks what
		ingredient she is missing. Perhaps the seed Luke gave you would help?
		
	*recap
		Berette asks if she's missing anything in his potion.
	*then
		hear hand her the seed, the seed, seed {
            -> Alchemist Asks
        }
        hear hand her the eureka seed, eureka, eureka seed {
            -> Alchemist Asks More
        }

@Alchemist Asks Again
	*say

		[BAR_HMM]

		[Alchemist]
		Just letting you know that you're about miss something
		that is beyond your knowledge. Why don't you come and have a look yourself?[EOA]

		[BAR_CONFIDENT]

		Berette looks at you with determined and confident eyes. Perhaps you should
		join him. What say you? [Action]
		
	*recap
		 You know, you've come this far, why not say yes?

	*then
		hear yes, sure, ok {
            -> Join The Alchemist At the Cauldron
        }
        hear no, nope {
            -> Alchemist Tell You to Stay Here
        }

@Alchemist Tell You to Stay Here
	*say
		[Alchemist]
        Ah, I see. You're the cautious type. Got it. Well,
		you just stay here and enjoy the show.[EOA]

	*then
		-> Alchemist Performs At the Cauldron And Fails

@Alchemist Performs At the Cauldron And Fails
	*say
		Berette walks to the cauldron.
		[Alchemist]
		Alright, ingredients, check. Solvent,
		check. Ok. Let's see if this works. [EOA]

		The alchemist walks into the pond in the middle, towards the
		floating citrine at the center. She takes out a vial and puts
		it under the gemstone.
		
		//(SE: Miracles sounds)
		[MiracleSound01]
		Miraculously, from the gemstone comes out a drop of a glowing
		substance. It's so bright that it could almost be a star in
		the night.
		Berette walks back to the cauldron, and adds in the drop of
		citrine.
		
		//(SE: Miracle sounds)
		[MiracleSound02]

		The pot starts to glow. A golden color emits from the
		cauldron.
		
		//(SE: Explosion)
		[Explosion]

		Suddenly, the contents of the pot explodes into Berette's
		face. 
				
		Berette slowly finds herself a chair, then sits down
		and cries.

		[Alchemist]
		I don't know! Why? I thought I had it all solved. I was supposed to be
		ready when someone arrives. What
		ingredient am I missing? [EOA] [Action]

	*reprompt 
		Berette extracts a magical substance from the
		citrine in the middle, and adds it into the cauldron she is
		working on. But the content explodes and Berette's experiment
		has failed again. Disappointed and depressed, she asks what
		ingredient she is missing. Perhaps your seed may help?
		
	*recap
		Berette asks if she's missing anything in her potion.

	*then
		hear hand her the seed, the seed {
            -> Alchemist Asks
        }
        hear hand her the eureka seed, eureka {
            -> Alchemist Asks More
        }

@Alchemist Asks
	*show
		template: 'default'
        background:'https://koetest.s3.amazonaws.com/visuals/Cave/cave_pond_withoutPeople.png'
        title: ''
        subtitle: ''
	*say
		You gave the seed to the alchemist. The master alchemist looks at it
		for a second, then stares at you with wide-opened eyes.

		[BAR_SURPRISED]

		[Alchemist]
		Who gave you this seed? [EOA] [Action]

	*reprompt
		You gave the purple seed you have to Berette. She
		now asks who gave you the seed.
		
	*recap 
		You gave the purple seed you have to Berette. She now
		asks who gave you the seed.
	
	*then
		hear luke {
            -> Alchemist Questions About Luke
        }
        hear desert trader, trader, seed {
            -> Alchemist Questions About the Seed
        }

@Alchemist Questions About Luke
	*say
		[BAR_ANGRY]
		[Alchemist]
		What? Luke gave you this seed? Luke
		[Pause] gave [Pause] you [Pause] this
		[Pause] seed? Oh, now he knows how to
		be an apprentice. To not stab his
		master in the back? Did he tell you
		what happened? [EOA] [Action]

	*reprompt 
		You told Barette that it was Luke who gave you the
		seed, and She seems to be enraged. She demands to know if Luke
		told you what happened.
	
	*recap
		[Alchemist]
		What? Is that a yes or a no? [EOA] 

	*then
		hear yes {
            -> Alchemist Continues to Scold Luke
        }
        hear no {
            -> None of It Matters Anyway
        }

@Alchemist Continues to Scold Luke
	*say
		[Alchemist] 
        So you knew all of it, right?
		Unbelievable. I thought we were
		partners and friends. And what did he
		do when the incident broke out? He
		went straight to the mayor and turned
		me in. [EOA]

		Barette walks around the room. You can almost see steam
		gushing out of her nose.
		
		[Alchemist] 
		Alright, what else did he say?[EOA] [Action]
	*then
		hear sorry {
            -> Alchemist Asks What Luke Says Again
        }
        hear nothing {
            -> Alchemist Scolds Luke Thrice
        }
        //TODO: update this part; shouldn't be 'anything else'
        hear anything else, don't know {
            -> Alchemist Scolds Luke For His Weird Behaviour
        }

@Alchemist Asks What Luke Says Again
	*say
		[BAR_SURPRISED]
		
		Barette looks astonished, as if she couldn't believe what she
		has heard.

		[Alchemist]
		What? Say that again? [EOA] [Action]

	*then
		hear sorry {
            -> Alchemist Sits Down
        }
        hear nothing {
            -> Alchemist Scolds Luke Thrice
        }
        //TODO: update this part; shouldn't be 'anything else'
        hear anything else {
            -> Alchemist Scolds Luke For His Weird Behaviour
        }

@Alchemist Scolds Luke Thrice
	*say
		[BAR_ANGRY]

		Barette seems disappointed and furious.

		[Alchemist]
		This mandrake, well he ought to give
		it to me. [EOA]

		Barette looks at you. She realizes that you may not understand
		something. She holds up the seed to you.

		[Alchemist]
		This, my friend, is a Glimmerbrook
		Mandrake. You don't find this
		anywhere. It is nearly impossible
		to get, like the citrine. If Luke
		managed to find this, well, he doesn't
		deserve it anyway. So I guess he made
		the right choice to give it to you. [EOA]

		Barette suddenly realizes something.

		[Alchemist]
		Hmm. perhaps we can try to add
		this into our mix? Come on, let's see
		what happens. [EOA]

	*then
		-> Alchemist Brews Potion

@Alchemist Scolds Luke For His Weird Behaviour
	*say
		[Alchemist]
		That's weird. Never thought Luke would
		say anything like that. Huh. anyways,
		he's not my apprentice anymore, and I
		deserve this Mandrake. [EOA]

		Barette looks at you for a second, then she realizes
		something.

		[Alchemist]
		Oh, yes. This seed, it's called the
		Glimmerbrook Mandrake. You don't come
		across this seed like you breathe
		air. It's basically as precious as the
		citrine. Not of this world. Magical.
		Judging by its rarity, and the fact
		that Luke gave you this, it's probably
		worth a shot. [EOA]

		Barette stops writing and closes her notebook swiftly

		[Alchemist]
		Today, I will go home. I will end this
		mess once and for all. [EOA]

	*then
		-> Alchemist Brews Potion

@Alchemist Sits Down
	*say
		[Alchemist]
		Oh. [EOA]

		Barette slowly moves to his hut, and looks at a photo on the
		wall. It is a photo of him and Luke in the lab, except the
		cauldron was on fire.

		[Alchemist]
		After all this time, huh? [EOA]
		
		[BAR_SIGH]
		She quietly sits down on a chair.


		[Alchemist]
		You know, you we used to be partners.
		Luke and I. Together, we've
		accomplished many things that no
		alchemist or botanist has ever done.
		He was a dear friend. [EOA]

		Barette then smiles a bit. She looks down on the ground.

		[Alchemist]
		Our first successful experiment was with a rose. We were trying to make it transparent. We had the radio on that day, and it just so happened that when we did it, the guy in the radio yelled out Eureka! as well. perfect timing.
		So, that became the phrase we'd cheer whenever
		we accomplished something together. [EOA]

		Barette then realizes that she went off on her own.

		[Alchemist]
		You said this seed was from him? [EOA] [Action]
	*reprompt
		Is this seed really from the seed trader?
	*recap
		Is this seed really from the seed trader?
	*then
		hear yes, sure {
            -> Alchemist Accepts
        }
        hear no {
            -> Alchemist Smirks And Accepts
        }

@Alchemist Accepts
	*say

		[BAR_SAD]

		[Alchemist]
		Oh pal. How long have I waited for
		you. [EOA]

		Then she turns around and looks at the seed.

		[Alchemist]
		If Luke gave you this, and knows that
		you're coming for me, then this has to
		be the key ingredient that I'm
		missing. [EOA]
		
		Suddenly, she looks like she realizes something.

		[Alchemist]
		I have an idea. Help me up, will you?  [EOA] [Action]

	*recap 
		You should pull her up from the chair.
		
	*then
		hear pull, pull her up, help, up, chair, sure, ok, yes {
			-> Alchemist Brews Potion
		}

@Alchemist Smirks And Accepts
	*say
		[BAR_LAUGH]

		[Alchemist]
		Very much like what he would do.
		He would always put up a good fight until you
		corner him. [EOA]

		Then she looks at the seed in her hand.

		[Alchemist]
		If Luke gave you this precious seed
		and knows that you'll end up meeting me
		eventually, then he probably also knows that
		this seed must be the key ingredient
		that's missing. 
		
		Suddenly, she looks like she realizes something.

		[Alchemist]
		I have an idea. Help me up, will you?  [EOA] [Action]

	*recap 
		You should pull her up from the chair.
		
	*then
		hear pull, pull her up, help, up, chair, sure, ok, yes {
			-> Alchemist Brews Potion
		}

@None of It Matters Anyway
	*say
		[BAR_HMM]
		[Alchemist]
		Huh. Can't say that I'm surprised by
		now. Took me so long to realize what
		kind of person he is. [EOA]

		Barette walks swiftly to her notebook by the table, with the
		seed in her hand. She talks to you while she puts down notes in
		her book.

		[Alchemist]
		Luke was my apprentice. Or should've
		been. The night the when the
		experiment went wrong, he left and
		turned my name in to the mayor. I
		mean, I admit, I messed it up, but was
		that really necessary? [EOA]

		Barette then stops for a moment as she continues to scribble.

		[Alchemist]
		None of it matters anyway now. What
		else did he say? [EOA] [Action]
	*reprompt
		She asks you what did Luke say to you. When you left the tent, Luke had asked you to apologize to the alchemist for him.
	*recap
		The alchemist told you that Luke the seed trader was once her apprentice. However, her experiment went wrong one night and Luke turned her name into the mayor.
		She asks you what did Luke say to you. When you left the tent, Luke had asked you to apologize to the alchemist for him.

	*then
		hear sorry {
            -> Alchemist Asks What Luke Says Again
        }
        hear nothing {
            -> Alchemist Scolds Luke Thrice
        }
        //TODO: update this part; shouldn't be 'anything else'
        hear anything else {
            -> Alchemist Scolds Luke For His Weird Behaviour
        }

@Alchemist Questions About the Seed
	*say
		[BAR_SURPRISED]
		Barette seems very, very surprised.
		
		[Alchemist]
		Wow. Do you even know what this seed
		is? It's a miracle that you come
		across it. It's called the
		Glimmerbrook Mandrake. You don't just
		find it here, or anywhere. Frankly,
		you can't find it in this world.
		Anyways, this person you meet, must be
		a great botanist, or a great magician,
		or both. [EOA]

		She takes another careful look at the seed. Suddenly, she jumps
		up and looks at you with shining eyes.

		[Alchemist]
		Given the rarity of this seed... this
		could be the key ingredient to our
		potion. 
		
		Suddenly, she looks like she realizes something.

		[Alchemist]
		I have an idea. Help me up, will you?  [EOA] [Action]

	*recap 
		You should pull her up from the chair.
		
	*then
		hear pull, pull her up, help, up, chair, sure, ok, yes {
			-> Alchemist Brews Potion
		}

@Alchemist Asks More
	*show
		template: 'default'
        background:'https://koetest.s3.amazonaws.com/visuals/Cave/cave_pond_withoutPeople.png'
        title: ''
        subtitle: ''
	*say
		You gave the seed to the alchemist. The alchemist looks at it
		for a second, then looks at you with confused but trembling
		eyes.

		[Alchemist]
		What? This is called Eureka? Who told
		you that it's called Eureka? [EOA] [Action]

	*reprompt 
		You gave the Eureka seed you have to Berette. She
		now asks who told you that the seed is called Eureka.
		
	*recap 
		You gave the Eureka seed you have to Berette. She now
		asks who told you that the seed is called Eureka. 

	*then
		hear yes, yeah {
            -> Alchemist Realizes
        }
        hear no {
            -> Alchemist Smirks
        }

@Alchemist Realizes
	*say
		[Alchemist]
		Oh. [EOA]

		The alchemist pauses for a second. Then she slowly walks back
		to the hut.
		
		//(SE: Walks on dirt)
		
		She looks at a photo on the wall. It's a photo of her with
		Luke when the cauldron in front of her explodes.

		[BAR_SAD]

		[Alchemist]
		Oh. Partner. Why don't you just come
		to me directly? It's been so long. [EOA]
		
		Barette looks at you. She then smiles.

		[Alchemist]
		That man you just met outside the
		tent, well, he's officially known as
		an apprentice to me. But I see him as
		my partner. [EOA]

		Barette then holds up the Eureka seed to you.

		[Alchemist]
		This is not called Eureka. This, is a
		Glimmerbrook Mandrake. Eureka, on the other hand, is a
		word we use back in the day to
		celebrate the progress we made. [EOA]

		Barette sits there quietly.
		
		[Alchemist]
		This seed. you don't just come across
		it here. Or anywhere. It's just as
		hard to find as the citrine is. If he
		gave this seed to you, and didn't ask
		for anything in return, this could
		only mean that it's the ingredient
		we're missing. [EOA]

		Barette then extend her hands to you.

		[Alchemist]
		Let's get this
		potion finished, and end this crisis
		once and for all. Come on, give me a hand, will you?[EOA] [Action]

	*reprompt 
		Barette realized something as soon as you revealed to her the person
		who thought the seed's name is Eureka. It turns out that Luke was
		Barette's lab partner before, and the word Eureka is a word
		that only the two would use before; no matter what happened
		before, Barette is not angry with Luke anymore. Now, with the
		seed, Barette is ready to use the seed and end the stinky
		curse once and for all. She extends her arm and asks you to
		pull her up from the chair.
		
	*recap 
		You should pull her up from the chair.
		
	*then
		hear pull, pull her up, help, up, chair, sure, ok, yes {
			-> Alchemist Brews Potion
		}

@Alchemist Smirks
	*say
		The Alchemist exhales deeply. She then looks at you with a
		smirk on his face.

		[Alchemist]
		This is not called Eureka, my friend.
		This, is a Glimmerbrook Mandrake. [EOA]

		Barette then looks up into the sky, and talks slowly.

		[Alchemist]
		You know, back in the day the word
		Eureka meant something to me. It's
		just a silly phrase that me and my old
		friend use all the time. Haven't seen
		him for a long time. [EOA]
		
		Barette walks back to her hut.
		
		//(SE: Walk on dirt)
		<audio src='https://koetest.s3.amazonaws.com/Act5/walkOnDirt.mp3'/>

		She looks at a photo on the wall. It's a photo of her and
		Luke, taken when the cauldron in front of her explodes.

		[Alchemist]
		We had a big fight one night over
		procedures of a certain experiment.
		Turned out he was right. I was too
		eager and too confident. After that
		night, the water and the soil of the
		town are all contaminated. [EOA]

		Barette looks down on the ground, then you.

		[Alchemist]
		That's why I fled away. I couldn't
		dare face the anger of the
		townspeople. I hid myself within these
		caves, and I told myself that I'd
		never come out until I figure out a
		solution. [EOA]


		[BAR_SMILE]
		She holds up the mandrake seed, and smiles at it.

		[Alchemist]
		Well, this could be our lucky day.
		Let's see if this works, shall we?
		Can you pull me up from this chair? [EOA] [Action]

	*reprompt 
		Barette realized something as soon as you told her
		who named the seed Eureka. It turns out that Luke was
		Barette's lab partner before, and the word Eureka is a word
		that only the two would use before; no matter what happened
		before, Barette is not angry with Luke anymore. Now, with the
		seed, Barette is ready to use the seed and end the stench once and for all. She extends her arm and asks you to
		pull her up from the chair.
		
	*recap 
		You should pull her up from the chair.
		
	*then
		hear pull, pull her up, help, up, chair, pull her up from the chair, yes, sure, ok {
			-> Alchemist Brews Potion
		}

@Alchemist Brews Potion
	*show
		template: 'default'
        background:'https://koetest.s3.amazonaws.com/visuals/Cave/pond.png'
        title: ''
        subtitle: ''
	*say
        Barette quickly walks back to the cauldron. She extracts
		another drop of substance the citrine releases.
		After adding all the regular ingredients, there is one thing
		left to do: add the mandrake seed. 

		[Alchemist]
		Here goes nothing. [EOA]
	*then
		-> Alchemist Brews Potion 2

@Alchemist Brews Potion 2
	*show
		template: 'default'
        background:'https://koetest.s3.amazonaws.com/visuals/Cave/cave_pond_withoutPeople.png'
        title: ''
        subtitle: ''
	*say
		She allows the seed to slip and roll of her palm. The seed
		slowly falls and enters the pot.
		
		//(SE: Explode)
		<audio src='https://koetest.s3.amazonaws.com/Act5/explode02.mp3'/>

		Poof! Smoke emerges from the pot. Strangely, you see sparkles
		of purple within the fog. It swiftly rises and fills the roof.

		[Alchemist]
		This is unlike anything I've
		seen. Oh dear.[EOA]

		In just a few seconds, the fog gathers into clouds above
		their heads.

		[Alchemist]
		What was that?[EOA]

		Barette suddenly asks. You felt the same thing. Water.
		
		//(SE: starts to rain)
		<audio src='https://koetest.s3.amazonaws.com/Act5/PouringRain02.mp3'/>

		The cave starts pouring rain. But it was no ordinary rain.
		The raindrops that are supposed to hit your harshly, instead
		feel like cool splashes of spring water.
		As you look to Barette, you noticed something else: she no
		longer smells.

		[Alchemist]
		The smell. It's gone. We did it! We
		did it, visitor! We've found the
		solution![EOA]

		Barette holds his hand tightly, and punches into the sky.

		[Alchemist]
		Eureka![EOA]

		Then she hugs you tightly, and dances around like it's the best of her life.

		[Alchemist]
		Quick! Pack your stuff immediately. We
		will end this chaos once and for all.[EOA]

		//(SE: horses galloping)
		<audio src='https://koetest.s3.amazonaws.com/Act3/horseGalloping.mp3'/>

		As you close in on the town, you could smell that stench
		again.

		[Alchemist]
		Don't worry guys, I'm here to correct
		everything.[EOA]

		A woman in the town shouts.
		
		[MrsChilirosa]
		Look! It's the alchemist![EOA]

		//(SE: Town bell)
		<audio src='https://koetest.s3.amazonaws.com/Act5/townBell.mp3'/>

		The town bell rings. Although they'd prefer not to, the
		townspeople all come out to check what's going on.

		[Mayor]
		Look who's back here. Did you
		return only to give us yet another
		curse?[EOA]

		The mayor looks surpised and disappointed.

		[Alchemist]
		No! People. I came back here because I
		knew I did something terrible. I came
		back because I've found a way to fix
		all of this.[EOA]

		[MrsChilirosa]
		Oh, is that so? How do you propose to
		fix this disaster?[EOA]

		[Alchemist]
		By doing this![EOA]

		Barette takes out the vial containing the purple potion.

		[Man]
		No! Not one of your tricks again,
		wizard! We don't trust you.[EOA]

		[Alchemist]
		Please! You must believe me.[EOA]

		[MrsChilirosa]
		Get out of here.[EOA]

		The crowd boos at Barette, chanting for her immediate
		leave. The mayor seems a little bit hesitant.
		Barette looks at you. She gives you the vial.

		[Alchemist]
		Open the vial. Show them that they're
		wrong.[EOA]

		Will you open the vial? [Action]
	*recap
		[Alchemist]
		Open the vial. Show them that they're
		wrong.[EOA]

		Will you open the vial? [Action]

	*reprompt
		[Alchemist]
		Open the vial. Show them that they're
		wrong.[EOA]

		Will you open the vial? [Action]

	*then
		hear yes, sure, will {
			-> Open the Vial
		}
		hear no, nope {
			-> Dont Open the Vial
		}

@Open the Vial
	*say	
		You opened the vial without hesitation. Smoke glittering
		purple comes out of the bottle, and into the sky. In no time,
		the blue sky is filled with purple clouds.
		As expected, it starts raining. The stench starts to wear
		away.

	*then
		-> After Opening the Vial

@Dont Open the Vial
	*say
		You stood there and do nothing.
		
		[Mayor]
		We've
		seen what you're capable of. You even
		turned our visitor against us. You
		must leave. [EOA]

		[MrsChilirosa]
		Leave! Leave! Leave![EOA]
		
		[Man]
		Leave! Leave! Leave![EOA]
		
		[Kid]
		Wait![EOA]

		The shopkeeper's son yells at the crowd.

		[Kid]
		I believe her.[EOA]

		Slowly, he walks towards you, and takes over the potion.

		[Man]
		Boy, what are you doing?[EOA]

		[Kid]
		Fixing all of us.[EOA]

		<audio src='https://koetest.s3.amazonaws.com/Act5/explode02.mp3'/>
		In a blink of an eye, the boy opens the vial. Smoke
		glittering purple comes out of the bottle, and into the sky.
		In no time, the blue sky is filled with purple clouds.
		As expected, it starts raining. The stench starts to wear
		away.

	*then
		-> After Opening the Vial

@After Opening the Vial
	*say
		<audio src='https://koetest.s3.amazonaws.com/Act5/PouringRain.mp3'/>

		[RANDOMMAN_SURPISED]

		[Man]
		Wa, what? What's going on?[EOA]

		[Chili_Surprised]

		[MrsChilirosa]
		Is my nose going crazy?[EOA]

		[MAYOR_HAPPY]

		[Mayor]
		No.. it's the stench. It's getting
		washed away! Everyone! Come outside!
		The rain is washing away the stench![EOA]

		People start to emerge from their heavily-locked
		homes. No one has ever enjoyed the rain so
		much as they are enjoying it now.

		[Mayor]
		I'm sorry, Barette. It's just that
		we've been so scared and desperate
		about it. We are grateful for you
		coming back.[EOA]

		[Chili_Annoyed]
		
		[MrsChilirosa]
		Had she not done those weird
		experiments, this would never have
		happened in the first place.[EOA]

		[Man]
		Come on, Chilirosa. It's all over. [EOA]
	*then	
		if plot12 {
            -> Luke Returns
        }
        if plot3 {
            -> Luke Watches From the Distance
        }
        -> Luke Is Nowhere To Be Found

@Luke Returns
	*say
		[MrsChilirosa]
		There's someone arriving from the
		East! [EOA]

		The soaked townspeople looked in to the East. A figure
		approaches the town on a camel. You squint your eyes as the
		visitor's shape reminds you of someone.
		It's Luke.
		The alchemist looks to the East as well. Then, he starts to
		walk towards Luke in big strides; Luke gets off the camel and
		walks in big strides as well. The two collided with each
		other into a big hug.
		They are too far for you to listen to what they're saying,
		but from the looks on their faces, you are sure that it's
		something worth celebrating.
		
		[Mayor]
		Well, my friend. Let's discuss
		about the reward I promised, shall we? [EOA]

		[Man]
		Wait, this is a perfect photo moment,
		isn't it? Everybody gather around.[EOA]

		As you try to find your spot in the crowd, the mayor grabs
		you upfront.

		[Mayor]
		No, my friend. You deserve to be at
		the very front.[EOA]

		You sit firmly on the ground. Everyone is happy. As if spring
		and life is coming back to the desert.

		[Man]
		3, 2, 1, say cheese! [EOA]

		<audio src='https://koetest.s3.amazonaws.com/Act5/takePhoto.mp3'/>

		<audio src='https://koetest.s3.amazonaws.com/bgm/musicEndLong.mp3'/>

	*then
		>>END

@Luke Watches From the Distance
	*say
		[Mayor]
		Well, Let's discuss
		about the reward I promised, shall we? [EOA]

		[Man]
		Wait, this is a perfect photo moment,
		isn't it? Everybody gather around.[EOA]

		As you try to find your spot in the crowd, the mayor grabs
		you upfront.

		[Mayor]
		No, my friend. You deserve to be at
		the very front.[EOA]
		
		[Alchemist]
		Oh. How I wish Luke was here.[EOA]

		You sit firmly on the ground. Everyone is happy. As if spring
		and life is coming back to the desert.
		You spot someone in the distance. You could almost tell who
		the person is by the outline, but soon the figure turns
		around and leaves the town.

		[Man]
		3, 2, 1, say cheese![EOA]

		<audio src='https://koetest.s3.amazonaws.com/Act5/takePhoto.mp3'/>

		<audio src='https://koetest.s3.amazonaws.com/bgm/musicEndLong.mp3'/>

	*then
		>>END

@Luke Is Nowhere To Be Found
	*say
		[Mayor]
		Well, my friend. Let's discuss
		about the reward I promised, shall we? [EOA]

		[Man]
		Wait, this is a perfect photo moment,
		isn't it? Everybody gather around. [EOA]

		As you try to find your spot in the crowd, the mayor grabs
		you upfront.

		[Mayor]
		No, my friend. You deserve to be at
		the very front. [EOA]

		[Man]
		3, 2, 1, say cheese![EOA]

		<audio src='https://koetest.s3.amazonaws.com/Act5/takePhoto.mp3'/>

		<audio src='https://koetest.s3.amazonaws.com/bgm/musicEndLong.mp3'/>
		
	*then
		>>END

// the start of Chilirosa steal puzzle -------------------------------------------------------------------------------------------

@chilirosa_steal_puzzle_start
	*show
		template: 'default'
        background:'https://koetest.s3.amazonaws.com/visuals/Chilirosa+puzzle/homeDefault.png'
        title: ''
        subtitle: ''
	*say
		You want to sneak into Misses Chilirosa's house to get the hot sauce, right?
	*then
		hear yes,sure {
		    set pot_count as 0
		    unflag turn_pot
		    unflag turn_kettle
		    unflag hide
			unflag ChilirosaInKitchen
			unflag caught
			-> chilirosa_door
		}
		hear no {
			-> Arrive Beauty Salon
		}

@chilirosa_steal_puzzle_again
	*show
		template: 'default'
        background:'https://koetest.s3.amazonaws.com/visuals/Chilirosa+puzzle/homeDefault.png'
        title: ''
        subtitle: ''
	*say
		You are now in front of Misses Chilirosa's house. Do you want to sneak in again?
	*then
		hear yes, sure {
		    set pot_count as 0
		    unflag turn_pot
		    unflag turn_kettle
			unflag ChilirosaInKitchen
		    unflag hide
			flag caught 
			-> chilirosa_hallway_around
		}

@chilirosa_door
	*say
		You hold your breath and open the door carefully. You then sneak into the hallway.
		To check the environment, try saying look around. [Action]
	*then
		hear look around, look around the hallway, around me, look around {
			-> chilirosa_hallway_around
		}

@chilirosa_hallway_around
	*say
		You are in the hallway. A vintage wood closet is next to you. Behind you is the door you just entered.
		You can also see the living room and the kitchen. You can check the objects or rooms, by saying look at the object or room name. [Action]
	*then
		-> chilirosa_hallway_interation

@chilirosa_hallway_interation
	*say
		
	*then
		hear view the door, look at the door {
			-> chilirosa_hallway_viewdoor
		}

		hear view the closet, look at the closet, check the closet {
			-> chilirosa_hallway_viewcloset
		}

		hear view the living room, look at the living room {
			if ChilirosaInKitchen{
				-> chilirosa_hallway_viewliving2
			}
			-> chilirosa_hallway_viewliving
		}

		hear view the kitchen, look at kitchen {
			if ChilirosaInKitchen{
				-> chilirosa_hallway_viewkitchen2	
			}
			-> chilirosa_hallway_viewkitchen
		}
		hear go to the kitchen, go to kitchen {
		    if turn_kettle{
		        -> chilirosa_kitchen_caught_kettle_back
		    }
		    if turn_pot and !hide{
		        -> chilirosa_kitchen_pot_back
		    }
		    if turn_pot and hide {
		        -> chilirosa_kitchen_caught_goto
		    }
			-> chilirosa_kitchen_goto
		}
		hear look around, look around me {
			-> chilirosa_hallway_around
		}
		hear leave, leave the door {
			-> chilirosa_steal_puzzle_start
		}
		hear hide in the closet {
		    if !turn_pot and !turn_kettle{
			    -> chilirosa_hallway_hidenormal
			}
			if turn_pot and turn_kettle{
			    unflag turn_pot
			    unflag turn_kettle
				flag ChilirosaInKitchen
		        set pot_count as 0
			    -> chilirosa_hallway_hidepotkettle
			}
			if turn_pot{
			    flag hide
			    -> chilirosa_hallway_hidepot
			}
			if turn_kettle{
			    unflag turn_kettle
			    -> chilirosa_hallway_hidekettle
			}
		}
		hear go to the living room, go to the living room {
		    if turn_pot and hide{
			    -> chilirosa_living_goto
			}
			else{
			    -> chilirosa_living_caught
		    }
		}
	*recap
		You can look at different objects, rooms, or look around.[Action]
	*reprompt
		You can look at different objects, rooms, or look around.[Action]

@chilirosa_kitchen_pot_back
	*say
		You go to the kitchen. [Chilirosa_footstepSneaky] The pot has been heated up. The soup will be boiled to dry soon, and the pot itself will be burnt. You need to leave the kitchen right now. Otherwise, you will be caught.
	*then
		hear go to the hallway, go to the hallway {
			-> chilirosa_hallway_pot_caught
		}
	*recap
		You should go to the hallway.[Action]
	*reprompt
		You should go to the hallway.[Action]

@chilirosa_hallway_pot_caught
	*say
		As soon as you arrive at the hallway. The soup is been boiled dry and the pot is burnt. Misses Chilirosa comes over to check on the stove but finds you instead. You are caught. 
	*then
		if skip {
            -> chilirosa_steal_puzzle_again
        }
        flag angry
		-> Chilirosa Angered

@chilirosa_kitchen_caught_kettle_back
	*say
		You go to the kitchen. [Chilirosa_footstepSneaky] The kettle starts to whistle. Misses Chilirosa hears it, and rushes into the kitchen but finds you instead.
	*then
		if skip {
            -> chilirosa_steal_puzzle_again
        }
        flag angry
		-> Chilirosa Angered

@chilirosa_hallway_hidekettle
	*say
		You hide in the closet.[Chilirosa_hide] Just you close the closet door, the kettle starts to whistle. Misses Chilirosa hears it and rushes into the kitchen. She turns the kettle off. She then goes back to the living room. You step out of the closet. 
		Maybe you want to find a way to keep her inside the kitchen longer.
	*then
		-> chilirosa_hallway_interation

@chilirosa_hallway_hidepotkettle
	*say
		You hide in the closet. [Chilirosa_hide] The moment you close the closet door, the kettle starts to whistle. Misses Chilirosa hears it and rushes into the kitchen. She turns the kettle off and finds that the pot is also on. The soup is not boiling dry yet. She turns the pot off, then goes back to the living room. 
		Hearing that, you step out of the closet. Maybe you want to find a way to keep her inside the kitchen longer.
	*then
		-> chilirosa_hallway_interation

@chilirosa_living_caught
	*show
		template: 'default'
        background:'https://koetest.s3.amazonaws.com/visuals/Chilirosa+puzzle/chilirosaEating.png'
        title: ''
        subtitle: ''
	*say
		You go to the living room. [Chilirosa_footstepSneaky] Misses Chilirosa is sitting right there. She is very surprised to see you but then becomes very angry. You are caught. She throws you out of the window.
		//Make sure you observe the room first, before you go in.
	*then
		if skip {
            -> chilirosa_steal_puzzle_again
        }
        flag angry
		-> Chilirosa Angered

@chilirosa_living_goto
	*say
		You go to the living room. [Chilirosa_footstepSneaky]
	*then
		-> chilirosa_living_around

@chilirosa_living_around
	*show
		template: 'default'
        background:'https://koetest.s3.amazonaws.com/visuals/Chilirosa+puzzle/emptyLivingRoom.png'
        title: ''
        subtitle: ''
	*say
		You are in the living room. The hot sauce, yes the super duper hot blue pepper sauce, is sitting right on the table.
	*then
		-> chilirosa_living_interaction

@chilirosa_living_interaction
	*recap
		The sauce is right in front of you. What would you like to do? [Action]
	*reprompt
		The sauce is right in front of you. What would you like to do? [Action]
	*then
		hear take, take the sauce, take sauce, take hot sauce, take the hot sauce, take it {
			-> chilirosa_living_takesauce
		}

@chilirosa_hallway_out
	*say
		You go to the hallway, with the hot sauce in your hand.[Chilirosa_footstepSneaky] Misses chilirosa is still cleaning up the pot in the kitchen. You quietly open the door and then close it. You are now in front of her house with the hot sauce in your hand.
	*then
		if skip {
			-> chilirosa_puzzle_end
		}
		-> Get the Hot Sauce

@chilirosa_puzzle_end
	*say	
		Congratulations! You successfully solved the hot sauce puzzle. Do you want to experience the story or play another puzzle? 
	*then
		hear story {
			unflag skip
			-> Lost in Desert
		}
		hear puzzle {
			flag skip
			-> jumptopuzzle
		}

@chilirosa_living_takesauce
	*show
		template: 'default'
        background:'https://koetest.s3.amazonaws.com/visuals/Chilirosa+puzzle/sauce.png'
        title: ''
        subtitle: ''
	*say
		[Achievement] You got the hot sauce. Now, Let's go to the hallway and leave the house!
	*then
		hear go to the hallway, go to the hallway, leave the house, sure, yes, do it {
			-> chilirosa_hallway_out
		}

@chilirosa_hallway_hidepot
	*say
		You hide in the closet.[Chilirosa_hide] After a while you hear that the soup is bubbling, and gradually dries up. The next thing you smell is the mixture of the stench and the smoke. The pot is burnt. Misses Chilirosa rushes in from the living room, across the hallway, in to the kitchen. Hearing that, you come out of the closet.
	*then
		-> chilirosa_hallway_interation

@chilirosa_hallway_hidenormal
	*say
		You hide in the closet.[Chilirosa_hide] Nothing happened. So you come out of the closet.
	*then
		-> chilirosa_hallway_interation

@chilirosa_kitchen_caught_goto
	*say
		You go the kitchen. Misses Chilirosa is in the kitchen. You are caught.
	*then
		if skip {
			-> chilirosa_steal_puzzle_again
		}
		flag angry
		-> Chilirosa Angered

@chilirosa_kitchen_goto
	*say
		You go to the kitchen. [Chilirosa_footstepSneaky]
	*then
		-> chilirosa_kitchen_around

@chilirosa_kitchen_interaction
	*say
		
	*then
		hear view water tap, look at the water tap, look water tap {
		    if pot_count is 1{
		        -> chilirosa_kitchen_caught_pot_stay
		    }
		    if turn_pot{
		        increase pot_count by 1
		    }
		    if turn_kettle{
		        -> chilirosa_kitchen_caught_kettle_stay
		    }
			-> chilirosa_kitchen_viewwatertap
		}

		hear view pot, look at the pot {
		    if pot_count is 1{
		        -> chilirosa_kitchen_caught_pot_stay
		    }
		    if turn_pot{
		        increase pot_count by 1
		        -> chilirosa_kitchen_viewpot_boil
		    }
		    if turn_kettle{
		        -> chilirosa_kitchen_caught_kettle_stay
		    }
			-> chilirosa_kitchen_viewpot
		}

		hear look around {
			-> chilirosa_kitchen_around
		}

		hear view kettle, look at the kettle {
		    if pot_count is 1{
		        -> chilirosa_kitchen_caught_pot_stay
		    }
		    if turn_pot{
		        increase pot_count by 1
		    }
		    if turn_kettle{
		        -> chilirosa_kitchen_caught_kettle_stay
		    }
			-> chilirosa_kitchen_viewkettle
		}
		hear go to the hallway, hallway {
			    -> chilirosa_hallway_goto
		}
		hear turn on water tap, turn on water{
		    if pot_count is 1{
		        -> chilirosa_kitchen_caught_pot_stay
		    }
		    if turn_pot{
		        increase pot_count by 1
		    }
		    if turn_kettle{
		        -> chilirosa_kitchen_caught_kettle_stay
		    }
			-> chilirosa_kitchen_caught_turnwater
		}
		hear turn on the pot, turn on pot {
		    if pot_count is 1{
		        -> chilirosa_kitchen_caught_pot_stay
		    }
		    if turn_pot{
		        increase pot_count by 1
		        -> chilirosa_kitchen_viewpot_boil
		    }
		    if turn_kettle{
		        -> chilirosa_kitchen_caught_kettle_stay
		    }
			-> chilirosa_kitchen_turnpot
		}
		hear turn on the kettle, turn on kettle {
		    if pot_count is 1{
		        -> chilirosa_kitchen_caught_pot_stay
		    }
		    if turn_pot{
		        increase pot_count by 1
		    }
	    	if turn_kettle{
		        -> chilirosa_kitchen_caught_kettle_stay
		    }
			-> chilirosa_kitchen_turnkettle
		}
		hear turn on the stove, turn on stove {
		    if pot_count is 1{
		        -> chilirosa_kitchen_caught_pot_stay
		    }
		    if turn_pot{
		        increase pot_count by 1
		    }
	    	if turn_kettle{
		        -> chilirosa_kitchen_caught_kettle_stay
		    }
			-> chilirosa_kitchen_turnstove
		}
	*recap
		You can look at different objects, look around, or go to the hallway.
	*reprompt
		You can look at different objects, look around, or go to the hallway.

@chilirosa_kitchen_viewpot_boil
	*say
		You look at the pot. It's cooking on the stove. The soup will be boiled dry soon and the pot will be burnt.
	*then
		>> BACK

@chilirosa_kitchen_caught_pot_stay
	*say
		The soup has been dry and the pot is burnt. Misses Chilirosa comes over to check on the stove but finds you instead. You are caught. 
	*then
		if skip {
			-> chilirosa_steal_puzzle_again
		}
		flag angry
		-> Chilirosa Angered

@chilirosa_kitchen_caught_kettle_stay
	*say
		Suddenly, the kettle whistles. <audio src='https://koetest.s3.amazonaws.com/Chilirosa/waterBoilingWomenFootsteps.mp3'/> Misses Chilirosa hears it, and arrives at the kitchen to find you, a stranger, wandering. 
	*then
		if skip {
    		-> chilirosa_steal_puzzle_again
		}
		flag angry
		-> Chilirosa Angered

@chilirosa_kitchen_turnstove
	*say
		Which stove? The kettle or the pot?
	*then
		hear kettle {
			-> chilirosa_kitchen_turnkettle
		}
		hear pot {
			-> chilirosa_kitchen_turnpot
		}

@chilirosa_kitchen_turnkettle
	*say
		You turn on the kettle.[Chilirosa_startfire] The water starts to boil. 
	*then
		flag turn_kettle
	    -> chilirosa_kitchen_interaction

@chilirosa_hallway_goto
	*say
		You go to the hallway [Chilirosa_footstepSneaky]
	*then
		-> chilirosa_hallway_interation

@chilirosa_kitchen_turnpot
	*say
		You turn on the pot.[Chilirosa_startfire] The pot starts to heat up.
	*then
		flag turn_pot
		set pot_count to 0
	    -> chilirosa_kitchen_interaction

@chilirosa_kitchen_caught_turnwater
	*say
		You turn on the water tap. Water starts to flow. Misses Chilirosa rushes in to the kitchen to check out what's going on. Now she knows what's going on. There's a thief, and that means you. You are thrown out of her house.
	*then
		-> chilirosa_steal_puzzle_again

@chilirosa_kitchen_viewkettle
	*say
		You look at the kettle on the right. It is full of water. And it's quite hot. If you turn on the kettle, the kettle will whistle almost immediately. You can turn on the kettle.[Action]
	*then
		-> chilirosa_kitchen_interaction

@chilirosa_kitchen_around
	*say
		You are in the kitchen. From the kitchen, you can only see the hallway you came from. Inside the kitchen, there is a pair of stoves. On the left is a pot, and on the right is a kettle. Beside the stoves is a water tap.  But, you didn't find the hot sauce in the kitchen. [Action]
	*then
		-> chilirosa_kitchen_interaction

@chilirosa_kitchen_viewpot
	*say
		You look at the pot on the left. Open up the cover carefully, you see a little bit of soup left in it. The pot is cold. If you turn on the pot, the soup will boil and dry, and the pot will be burnt. You can turn on the pot.[Action]
	*then
		-> chilirosa_kitchen_interaction

@chilirosa_kitchen_viewwatertap
	*say
		You look at the water tap. You are sure that if you open it, it will make some noise.  You have the option to turn on the water.[Action]
	*then
		-> chilirosa_kitchen_interaction

@chilirosa_hallway_viewkitchen
	*say
		You look at the kitchen. No one is in the kitchen. Some containers are on the stove. You can go to the kitchen if you want.[Action]
	*then
		-> chilirosa_hallway_interation

@chilirosa_hallway_viewkitchen2
	*say
		You look at the kitchen. Mrs. Chilirosa is still cleaning in the kitchen. It's a great chance for you to go to the living room and get the hot sauce! [Action]
	*then
		-> chilirosa_hallway_interation

@chilirosa_hallway_viewliving
	*show
		template: 'default'
        background:'https://koetest.s3.amazonaws.com/visuals/Chilirosa+puzzle/chilirosaEating.png'
        title: ''
        subtitle: ''
	*say
		You look at the living room. Misses Chilirosa is sitting next to the table and having her lunch. She is sprinkling sauce on her pasta. That's it! That's the hot sauce you want.  You can go to the living room at anytime, but she is in it right now, you should do something to distract her away first.[Action]
	*then
		-> chilirosa_hallway_interation

@chilirosa_hallway_viewliving2
	*show
		template: 'default'
        background:'https://koetest.s3.amazonaws.com/visuals/Chilirosa+puzzle/emptyLivingRoom.png'
        title: ''
        subtitle: ''
	*say
		You look at the living room. That's it! That's the hot sauce you want.  You can go to the living room right now since she is still cleaning in the kitchen.[Action]
	*then
		-> chilirosa_hallway_interation

@chilirosa_hallway_viewcloset
	*say
		You look at the closet. It's a large closet. You opened up the closet. A lot of coats and dresses are hanging inside. Suprisely it's large enough for you to hide in. If you want to hide in the closet, you can say hide in the closet. [Action]
	*then
		-> chilirosa_hallway_interation

@chilirosa_hallway_viewdoor
	*say
		You look at the door. That's the door you sneaked in from. If you want to give up on stealing the hot sauce, you can come to the hallway and say leave the door.[Action]
	*then
		-> chilirosa_hallway_interation
	



//Leading flower puzzle-----------------------------------------------------------------------------------

@leading_beforestart
	*say
		
	*then
		-> leading_start

@leading_puzzle_help
	*say
		If you are far away from the right direction. The flower will sing this song. [DirSound_Small]
		If you are close to the right direction, the flower will sing. [DirSound_MRight]
		If you are in the right direction, the flower will sing. [DirSound_Large]
	*then
		>> BACK

@leading_start
	*say
		The flower suddenly stands up straight.
        
        [SeedTrader]
        Good. Then, grab some dust from the ground and sprinkle it on the flower.  [EOA] [Action]
	*recap
		Try to use the dust on the flower. [Action]
	*reprompt
		Try to use the dust on the flower. [Action]
	*then
		hear use the dust on the flower, flower, sprinkle, grab, dust {
			-> leading_tutorial_start
		}

@leading_tutorial_start
	*say
		You use the dust on the leading flower. 
        The flower gently shakes for a second. 
        
        [SeedTrader]
        Great. That means the flower has locked on to the scent of a garden, and knows how to get to it now. Hold the flower and look at four directions: East, South, West, and North.[EOA] 
		Try to say, look south [Action]
	*then
		hear look south, look at south {
			-> leading_tutorial_south
		}
	*recap
		Try to say, look south. [Action]
	*reprompt
		Try to say, look south. [Action]

@leading_tutorial_south
	*say
		You are looking at the south. [SeedTrader]
Listen, the leading flower is singing you the way .[EOA][DirSound_Small][SeedTrader]This song means that the direction you are looking is far away from the right direction.  [EOA]
 Now, Try to say look west. [Action]
	*then
		hear look west {
			-> leading_tutorial_west
		}
	*recap
		Now, Try to say look west.[Action]
	*reprompt
		Now, Try to say look west.[Action]

@leading_tutorial_west
	*say
		You are looking at the west.
		[DirSound_MRight]
		[SeedTrader] This song means you are close to the right direction. [EOA]
	*recap
		You can say look east or look north. [Action]
	*reprompt
		You can say look east or look north.
	*then
		hear look north {
			-> leading_tutorial_north
		}

		hear look east {
			-> leading_tutorial_east
		}

@leading_tutorial_east
	*say
		You are looking east. You are facing a wall.
	*recap
		You can say look north.
	*reprompt
		You can say look north.
	*then
		hear look north {
			-> leading_tutorial_north
		}

@leading_tutorial_north
	*say
		You are looking north.
		[DirSound_Large]
		[SeedTrader]
		This song means you are right looking at the way out! Go toward that direction and you are free! [EOA]

		Try to say, go north.[Action]
	*then
		hear go north {
			-> leading_tutorial_end
		}
	*recap
		Try to say, go north.[Action]
	*reprompt
		Try to say, go north.[Action]

@leading_tutorial_end
	*say
		[SeedTrader] Hey, congrats! Now you are in my garden, do you understand how to use the leading flower?[EOA][Action]
	*then
		hear yes {
			-> leading_tutorial_end_1
		}

		hear no {
			-> leading_tutorial_again
		}

@leading_tutorial_again
	*say
		[SeedTrader]Ok... No worry, I can put you back to the maze, and show you again. Do you wanna learn again?[EOA][Action]
	*then
		hear yes {
			-> leading_tutorial_start
		}
		hear no {
			-> leading_tutorial_end_1
		}

@leading_tutorial_end_1
	*say
		[SeedTrader] Ok, cool. It's simple to use, right? Here, take this bottle of dust. I grab it from the oasis you are looking for. And. You are ready to go! With the leading flower, you should be able to walk across the foggy forest! [EOA]
	*then
		if skip {
	        -> leading_puzzle_start
	    }
		if plot12 {
			-> One Last Thing
		}
		if plot3 {
			-> One More Thing Plot 3
		}
		-> One Last Thing Plot 4

@leading_puzzle_start
	*say
		You thank him and continut your journey. [Footsteps]A A couple of minutes later, you are standing in front of the foggy forest. You take out the leading flower. [Action]
	*recap
		Try to use the dust on the flower
	*reprompt
		You should use the dust on the leading flower before you go into the forest. 
	*then
		hear use the dust on the flower, use , use dust {
			-> leading_puzzle_start_from_a
		}
		hear use the dust on the flower, use, use dust, use the dust on the leading flower {
			-> leading_puzzle_start_from_a
		}

@leading_puzzle_start_from_a
	*say
		You use the dust on the flower. The flower is reacting to it. Now you can look at different directions.
	*recap
		You can look east, look south, look west and look north. [Action]
	*reprompt
		You can look east, look south, look west and look north. [Action]
	*then
		//Node _a_
		-> leading_a_position

@leading_a_goto
	

@leading_a_position
	*then
		hear look north, look at north {
			-> leading_a_north
		}

		hear look east, look at east {
			-> leading_a_east
		}

		hear look south, look at south, go south, go to south {
			-> leading_a_south
		}

		hear look west, look at west, go west, go to west {
			-> leading_a_west
		}
		
		hear go north, go to north {
			-> leading_e_goto
		}
		
		hear go east, go to east {
			-> leading_b_goto
		}
	*recap
		You can look east, look south, look west and look north. [Action]
	*reprompt
		You can look east, look south, look west and look north. [Action]

@leading_a_north
	*say
		You are looking north.[DirSound_MRight] [Action]
	*then
		-> leading_a_position

@leading_a_east
	*say
		You are looking east.[DirSound_MLeft] [Action]
	*then
		-> leading_a_position

@leading_a_south
	*say
		You are looking south.[DirSound_Small] That's the entrance you came in before. [Action]
	*then
		-> leading_a_position

@leading_a_west
	*say
		You are looking west.[DirSound_Small] You see the outer edge of the forest. That is not the right way. [Action]
	*then
		-> leading_a_position
        
//Node _b_

@leading_b_goto
	*say
		[Footsteps] A A couple of minutes later. You come to a new spot. [Action]
	*then
		-> leading_b_position

@leading_b_position
	*then
		hear look north, look at north, go north, go to north {
			-> leading_b_north
		}

		hear look east, look at east {
			-> leading_b_east
		}

		hear look south, look at south, go to south, go south {
			-> leading_b_south
		}

		hear look west, look at west {
			-> leading_b_west
		}
		
		hear go east, go to east {
			-> leading_c_goto
		}
		
		hear go west, go to west {
			-> leading_a_goto
		}
	*recap
		You can look east, look south, look west and look north. [Action]
	*reprompt
		You can look east, look south, look west and look north. [Action]

@leading_b_north
	*say
		You are looking north. [DirSound_MRight] A dead forest blocks the way. [Action]
	*then
		-> leading_b_position

@leading_b_east
	*say
		You are looking east. [DirSound_MLeft] [Action]
	*then
		-> leading_b_position

@leading_b_south
	*say
		You are looking south. [DirSound_Small] You see the outer edge of the forest. This is not the right way. [Action]
	*then
		-> leading_b_position

@leading_b_west
	*say
		You are looking west. [DirSound_Small] [Action]
	*then
		-> leading_b_position

//Node _c_

@leading_c_goto
	*say
		[Footsteps] A A couple of minutes later. You come to a new spot. [Action]
	*then
		-> leading_c_position

@leading_c_position
	*then
		hear look north, look at north {
			-> leading_c_north
		}

		hear look east, look at east {
			-> leading_c_east
		}

		hear look south, look at south, go south, go to south {
			-> leading_c_south
		}

		hear look west, look at west {
			-> leading_c_west
		}
		
		hear go north, go to north {
			-> leading_g_goto
		}
		
		hear go east, go to east {
			-> leading_g_goto
		}
		
		hear go west, go to west {
			-> leading_c_goto
		}
	*recap
		You can look east, look south, look west and look north. [Action]
	*reprompt
		You can look east, look south, look west and look north. [Action]

@leading_c_north
	*say
		You are looking north.[DirSound_Large] [Action]
	*then
		-> leading_c_position

@leading_c_east
	*say
		You are looking east.[DirSound_MLeft] [Action]
	*then
		-> leading_c_position

@leading_c_south
	*say
		You are looking south.[DirSound_Small] You see the outer edge of the forest. This is not the right way. [Action]
	*then
		-> leading_c_position

@leading_c_west
	*say
		You are looking west. [DirSound_MRight] [Action]
	*then
		-> leading_c_position

//Node _d_

@leading_d_goto
	*say
		[Footsteps] A A couple of minutes later. You come to a new spot. [Action]
	*then
		-> leading_d_position

@leading_d_position
	*then
		hear look north, look at north {
			-> leading_d_north
		}

		hear look east, look at east, go east, go to east {
			-> leading_d_east
		}

		hear look south, look at south, go south, go to south {
			-> leading_d_south
		}

		hear look west, look at west {
			-> leading_d_west
		}
		
		hear go north, go to north {
			-> leading_h_goto
		}
		
		hear go west, go to west {
			-> leading_c_goto
		}
	*recap
		You can look east, look south, look west and look north. [Action]
	*reprompt
		You can look east, look south, look west and look north. [Action]

@leading_d_north
	*say
		You are looking north. [DirSound_MLeft] [Action]
	*then
		-> leading_d_position

@leading_d_east
	*say
		You are looking east. [DirSound_Small] You see the outer edge of the forest. This is not the right way. [Action]
	*then
		-> leading_d_position

@leading_d_south
	*say
		You are looking south. [DirSound_Small] You see the outer edge of the forest. This is not the right way. [Action]
	*then
		-> leading_d_position

@leading_d_west
	*say
		You are looking west. [DirSound_MRight] [Action]
	*then
		-> leading_d_position

//Node _e_

@leading_e_goto
	*say
		[Footsteps] A A couple of minutes later. You come to a new spot. [Action]
	*then
		-> leading_e_position

@leading_e_position
	*then
		hear look north, look at north {
			-> leading_e_north
		}

		hear look east, look at east {
			-> leading_e_east
		}

		hear look south, look at south {
			-> leading_e_south
		}

		hear look west, look at west, go west, go to west {
			-> leading_e_west
		}
		
		hear go north, go to north {
			-> leading_i_goto
		}
		
		hear go east, go to east {
			-> leading_f_goto
		}
		
		hear go south, go to south {
			-> leading_a_goto
		}
	*recap
		You can look east, look south, look west and look north. [Action]
	*reprompt
		You can look east, look south, look west and look north. [Action]

@leading_e_north
	*say
		You are looking north. [DirSound_MRight] [Action]
	*then
		-> leading_e_position

@leading_e_east
	*say
		You are looking east. [DirSound_MLeft] [Action]
	*then
		-> leading_e_position

@leading_e_south
	*say
		You are looking south. [DirSound_Small] [Action]
	*then
		-> leading_e_position

@leading_e_west
	*say
		You are looking west. [DirSound_Small] You see the outer edge of the forest. This is not the right way. [Action]
	*then
		-> leading_e_position


//Node _f_

@leading_f_goto
	*say
		[Footsteps] A A couple of minutes later. You come to a new spot. [Action]
	*then
		-> leading_f_position

@leading_f_position
	*then
		hear look north, look at north {
			-> leading_f_north
		}

		hear look east, look at east {
			-> leading_f_east
		}

		hear look south, look at south, go south, go to south {
			-> leading_f_south
		}

		hear look west, look at west {
			-> leading_f_west
		}
		
		hear go north, go to north {
			-> leading_j_goto
		}
		
		hear go east, go to east {
			-> leading_g_goto
		}
		
		hear go west, go to west {
			-> leading_e_goto
		}
	*recap
		You can look east, look south, look west and look north. [Action]
	*reprompt
		You can look east, look south, look west and look north. [Action]

@leading_f_north
	*say
		You are looking north. [DirSound_MRight] [Action]
	*then
		-> leading_f_position

@leading_f_east
	*say
		You are looking east. [DirSound_MLeft] [Action]
	*then
		-> leading_f_position

@leading_f_south
	*say
		You are looking south. [DirSound_Small] A dead forest blocks the way. [Action]
	*then
		-> leading_f_position

@leading_f_west
	*say
		You are looking west. [DirSound_Small] [Action]
	*then
		-> leading_f_position

//Node _g_

@leading_g_goto
	*say
		[Footsteps] A A couple of minutes later. You come to a new spot. [Action]
	*then
		-> leading_g_position

@leading_g_position
	*then
		hear look north, look at north {
			-> leading_g_north
		}

		hear look east, look at east {
			-> leading_g_east
		}

		hear look south, look at south {
			-> leading_g_south
		}

		hear look west, look at west {
			-> leading_g_west
		}
		
		hear go north, go to north {
			-> leading_g_north
		}
		
		hear go east, go to east {
			-> leading_h_goto
		}
		
		hear go south, go to south {
			-> leading_c_goto
		}
		
		hear go west, go to west {
			-> leading_f_goto
		}
	*recap
		You can look east, look south, look west and look north. [Action]
	*reprompt
		You can look east, look south, look west and look north. [Action]

@leading_g_north
	*say
		You are looking north. [DirSound_Large] A pond of water blocks the way. Look across the pond, you can almost see something different. [Action]
	*then
		-> leading_g_position

@leading_g_east
	*say
		You are looking east. [DirSound_MLeft] [Action]
	*then
		-> leading_g_position

@leading_g_south
	*say
		You are looking south. [DirSound_Small] [Action]
	*then
		-> leading_g_position

@leading_g_west
	*say
		You are looking west. [DirSound_MRight] [Action]
	*then
		-> leading_g_position

//Node _h_

@leading_h_goto
	*say
		[Footsteps] A A couple of minutes later. You come to a new spot. [Action]
	*then
		-> leading_h_position

@leading_h_position
	*then
		hear look north, look at north {
			-> leading_h_north
		}

		hear look east, look at east {
			-> leading_h_east
		}

		hear look south, look at south {
			-> leading_h_south
		}

		hear look west, look at west {
			-> leading_h_west
		}
		
		hear go north, go to north {
			-> leading_l_goto
		}
		
		hear go east, go to east {
			-> leading_e_east
		}
		
		hear go south, go to south {
			-> leading_d_goto
		}
		
		hear go west, go to west {
			-> leading_g_goto
		}
	*recap
		You can look east, look south, look west and look north. [Action]
	*reprompt
		You can look east, look south, look west and look north. [Action]

@leading_h_north
	*say
		You are looking north. [DirSound_MLeft] [Action]
	*then
		-> leading_h_position

@leading_h_east
	*say
		You are looking east. [DirSound_Small] You see the outer edge of the forest. This is not the right way. [Action]
	*then
		-> leading_h_position

@leading_h_south
	*say
		You are looking south. [DirSound_Small] [Action]
	*then
		-> leading_h_position

@leading_h_west
	*say
		You are looking west. [DirSound_MRight] [Action]
	*then
		-> leading_h_position

//Node _i_

@leading_i_goto
	*say
		[Footsteps] A A couple of minutes later. You come to a new spot. [Action]
	*then
		-> leading_i_position

@leading_i_position
	*then
		hear look north, look at north {
			-> leading_i_north
		}

		hear look east, look at east {
			-> leading_i_east
		}

		hear look south, look at south {
			-> leading_i_south
		}

		hear look west, look at west {
			-> leading_i_west
		}
		
		hear go north, go to north {
			-> leading_m_goto
		}
		
		hear go east, go to east {
			-> leading_j_goto
		}
		
		hear go south, go to south {
			-> leading_e_goto
		}
		
		hear go west, go to west {
			-> leading_i_west
		}
	*recap
		You can look east, look south, look west and look north. [Action]
	*reprompt
		You can look east, look south, look west and look north. [Action]

@leading_i_north
	*say
		You are looking north. [DirSound_MRight] [Action]
	*then
		-> leading_i_position

@leading_i_east
	*say
		You are looking east. [DirSound_Large] [Action]
	*then
		-> leading_i_position

@leading_i_south
	*say
		You are looking south. [DirSound_MLeft] [Action]
	*then
		-> leading_i_position

@leading_i_west
	*say
		You are looking west. [DirSound_Small] You see the outer edge of the forest. This is not the right way. [Action]
	*then
		-> leading_i_position

//Node _j_

@leading_j_goto
	*say
		[Footsteps] A A couple of minutes later. You come to a new spot. [Action]
	*then
		-> leading_j_position

@leading_j_position
	*then
		hear look north, look at north {
			-> leading_j_north
		}

		hear look east, look at east {
			-> leading_j_east
		}

		hear look south, look at south {
			-> leading_j_south
		}

		hear look west, look at west {
			-> leading_j_west
		}
		
		hear go north, go to north {
			-> leading_j_north
		}
		
		hear go east, go to east {
			-> leading_j_east
		}
		
		hear go south, go to south {
			-> leading_f_goto
		}
		
		hear go west, go to west {
			-> leading_i_goto
		}
	*recap
		You can look east, look south, look west and look north. [Action]
	*reprompt
		You can look east, look south, look west and look north. [Action]

@leading_j_north
	*say
		You are looking north. [DirSound_MRight] A large field of marsh blocks the way. [Action]
	*then
		-> leading_j_position

@leading_j_east
	*say
		You are looking east. [DirSound_Large] A long hill blocks the way. [Action]
	*then
		-> leading_j_position

@leading_j_south
	*say
		You are looking south. [DirSound_MLeft] [Action]
	*then
		-> leading_j_position

@leading_j_west
	*say
		You are looking west. [DirSound_Small] [Action]
	*then
		-> leading_j_position

//Node _l_

@leading_l_goto
	*say
		[Footsteps] A A couple of minutes later. You come to a new spot. [Action]
	*then
		-> leading_l_position

@leading_l_position
	*then
		hear look north, look at north {
			-> leading_l_north
		}

		hear look east, look at east {
			-> leading_l_east
		}

		hear look south, look at south {
			-> leading_l_south
		}

		hear look west, look at west {
			-> leading_l_west
		}
		
		hear go north, go to north {
			-> leading_p_goto
		}
		
		hear go east, go to east {
			-> leading_l_east
		}
		
		hear go south, go to south {
			-> leading_h_goto
		}
		
		hear go west, go to west {
			-> leading_find_oasis
		}
	*recap
		You can look east, look south, look west and look north. [Action]
	*reprompt
		You can look east, look south, look west and look north. [Action]

@leading_l_north
	*say
		You are looking north. [DirSound_MLeft] [Action]
	*then
		-> leading_l_position

@leading_l_east
	*say
		You are looking east. [DirSound_Small] You see the outer edge of the forest. This is not the right way. [Action]
	*then
		-> leading_l_position

@leading_l_south
	*say
		You are looking south. [DirSound_MRight] [Action]
	*then
		-> leading_l_position

@leading_l_west
	*say
		You are looking west. [DirSound_Large] [Action]
	*then
		-> leading_l_position

//Node _m_

@leading_m_goto
	*say
		[Footsteps] A couple of minutes later. You come to a new spot. [Action]
	*then
		-> leading_m_position

@leading_m_position
	*then
		hear look north, look at north {
			-> leading_m_north
		}

		hear look east, look at east {
			-> leading_m_east
		}

		hear look south, look at south {
			-> leading_m_south
		}

		hear look west, look at west {
			-> leading_m_west
		}
		
		hear go north, go to north {
			-> leading_m_north
		}
		
		hear go east, go to east {
			-> leading_n_goto
		}
		
		hear go south, go to south {
			-> leading_i_goto
		}
		
		hear go west, go to west {
			-> leading_m_west
		}
	*recap
		You can look east, look south, look west and look north. [Action]
	*reprompt
		You can look east, look south, look west and look north. [Action]

@leading_m_north
	*say
		You are looking north. [DirSound_Small] You see the outer edge of the forest. This is not the right way. [Action]
	*then
		-> leading_m_position

@leading_m_east
	*say
		You are looking east. [DirSound_MRight] [Action]
	*then
		-> leading_m_position

@leading_m_south
	*say
		You are looking south. [DirSound_MLeft] [Action]
	*then
		-> leading_m_position

@leading_m_west
	*say
		You are looking west. [DirSound_Small] You see the outer edge of the forest. This is not the right way. [Action]
	*then
		-> leading_m_position

//Node _n_

@leading_n_goto
	*say
		[Footsteps] A couple of minutes later. You come to a new spot. [Action]
	*then
		-> leading_n_position

@leading_n_position
	*then
		hear look north, look at north {
			-> leading_n_north
		}

		hear look east, look at east {
			-> leading_n_east
		}

		hear look south, look at south {
			-> leading_n_south
		}

		hear look west, look at west {
			-> leading_n_west
		}
		
		hear go north, go to north {
			-> leading_n_north
		}
		
		hear go east, go to east {
			-> leading_o_goto
		}
		
		hear go south, go to south {
			-> leading_n_south
		}
		
		hear go west, go to west {
			-> leading_m_goto
		}
	*recap
		You can look east, look south, look west and look north. [Action]
	*reprompt
		You can look east, look south, look west and look north. [Action]

@leading_n_north
	*say
		You are looking north. [DirSound_Small] You see the outer edge of the forest. This is not the right way. [Action]
	*then
		-> leading_n_position

@leading_n_east
	*say
		You are looking east. [DirSound_MRight] [Action]
	*then
		-> leading_n_position

@leading_n_south
	*say
		You are looking south. [DirSound_MLeft] A large field of marsh blocks the way. [Action]
	*then
		-> leading_n_position

@leading_n_west
	*say
		You are looking west. [DirSound_Small] [Action]
	*then
		-> leading_n_position

//Node _o_

@leading_o_goto
	*say
		[Footsteps] A couple of minutes later. You come to a new spot.
	*then
		-> leading_o_position

@leading_o_position
	*then
		hear look north, look at north {
			-> leading_o_north
		}

		hear look east, look at east {
			-> leading_o_east
		}

		hear look south, look at south {
			-> leading_o_south
		}

		hear look west, look at west {
			-> leading_o_west
		}
		
		hear go north, go to north {
			-> leading_o_north
		}
		
		hear go east, go to east {
			-> leading_p_goto
		}
		
		hear go south, go to south {
			-> leading_find_oasis
		}
		
		hear go west, go to west {
			-> leading_n_goto
		}
	*recap
		You can look east, look south, look west and look north. [Action]
	*reprompt
		You can look east, look south, look west and look north. [Action]

@leading_o_north
	*say
		You are looking north. [DirSound_Small] You see the outer edge of the forest. That's definitely not the right way.[Action]
	*then
		-> leading_o_position

@leading_o_east
	*say
		You are looking east. [DirSound_MRight] [Action]
	*then
		-> leading_o_position

@leading_o_south
	*say
		You are looking south. [DirSound_Large] [Action]
	*then
		-> leading_o_position

@leading_o_west
	*say
		You are looking west. [DirSound_MLeft] [Action]
	*then
		-> leading_o_position

//Node _p_

@leading_p_goto
	*say
		[Footsteps] A couple of minutes later. You come to a new spot.
	*then
		-> leading_p_position

@leading_p_position
	*then
		hear look north, look at north {
			-> leading_p_north
		}

		hear look east, look at east {
			-> leading_p_east
		}

		hear look south, look at south {
			-> leading_p_south
		}

		hear look west, look at west {
			-> leading_p_west
		}
		
		hear go north, go to north {
			-> leading_p_north
		}
		
		hear go east, go to east {
			-> leading_p_east
		}
		
		hear go south, go to south {
			-> leading_l_goto
		}
		
		hear go west, go to west {
			-> leading_o_goto
		}
	*recap
		You can look east, look south, look west and look north. [Action]
	*reprompt
		You can look east, look south, look west and look north. [Action]

@leading_p_north
	*say
		You are looking north. [DirSound_Small] You see the outer edge of the forest. That's definitely not the right way.
	*then
		-> leading_p_position

@leading_p_east
	*say
		You are looking east. [DirSound_Small] You see the outer edge of the forest. That's definitely not the right way.
	*then
		-> leading_p_position

@leading_p_south
	*say
		You are looking south. [DirSound_MRight]
	*then
		-> leading_p_position

@leading_p_west
	*say
		You are looking west. [DirSound_MLeft]
	*then
		-> leading_p_position

@leading_find_oasis
	*say
		Your sight becomes clear. You see the cave. [Achievement]
	*then
		if skip {
			-> leading_puzzle_ends
		}
		-> Arrival At The Inner Cave

@leading_puzzle_ends
	*say	
		That's the end of this leading flower puzzle. Do you want to experience the whole story now, or choose another puzzle to play?
	*then
		hear story {
			unflag skip
			-> Lost in Desert
		}
		hear puzzle {
			flag skip
			-> jumptopuzzle
		}

// cow plantpuzzle---------------------------------------------------------------------------------------------

@cowplant_puzzle_start
	*say
		You wake up after a long sleep but find youself in a tent. Maybe you want to look around first. [Action]
	*recap
		You should look around first.
	*reprompt
		You should look around.
	*then
		hear look around {
		    unflag wakeman
		    unflag getmilk
		    unflag getnotebook_c
		    unflag view_manoutside
			unflag view_mantent
			unflag view_stereo
			unflag view_plant
			-> cowplant_puzzle_tent_around_tutorial
		}

@cowplant_puzzle_tent_around_tutorial
	*say
		Books and scratch paper scatter everywhere on the ground in this large and messy tent.
		You see a cabinet full of plants and seeds in glass jars. 
		A carefully bonded leather notebook catches your attention. It reads cow plant Observation Notes. 
		[Conversation] This notes might be helpful, let's pick up the note first. [Action]
	*then
		hear pick up the notebook, pick up, pick {
			flag getnotebook_c
			set currentplace to 0
			-> cowplant_puzzle_tent_pickup_notebook
		}
	*recap
		You should pick up the notebook first.
	*reprompt 
		You should pick up the notebook.

@cowplant_puzzle_tent_pickup_notebook
	*say
		You pick up the notebook. It has many bookmarks on different pages. You decide to carry the notebook with you so you can look things up easier.
		You can look at the note book to see more details. [Action]
	*recap
		You should look at the notebook first.
	*reprompt
		You should look at the notebook. 
	*then
		hear look at the notebook, look at {
			-> cowplant_puzzle_after_pick_up
		}

@cowplant_puzzle_after_pick_up
	*say
		While you are wondering what is cowplant, you hear a strange sound from the outside.
		<audio src='https://koetest.s3.amazonaws.com/Act3/manscream_01.mp3'/> 
		Then you hear another sound. <audio src='https://koetest.s3.amazonaws.com/Act3/cowplantThrowOut.mp3'/> Maybe you should go outside.[Action]
	*recap
		You should go outside.
	*reprompt
		You hear another sound. <audio src='https://koetest.s3.amazonaws.com/Act3/cowplantThrowOut.mp3'/> Maybe you should go outside.[Action]
	*then
		hear go outside, look outside, go out, look at outside {
			-> cowplant_puzzle_outside_around_tutorial
		}

	*reprompt
		You should go outside.

@cowplant_puzzle_outside_around_tutorial
	*say
		You walked outside. As soon as you step out of the tent, you realize that you are still in the desert.
		In front of you, there is a giant plant is as large as the refrigerator. What's more strange is that, it has a mouth. Yes, a mouth. 
		Besides the plant a man is lying on the ground, fainted. 
		[Conversation] Hmm, before we move closer, maybe we should take a look at the notebook first and see if we can find any clues. [Action]
	*then
		hear look at the notebook, note, notebook {
			-> cowplant_puzzle_grab_notebook
		}

@cowplant_puzzle_grab_notebook
	*say
		You look at the notebook and flip to the introduction.
		It reads. Cow plant is a bizarre, partly bovine form of vegetation. It usually has 4 growth states. 
		You can search for words that you read from the notebook. Keep in mind, you want to find the clue to cure the poor man who saved you from the sandstorm.
		[Conversation] Try to saying search growth states. [Action]
	*recap
		Try to search, growth states.
	*reprompt
		Try to search, growth states.
	*then
		hear search growth states, growth states {
			-> cowplant_puzzle_notebook_seedtrader_states_tutorial
		}

@cowplant_puzzle_outside_interaction
	*say
		
	*recap
		Sorry you can not do that. Try to say what can I do. [Action]
	*reprompt
		You can look around, look at specific things. or go to the tent. [Action]
	*then
		hear look around, look around me, what is around me {
		    if wakeman {
		        -> cowplant_puzzle_outside_around_noman
		    }
			-> cowplant_puzzle_outside_around_man
		}
		hear look at the man, look at man {
		    if wakeman{
		        -> cowplant_puzzle_outside_view_man_gone
		    }
			-> cowplant_puzzle_outside_view_man
		}

		hear wake up the man, wake up man, wake him up {
		    flag wakeman
			-> cowplant_puzzle_outside_wake_man
		}

		hear look at the plant, look at plant {
		    flag view_plant
			-> cowplant_puzzle_outside_view_plant
		}

		hear go to the plant, go to plant, interact with the plant {
			-> cowplant_puzzle_cowplant_interact
		}

		hear look at the basket, look at the swordfish {
			-> cowplant_puzzle_outside_view_basket
		}

		hear look at the stereo {
			-> cowplant_puzzle_outside_view_stereo
		}

		hear turn on the stereo {
			-> cowplant_puzzle_outside_stereo_on
		}

		hear go to the tent {
		    if getmilk and wakeman{
		        -> cowplant_puzzle_tent_getmilk
		    }
			-> cowplant_puzzle_tent_goto
		}
		hear  look at the notebook, open the notebook, read the notebook, look at notebook {
		    set currentplace to 1
			if !getnotebook_c{
		        -> cowplant_puzzle_tent_nonote
		    }
			-> cowplant_puzzle_notebook_open
		}

		hear look at the tent, look at tent {
			-> cowplant_puzzle_outside_view_tent
		}

		hear what can I do, what {
			-> cowplant_puzzle_outside_whatdo
		}

//What to do outside ---------------------------------------------------------------

@cowplant_puzzle_outside_whatdo
	*say
		You can look around, look at specific things, go to the tent. 
	*then 
		-> cowplant_puzzle_outside_whatdo_turnon_stereo

@cowplant_puzzle_outside_whatdo_turnon_stereo
	*then
		if view_stereo {
			-> cowplant_puzzle_outside_whatdo_turnon_stereo_Y
		}
		-> cowplant_puzzle_outside_whatdo_turnon_stereo_N

@cowplant_puzzle_outside_whatdo_turnon_stereo_Y
	*say
		 Turn on the stereo, 
	*then 
		-> cowplant_puzzle_outside_whatdo_wake_man

@cowplant_puzzle_outside_whatdo_turnon_stereo_N
	*then 
		-> cowplant_puzzle_outside_whatdo_wake_man

@cowplant_puzzle_outside_whatdo_wake_man
	*then 
		if view_manoutside {
			-> cowplant_puzzle_outside_whatdo_wake_man_Y
		}
		-> cowplant_puzzle_outside_whatdo_wake_man_N

@cowplant_puzzle_outside_whatdo_wake_man_Y
	*say 
		 wake up the man, 
	*then 
		-> cowplant_puzzle_outside_whatdo_look_note

@cowplant_puzzle_outside_whatdo_wake_man_N
	*then 
		-> cowplant_puzzle_outside_whatdo_look_note

@cowplant_puzzle_outside_whatdo_look_note
	*then 
		 if getnotebook_c {
			 -> cowplant_puzzle_outside_whatdo_look_note_Y
		 }
		 -> cowplant_puzzle_outside_whatdo_look_note_N

@cowplant_puzzle_outside_whatdo_look_note_Y
	*say 
		 look at the notebook, 
	*then
		-> cowplant_puzzle_outside_whatdo_goto_plant

@cowplant_puzzle_outside_whatdo_look_note_N
	*then
		-> cowplant_puzzle_outside_whatdo_goto_plant

@cowplant_puzzle_outside_whatdo_goto_plant
	*then
		if view_plant {
			-> cowplant_puzzle_outside_whatdo_goto_plant_Y
		}
		-> cowplant_puzzle_outside_whatdo_goto_plant_N

@cowplant_puzzle_outside_whatdo_goto_plant_Y
	*say
		 go to the plant.
	*then
	 	-> cowplant_puzzle_outside_whatdo_end

@cowplant_puzzle_outside_whatdo_goto_plant_N
	*then
		-> cowplant_puzzle_outside_whatdo_end

@cowplant_puzzle_outside_whatdo_end
	*say
		[Action]
	*then 
		-> cowplant_puzzle_outside_interaction

// what to do tent ---------------------------------------------------------------------------

@cowplant_puzzle_tent_whatdo
	*say
		You can look around, look at specific things, go outside.
	*then 
		-> cowplant_puzzle_tent_whatdo_look_note

@cowplant_puzzle_tent_whatdo_look_note
	*then 
		 if getnotebook_c {
			 -> cowplant_puzzle_tent_whatdo_look_note_Y
		 }
		 -> cowplant_puzzle_tent_whatdo_look_note_N

@cowplant_puzzle_tent_whatdo_look_note_Y
	*say 
		 look at the notebook, 
	*then
		-> cowplant_puzzle_tent_whatdo_talk_man

@cowplant_puzzle_tent_whatdo_look_note_N
	*then
		-> cowplant_puzzle_tent_whatdo_talk_man

@cowplant_puzzle_tent_whatdo_talk_man
	*then 
		 if view_mantent {
			 -> cowplant_puzzle_tent_whatdo_talk_man_Y
		 }
		 -> cowplant_puzzle_tent_whatdo_talk_man_N

@cowplant_puzzle_tent_whatdo_talk_man_Y
	*say 
		 talk to the man. 
	*then
		-> cowplant_puzzle_tent_whatdo_end

@cowplant_puzzle_tent_whatdo_talk_man_N
	*then
		-> cowplant_puzzle_tent_whatdo_end

@cowplant_puzzle_tent_whatdo_end
	*say
		[Action]
	*then 
		-> cowplant_puzzle_tent_interaction	

//End of what to do ------------------------------------------------------------------------------

@cowplant_puzzle_cowplant_interact
	*say
		You go to the plant. What do you want to do to the plant? [Action]
	*then
		-> cowplant_puzzle_cowplant_interaction

@cowplant_puzzle_outside_view_man_gone
	*say
		You look at the man. He is already gone to the tent. You can probably go to the tent to find him.
	*then
		-> cowplant_puzzle_outside_interaction

@cowplant_puzzle_outside_view_tent
	*say
		You look at the tent. That's the tent you came from. You can go to the tent at anytime.
	*then
		-> cowplant_puzzle_outside_interaction

@cowplant_puzzle_tent_goto
	*say
		[footstep]You go to the tent. [Action]
	*then
		-> cowplant_puzzle_tent_interaction

@cowplant_puzzle_tent_interaction
	*say
		
	*then
		hear look around {
		    if wakeman {
			    -> cowplant_puzzle_tent_around_man
			}
			
			-> cowplant_puzzle_tent_around_noman
		}

		hear look at the man {
		    if !wakeman{
		        -> cowplant_puzzle_tent_view_man_out
		    }
			flag view_mantent
			-> cowplant_puzzle_tent_view_man
		}
		hear look at the notebook, look at the note, look at the book, look at the observation, read the notebook {
		    if getnotebook_c{
				set currentplace to 0
		        -> cowplant_puzzle_notebook_open
		    }
			-> cowplant_puzzle_tent_view_notebook
		}
		hear talk to the man{
			if !wakeman{
				-> cowplant_puzzle_tent_view_man_out
			}
			-> cowplant_puzzle_tent_view_man_talk
		}
		hear go outside, leave the tent {
			-> cowplant_puzzle_outside_go
		}
		hear look at the door {
			-> cowplant_puzzle_tent_view_door
		}
		hear what can I do, what {
			-> cowplant_puzzle_tent_whatdo
		}
	*recap
		//TODO: this recap needs update
		You can not do that. If you need help, you can ask, what can I do. [Action]
	*reprompt
		You can look around, look at specific things, or go outside. [Action]

@cowplant_puzzle_tent_view_man_out
	*say
		You try to find the man but he is still lying outside. You may want to go outside and wake him up. [Action]
	*then
		-> cowplant_puzzle_tent_interaction

@cowplant_puzzle_tent_view_door
	*say
		You look at the door. It leads to outside. You can go outside as you want.
	*then
		-> cowplant_puzzle_tent_interaction

@cowplant_puzzle_outside_go
	*say
		[footstep]You go outside. [Action]
	*then
		-> cowplant_puzzle_outside_interaction

@cowplant_puzzle_notebook_open
	*say
		You look at the notebook.<audio src='https://koetest.s3.amazonaws.com/Act5/Act5Puzzle/openbook_01.mp3'/> What keyword do you want to search?
	*then
		-> cowplant_puzzle_notebook_seedtrader

@cowplant_puzzle_tent_nonote
	*say
		You didn't pick up a notebook yet
	*then
		-> cowplant_puzzle_outside_interaction

@cowplant_puzzle_tent_view_notebook
	*say
		You look at the notebook. It is a leather book that reads cow plant Observation Notes. You should pick up the notebook. [Action]
	*recap
		You should pick up the notebook first.
	*reprompt 
		You should pick up the notebook.
	*then
		hear pick up the notebook, pick up, pick {
			flag getnotebook_c
			set currentplace to 0
			-> cowplant_puzzle_tent_pickup_notebook
		}

@cowplant_puzzle_tent_view_man
	*say
		You look at the man. He is sitting still like a stone. Looking at nowhere. Maybe you want to ask him what happened. [Action]
	*then
		hear what happened {
			-> cowplant_puzzle_tent_view_man_talk
		}

@cowplant_puzzle_tent_view_man_talk
	*say
		He is murmuring to himself. It's unlikely that you will get any clue from him. 
		It's on you to find out what happened. Hopefully you can find a way to cure him. The notebook has his writing. You might find some useful information from the notebook. [Action]
	*then
		-> cowplant_puzzle_tent_interaction

@cowplant_puzzle_tent_around_noman
	*say
		You are in the tent. A leather book that reads cow plant Observation Notes is on the table. [Action]
	*then
		-> cowplant_puzzle_tent_interaction

@cowplant_puzzle_tent_around_man
	*say
		You are in the tent. A man is sitting still in front of a table. A leather book that reads cow plant Observation Notes is on the table. 
		The door is behind you. [Action]
	*then
		-> cowplant_puzzle_tent_interaction

@cowplant_puzzle_outside_stereo_on
	*say
		You turn on the stereo. <audio src='https://koetest.s3.amazonaws.com/Act3/Act3+puzzle/radio.mp3'/> 
		To your surprise the plant starts to swag along with the music.
	*then
		-> cowplant_puzzle_outside_interaction

@cowplant_puzzle_outside_view_stereo
	*say
		You look at the stereo. It is on the ground beside the plant. Looks like someone listens to it frequently.
 You can turn on the stereo.
	*then
		flag view_stereo
		-> cowplant_puzzle_outside_interaction

@cowplant_puzzle_outside_view_basket
	*say
		You look at the basket of swordfish on the corner. Is that the food for the plant? Maybe you can interact with the plant, and then feed it. 
	*then
		-> cowplant_puzzle_outside_interaction

@cowplant_puzzle_cowplant_interaction
	*say
		
	*recap
		The plant does not react. If you are not sure what to do with it, you can leave the plant for now and come back later when you know what to do.[Action]
	*reprompt
		You can do anything to the cow plant, or you can leave the plant.
	*then
		hear play with the plant, play with it, play, play with the cow plant {
			-> cowplant_puzzle_plant_play
		}
		hear feed the cow plant, feed it, feed, feed the plant, feed the cow plant, feed it fish, feed it with swordfish {
			-> cowplant_puzzle_plant_feed
		}
		hear milk the cow plant, milk the plant, milk, milk it {
		    flag getmilk
			-> cowplant_puzzle_plant_milk
		}
		hear grab the cake, go for the cake, take the cake, look into the cake {
			-> cowplant_puzzle_plant_cake
		}
		hear leave the plant, leave, {
			-> cowplant_puzzle_cowplant_leave
		}

@cowplant_puzzle_cowplant_leave
	*say
		You leave the plant.
	*then
		-> cowplant_puzzle_outside_interaction

@cowplant_puzzle_outside_view_plant
	*say
		You look at this bizarre plant from a distance. A label on it reads, cow plant. 
		It has a cow head but a normal plant root. A bell is hanging on its stem, or, more accurately, its neck. 
		Now it's waving its cow head at you to get your attention. 
		It slowly sticks out its tongue to you. What's even weird is that, the tip of the tongue is a cake! 
		Maybe you want to get closer by saying go to the plant. 
	*then
		-> cowplant_puzzle_outside_interaction

@cowplant_puzzle_outside_wake_man
	*say
		You shake the man to wake him up. He suddenly opens his eyes and stares straight at you. 
		He is murmuring some words. He is half conscious. 
		Without saying anything to you he walks straight back to the tent. 
		He must be the one who saved you from the sandstorm. What exactly happened to this poor man? 
		Maybe you can go to the tent to find out more, or you can look at other specific objects.
	*then
		-> cowplant_puzzle_outside_interaction

@cowplant_puzzle_outside_view_man
	*say
		You look at the man. He has fainted on the ground. He is wet and smelly with some green liquid all of his clothes. You may want to wake him up. 
	*then
		flag view_manoutside
		-> cowplant_puzzle_outside_interaction

@cowplant_puzzle_outside_around_man
	*say
		You look around. You are outside of the tent. You can see a plant and a man is lying beside the plant. There are also a basket of swordfish, and a stereo.
	*then
		-> cowplant_puzzle_outside_interaction

@cowplant_puzzle_outside_around_noman
	*say
		You look around. You are outside of the tent. You can see a plant and a man is lying beside the plant. There are also a basket of swordfish, and a stereo.
	*then
		-> cowplant_puzzle_outside_interaction

@cowplant_puzzle_tent_getmilk
	*say
		You go back to where the man is. And you force him to drink the milk. 
		[SeedTrader]
		Ahhh... What is that! en... Thanks. You bring me back![EOA]
	*then
		if skip {
			-> cowplant_puzzle_ends
		}
		-> cowplant_puzzle_end_connect_to_act_three

@cowplant_puzzle_ends
	*say	
		This is the end of this cow plant puzzle. Do you want to play the story, or solve another puzzle?
	*then
		hear story {
			unflag skip
			-> Lost in Desert
		}
		hear puzzle {
			flag skip
			-> jumptopuzzle
		}

@cowplant_puzzle_end_connect_to_act_three
	*show
		template: 'default'
        background:'https://koetest.s3.amazonaws.com/visuals/Dessert/dessertAll.png'
        title: ''
        subtitle: ''
	*say
		
	*then
		-> MysMan Introduces Himself

@cowplant_puzzle_plant_milk
	*say
		You milk the plant, <audio src='https://koetest.s3.amazonaws.com/Act3/milkingCowplant.mp3'/>  You get a bottle of milk, or you can call it potion. [Achievement] Maybe this is the potion to cure the man. You can go help the man directly, or take a look at the notebook and see if it's the right solution. [Conversation] Do you want to help the man to drink the milk right now, or check the notebook first?
	*then
		hear milk, drink, help the man, man {
			-> cowplant_puzzle_tent_getmilk
		}
		hear notebook, check the notebook, check {
			-> cowplant_puzzle_notebook_seedtrader_milk
		}

@cowplant_puzzle_plant_cake
	*say
		You try to get the cake but give up. The tongue is sticky and smelly. 
	*then
		-> cowplant_puzzle_outside_interaction

@cowplant_puzzle_plant_play
	*say
		You play with the cow plant.<audio src='https://koetest.s3.amazonaws.com/Act3/cowHappy.mp3'/> It seems happy.
	*then
		-> cowplant_puzzle_cowplant_interaction

@cowplant_puzzle_plant_feed
	*say
		You grab a sticky swordfish from the basket and feed the plant. <audio src='https://koetest.s3.amazonaws.com/Act3/cowplantSounds_01.mp3'/>
	*then
		-> cowplant_puzzle_cowplant_interaction

@cowplant_puzzle_notebook_seedtrader
	*say
		
	*then
		hear introduction, cow plant, search introduction {
			-> cowplant_puzzle_notebook_seedtrader_introduction
		}
		hear baby, baby state, search baby state {
			-> cowplant_puzzle_notebook_seedtrader_baby
		}

		hear mature, mature state, search mature state {
			-> cowplant_puzzle_notebook_seedtrader_mature
		}

		hear state, states, growth states, search growth states {
			-> cowplant_puzzle_notebook_seedtrader_states
		}

		hear feed, search feed {
			-> cowplant_puzzle_notebook_seedtrader_feed
		}

		hear cake, tongue, cake tongue, search cake, search cake tongue {
			-> cowplant_puzzle_notebook_seedtrader_cake
		}

		hear eat, swallow, search swallow {
			-> cowplant_puzzle_notebook_seedtrader_swallow
		}

		hear milk, potion, cure, search milk {
			-> cowplant_puzzle_notebook_seedtrader_milk
		}

		hear death, death state, search death {
			-> cowplant_puzzle_notebook_seedtrader_death
		}
		hear hungry, search hungry {
			-> cowplant_puzzle_notebook_seedtrader_hungry
		}
		hear cow plant berry, search berry {
			-> cowplant_puzzle_notebook_seedtrader_berry
		}
		hear sprout state, sprout, search sprout state{
			-> cowplant_puzzle_notebook_seedtrader_sprout
		}
		hear allergic symptoms, allergic, search allergic {
			-> cowplant_puzzle_notebook_seedtrader_allergic
		}
		hear dementia, severe dementia, search dementia {
			-> cowplant_puzzle_notebook_seedtrader_dementia
		}
		hear devour, search devour {
			-> cowplant_puzzle_notebook_seedtrader_devour
		}
		hear close the notebook {
		    -> cowplant_puzzle_notebook_close
		}
	*reprompt
		You can search for keywords that you read in the notebook. 
		Or you can close the notebook if you find a way to cure the man. Which keyword would you like to search? [Action]
	*recap
		Sorry there's no bookmark for that.

@cowplant_puzzle_notebook_seedtrader_introduction
	*say
		You searched the keyword, cow plant introduction. It reads. 
		cow plant is a bizarre, partly bovine form of vegetation. It usually has 4 growth states. 
	*then
		-> cowplant_puzzle_notebook_seedtrader

@cowplant_puzzle_notebook_seedtrader_devour
	*say
		You searched the keyword, devour. The page reads. If a person attempts to take the cake again, the cow plant will devour them. Which means, they are killed forever.
	*then
		-> cowplant_puzzle_notebook_seedtrader

@cowplant_puzzle_notebook_seedtrader_dementia
	*say
		You searched the keyword, severe dementia. The page reads. Allergic to cow plant can possibly cause severe dementia to certain people. Syptoms include eyes out of focus, memory lost, and loss of ability to speak. Drinking the cow plant milk will release the bad mood, at the same time, cure the allergic symptoms.
	*then
		-> cowplant_puzzle_notebook_seedtrader

@cowplant_puzzle_notebook_seedtrader_allergic
	*say
		You searched the keyword, allergic symptoms. The page reads. A few people are allergic to be swallowed by the cow plant. Allergic symptoms are different from person to person. possibly causing severe dementia to certain people.
	*then
		-> cowplant_puzzle_notebook_seedtrader

@cowplant_puzzle_notebook_seedtrader_sprout
	*say
		You searched the keyword, sprout. The page reads.
 After you plant a cow plant Berry, tiny horns will appear through the soil.
	*then
		-> cowplant_puzzle_notebook_seedtrader

@cowplant_puzzle_notebook_seedtrader_berry
	*say
		You searched the keyword, cow plant berry. The page reads. cow plant berry is a black and white berry. Once you plant the cow plant berry into the soil, it will grow up as a sprout stage cow plant.
	*then
		-> cowplant_puzzle_notebook_seedtrader

@cowplant_puzzle_notebook_seedtrader_hungry
	*say
		You searched the keyword, hungry. The page reads.
When cow plant is hungry, it will stick its cake tongue out. You can feed them at this moment. cow plant will swallow whoever reaches for the cake.
	*then
		-> cowplant_puzzle_notebook_seedtrader

@cowplant_puzzle_notebook_seedtrader_death
	*say
		You searched the keyword, death state. The page reads. Twelve hours after a cow plant shows its cake tongue, and is not fed, it will die, A dead cow plant has a dead stem with a hanging cow plant skull. Cowplants cannot be saved after this stage.
	*then
		-> cowplant_puzzle_notebook_seedtrader

@cowplant_puzzle_notebook_seedtrader_milk
	*say
		You searched the keyword, milk. The page reads. If people were swallowed for the first time, the cow plant will produce milk. Milking a cow plant, you will get a potion to release the mood, and give the emotions back to the patient. The study found, drinking the milk can also cure the allergic symptoms. [Achievement] Yes! Maybe the milk can cure the man!
	*then
		-> cowplant_puzzle_notebook_seedtrader

@cowplant_puzzle_notebook_seedtrader_swallow
	*say
		You search the bookmark that writes, swallow, and opened up from that page. It reads.
		When a person is swallowed for the first time, the cow plant will spit them out, and they will receive a drained mood, which will last two days. The mood will make people feel like an emotionless shell. Different allergic symptoms causing by swallowed have been found to a few people. If people attempt to go for the cake again, the cow plant will devour them. But, if people survive from the first swallowing, the cow plant will produce milk.
	*then
		-> cowplant_puzzle_notebook_seedtrader

@cowplant_puzzle_notebook_seedtrader_cake
	*say
		You searched the keyword, cake tongue. The page reads. cow plant has a cake shaped tongue. When it is hungry, it will stick its tongue out to attract people's attention, so cow plant can swallow them.
	*then
		-> cowplant_puzzle_notebook_seedtrader

@cowplant_puzzle_notebook_seedtrader_feed
	*say
		You searched the keyword, feed. The page reads. A cow plant can  be fed  by meat when its hungry and its cake- shape- tongue sticks out.
	*then
		-> cowplant_puzzle_notebook_seedtrader

@cowplant_puzzle_notebook_seedtrader_states
	*say
		You searched the keyword, growth states. The page reads. Cowplants usually have three growth states, and can die. They are sprout state, baby state, mature state, and death state.
	*then
		-> cowplant_puzzle_notebook_seedtrader

@cowplant_puzzle_notebook_seedtrader_states_tutorial
	*say
		You searched the keyword, growth states. 
		The page reads. Cowplants usually have three growth states, and can die. They are sprout state, baby state, mature state, and death state. 
		You can search for its different growth states later. For now, to finish searching, Try to saying, close the notebook.
	*recap
		To finish searching, Try to saying close the notebook.
		If you can think of any keyword that you want to search, you can look at the notebook again, at anytime.
	*reprompt
		To finish searching, Try to saying close the notebook.
	*then
		hear close the notebook {
			-> cowplant_puzzle_notebook_close
		}

@cowplant_puzzle_notebook_seedtrader_mature
	*say
		You searched the keyword, mature state. The page reads. In this stage, the cow plant is fully matured. You can feed it, or at some certain moment, you can milk it. When a person is swallowed for the first time, the cow plant will spit them out, and they will receive a drained mood, which will last two days. If people survive from the first swallowing, the cow plant will produce milk. I'll make more notes on the milk later in the related category.
	*then
		-> cowplant_puzzle_notebook_seedtrader

@cowplant_puzzle_notebook_seedtrader_baby
	*say
		You searched the keyword, baby state. The page reads. A few days after you plant the cow plant berry. You can see a tiny cow plant. In this state, you can't do much things with it.
	*then
		-> cowplant_puzzle_notebook_seedtrader

@cowplant_puzzle_notebook_close
	*say
		You closed the notebook. <audio src='https://koetest.s3.amazonaws.com/Act5/Act5Puzzle/closebook_01.mp3'/>
		You can look at it again later and search for more keywords. [Action]
	*then
		if currentplace is 0 {
		    -> cowplant_puzzle_tent_interaction
		}
		if currentplace is 1 {
		    -> cowplant_puzzle_outside_interaction
		}

//escape hut puzzle --------------------------------------------------------------------------------------------------------

@escape_puzzle_intro
	*say
		What should you do? Probably look around?
	*reprompt
		You have arrived at the cave, only to be locked in a small hut by a man with faded purple hair. The door seems to be stuck by something, so you're trapped inside. What should you do to get out?
	*recap
		You've been locked in the hut. Perhaps you should look around? [Action]
	*then
		hear look around, what's around me, check what's around me, anything around {
		    set dirt to 0
		    unflag readportal
		    unflag getwand
		    unflag insertwand
		    unflag heatbox
		    unflag freezebox

			unflag view_note_e
			unflag view_flower
			unflag view_barrel
			unflag view_burner
			unflag view_portal

			-> escape_puzzle_around
		}

@escape_puzzle_around
	*say
		You looked around the small hut. The door is locked. In front of you, there is a table with some stuff stacked on top. Beside the table, you see a trash bin. Right across
 		the table, there is a flower stand. On your right, there is a piece of strange equipment that looks like a portal. And on your left, you see a chest. You can look at 
		different things to see more details.
	*then
		-> escape_puzzle_interaction

@escape_puzzle_interaction
	*recap
		You can't do that. If you need help, you can ask, what can I do. [Action]
	*reprompt
		You can look around or look at specific things. [Action]
	*then
		hear view the table, view table, look at the table, look at table, table, check the table, check table {
			-> escape_puzzle_view_table
		}
		hear look at the notebook, view the notebook, view notebook, look at notebook, notebook, check the notebook, check notebook, open the notebook, open up the notebook {
			if view_note_e {
				-> escape_puzzle_open_notebook
			}
			-> escape_puzzle_view_notebook
		}
		hear look around, what's around me, check what's around me, check around {
			-> escape_puzzle_around
		}
		hear view the chest, look at the chest, look at chest, view chest, check the chest, check chest {
			-> escape_puzzle_view_chest
		}

		hear view the box, view the metal box, look at the box, box, metal box, box, look at metal box, look at box, check the box, check metal box, check box {
			-> escape_puzzle_view_metalbox
		}

		hear view the trash bin, look at the trash bin, look at trash bin, check the trash bin, check trash bin {
			-> escape_puzzle_view_trash
		}

		hear view the newspaper, look at the newspaper, look at newspaper, check newspaper, check the newspaper, read newspaper, read the newspaper {
			-> escape_puzzle_view_newspaper
		}

		hear view the alcohol burner, look at the alcohol burner, look at alchohol burner, burner, alcohol burner, the burner, the alcohol burner {
			-> escape_puzzle_view_alcohollamp
		}

		hear view the wooden barrel, view the barrel, look at the barrel, look at the wooden barrel, look at wooden barrel, look at barrel {
			-> escape_puzzle_view_barrel
		}

		hear view the portal, look at the portal, look at portal, check the portal, check portal {
		    if insertwand{
		        -> escape_puzzle_view_portal_wand
		    }
			-> escape_puzzle_view_portal
		}

		hear view the flower stand, view flower stand, look at flower stand, look at stand, look at the stand, look at the flower stand {
		    if readportal{
		        -> escape_puzzle_vew_flower_dirt
		  }
			-> escape_puzzle_view_flower
		}

		hear heat up the metal box, heat up the wand, heat up the box, use the alcohol burner on the metal box, use the metal box on the alcohol burner, use the matal box on the burner, use the box on the burner, use the wand box on the alcohol burner {
		    if getwand{
		        -> escape_puzzle_damage_wand
		    }
			-> escape_puzzle_heatup_metalbox
		}
		hear freeze the metal box, freeze the box, freeze the wand, use the metal box on the barrel, put the metal box into the barrel, use the metal box on the wooden barrel, use the wand box on the barrel, use the box on the barrel {
		      if getwand{
		        -> escape_puzzle_damage_wand
		    }
			-> escape_puzzle_freeze_metalbox
		}

		hear stand on the portal, stand on portal, go to the portal {
		    if insertwand and dirt!=0 { 
		        -> escape_puzzle_stand_portal_ready
	    	}
		    if insertwand{
		       -> escape_puzzle_stand_portal_nodirt
	    	}
		    -> escape_puzzle_stand_portal_nothing
		}

		hear insert the wand to the portal, insert the wand to the hole, insert the wand into the hole, insert the wand into the portal, on the wand on the portal, use the wand on the hole {
		    if getwand{
			-> escape_puzzle_insert_wand
			}
			-> escape_puzzle_interaction
		}

		hear freeze the notebook, use the notebook on the barrel, use the notebook on the ice, put the notebook into the ice {
			-> escape_puzzle_freeze_note
		}

		hear heat up the notebook, heat the notebook, use the notebook on the alcohol burner, use the notebook on the burner, burn the notebook {
			-> escape_puzzle_heat_note
		}

		hear heat up the barrel, heat barrel, use the barrel on the alcohol burner, use the barrel on the burner {
			-> escape_puzzle_heat_barrel
		}

		hear freeze the alcohol burner, freeze the burner, use the burner on the barrel, put the burner in the barrel  {
			-> escape_puzzle_freeze_lamp
		}

		hear insert the metal box into the hole, use the metal box on the hole, use the box on the hole {
			-> escape_puzzle_insert_metalbox
		}

		hear insert the notebook into the hole, use the notebook on the hole {
			-> escape_puzzle_insert_note
		}
		
		hear take some dirt from the second pot, grab the dirt from number two pot, grab the dirt from black berry, two, take dirt from pot number two, take the dirt from pot number two, grab dirt from pot number two, grab the dirt from pot number two, take some dirt from pot number two, take some dirt from number two, take some dirt from black berry {
			-> escape_puzzle_vew_flower_dirt_2
		}

		hear take some dirt from the third pot, grab the dirt from number three pot, grab the dirt from mandrake, three, take dirt from pot number three, take the dirt from pot number three, grab dirt from pot number three, grab the dirt from pot number three, take some dirt from pot number three, take some dirt from number three, take some dirt from mandrake {
			-> escape_puzzle_vew_flower_dirt_3
		}
		hear take some dirt from the first pot, grab the dirt from number one pot, grab the dirt from fang flower, one, take dirt from put number one, take the dirt from put number one, grab dirt from put number one, grab the dirt from put number one, take some dirt from pot number one, take some dirt from number one, take some dirt from fang flower  {
			-> escape_puzzle_vew_flower_dirt_1
		}
		
		hear grab dirt, take some dirt, take dirt{
		    -> escape_puzzle_grab_dirt
		}

		hear use the flower on the portal, use the barrel on the portal, use the blueberry on the portal, use the flower stand on the portal {
			-> escape_puzzle_insert_wrong
		}

		hear look at the wand, view the wand {
			if getwand{
				-> escape_puzzle_view_wand
			}
			-> escape_puzzle_view_wand_no
		}

		hear look at the door, look at door{
			-> escape_puzzle_view_door
		}

		hear what can I do, what, can I {
			-> escape_puzzle_whatdo
		}

@escape_puzzle_view_door
	*say
		You look at the door. It has been locked from outside. 
	*then
		-> escape_puzzle_interaction

@escape_puzzle_view_wand
	*say
		You look at the wand. It's a wooden wand. Nothing else special.
	*then
		-> escape_puzzle_interaction

@escape_puzzle_view_wand_no
	*say
		You look at the wand. It's still in the metal box. [Conversation] If you want to look into details, you should find a way to break the metal.
	*then
		-> escape_puzzle_interaction

@escape_puzzle_insert_wrong
	*say
		You tried to insert it into the portal, but it doesn't fit.

@escape_puzzle_insert_note
	*say
		You insert the notebook into the portal. It doesnt go there.
	*then
		-> escape_puzzle_interaction

@escape_puzzle_insert_metalbox
	*say
		You insert the metal box into the portal. It doesnt seem to fit in the hole. But what about the wand inside?
	*then
		-> escape_puzzle_interaction

@escape_puzzle_freeze_lamp
	*say
		You want to freeze the alcohol burner, but putting an alcohol burner into ice water will either do nothing or damage it.
	*then
		-> escape_puzzle_interaction

@escape_puzzle_heat_barrel
	*say
		You heat up the barrel. But a little alcohol burner will do nothing to a large barrel of ice water.
	*then
		-> escape_puzzle_interaction

@escape_puzzle_heat_note
	*say
		You want to heat up the notebook, but then you realize that it will set the notebook on fire. It probably isn't a good idea to set the house on fire.
	*then
		-> escape_puzzle_interaction

@escape_puzzle_freeze_note
	*say
		It's probably not a good idea to freeze someone's notebook. You'll probably destroy it.
	*then
		-> escape_puzzle_interaction

@escape_puzzle_damage_wand
	*say
		You already got the wand out of the metal box. Either heating up the wand or freezing the wand will damage it. Don't do that.

@escape_puzzle_insert_wand
	*say
		You insert the wand into the portal. It fits into the hole perfectly. <audio src='https://koetest.s3.amazonaws.com/Act5/magicSound01.mp3'/> The inscriptions around the portal start to glow. [Achievement] Yes, now it's time to stand on the portal and see the magic words! 
	*then
		flag insertwand
	    -> escape_puzzle_interaction

@escape_puzzle_stand_portal_ready
	*say
		You stand on the portal. <audio src='https://koetest.s3.amazonaws.com/Act5/magicSound03.mp3'/> The wand is reacting to the dirt in your hand.
	*recap
		You can say, teleport, or you can step back.
	*reprompt
		You can say, teleport, or you can step back.
	*then
		hear step back {
			-> escape_puzzle_stand_portal_stepback
		}
		
		hear teleport {
		    if dirt == 1{
			-> escape_puzzle_stand_portal_alien
			}
			if dirt == 2{
			-> escape_puzzle_stand_portal_out
			}
			if dirt == 3{
			-> escape_puzzle_stand_portal_realm
			}
		}

@escape_puzzle_stand_portal_out
	*say
		You are traveling through the portal.<audio src='https://koetest.s3.amazonaws.com/Act5/Act5Puzzle/portaltravel_01.mp3'/> In a blink of an eye, you are standing in the inner cave. You made your way out!
		[Achievement]
	*then
		if skip {
			-> escape_puzzle_ends
		}
		-> Exit The Room

@escape_puzzle_ends
	*say	
		That's the end of this escape room puzzle. Do you want to experience the whole story now, or choose another puzzle to play?
	*then
		hear story {
			unflag skip
			-> Lost in Desert
		}
		hear puzzle {
			flag skip
			-> jumptopuzzle
		}

@escape_puzzle_stand_portal_realm
	*say
		//magic realm
		You are traveling through the portal. <audio src='https://koetest.s3.amazonaws.com/Act5/Act5Puzzle/portaltravel_01.mp3'/> After a short time, you appear in a different space. You are on top of a floating island.
	*recap
		This is not the right place to go, you should teleport back.
	*reprompt
		This is not the right place to go, you should teleport back.
	*then
		hear teleport back {
			-> escape_puzzle_stand_portal_travelback
		}

@escape_puzzle_stand_portal_alien
	*say
		//alien planet Sixam
		You are traveling through the portal.<audio src='https://koetest.s3.amazonaws.com/Act5/Act5Puzzle/portaltravel_01.mp3'/> After a long time, you appear in a strange space. All the plants are glowing.
	*recap
		This is not the right place to go, you should teleport back.
	*reprompt
		This is not the right place to go, you should teleport back.
	*then
		hear teleport back {
			-> escape_puzzle_stand_portal_travelback
		}

@escape_puzzle_stand_portal_travelback
	*say
		You travel back through the same tunnel.
	*then
		-> escape_puzzle_interaction

@escape_puzzle_stand_portal_stepback
	*say
		You step back from the portal.
	*then
		-> escape_puzzle_interaction

@escape_puzzle_stand_portal_nodirt
	*say
		You stand on the portal. The wand activates the portal, but nothing happened. Seems like you are still missing something important to make it fully work. You step back from the portal. You may want to look for a description of this long distance travel portal from somewhere.
	*then
		-> escape_puzzle_interaction

@escape_puzzle_stand_portal_nothing
	*say
		You stand on the portal. Nothing happened. It seems like you need to insert something into the hole to make it operate. You step back from the portal. You might need to find a full description of this long distance travel portal.
	*then
		-> escape_puzzle_interaction

@escape_puzzle_vew_flower_dirt
	*say
		You look at the flower stand. You see three pots with plants in them. 
		The dirt in these pots is different from each other. Seems like someone carefully transplanted those vegetation with the dirt from their origins. 
		From the left to the right, they are labeled as, number one,  Fang Flower, number two, Blackberry, and number three, Mandrake. 
		You can take some dirt from one of these pots to help you travel through the portal.
	*then
		-> escape_puzzle_interaction

@escape_puzzle_grab_dirt
	*say
		From the left to the right, they are labeled as, number one,  Fang Flower, number two, Blackberry, and number three, Mandrake. You can take some dirt from any pot. Which number of pot do you want to take some dirt from?
	*then
		hear take some dirt from the second pot, grab the dirt from number two pot, grab the dirt from black berry, two {
			-> escape_puzzle_vew_flower_dirt_2
		}
		hear take some dirt from the third pot, grab the dirt from number three pot, grab the dirt from mandrake, three {
			-> escape_puzzle_vew_flower_dirt_3
		}
		hear take some dirt from the first pot, grab the dirt from number one pot, grab the dirt from fang flower, one {
			-> escape_puzzle_vew_flower_dirt_1
		}
		hear do nothing {
			-> escape_puzzle_interaction
		}
	*recap
		Which number of pot do you want to grab the dirt from? or you can do nothing.
	*reprompt
		Which number of pot do you want to grab the dirt from? or you can do nothing.

@escape_puzzle_vew_flower_dirt_3
	*say
		You grab the dirt from pot number three, mandrake, and hold it in your hand.
	*then
		set dirt to 3
	    -> escape_puzzle_interaction

@escape_puzzle_vew_flower_dirt_2
	*say
		You grab the dirt from pot number two, black berry, and hold it in your hand. [Achievement]
	*then
		set dirt to 2
	    -> escape_puzzle_interaction

@escape_puzzle_vew_flower_dirt_1
	*say
		You grab the dirt from pot number one, fang flower, and hold it in your hand.
	*then
		set dirt to 1
	    -> escape_puzzle_interaction

@escape_puzzle_box_break
	*say
		The metal box is broken. <audio src='https://koetest.s3.amazonaws.com/Act5/Act5Puzzle/metalcrack_01.mp3'/> From the container, you retrieve a wand. [Achievement] If you get the dirt of the right flower, you can use the portal now!
	*then
		flag getwand
	-> escape_puzzle_interaction

@escape_puzzle_heatup_metalbox
	*say
		You heat up the metal box with the alcohol burner. 
	*then
		flag heatbox
		if freezebox{
	        -> escape_puzzle_box_break
	   }
	    -> escape_puzzle_interaction

@escape_puzzle_freeze_metalbox
	*say
		You freeze the metal box by putting it into the ice barrel. <audio src='https://koetest.s3.amazonaws.com/Act5/Act5Puzzle/ice_01.mp3'/>
	*then
		flag freezebox
		if heatbox{
		    -> escape_puzzle_box_break
		}
	    -> escape_puzzle_interaction

@escape_puzzle_view_flower
	*say
		You look at the flower stand. You see three pots with plants in them. 
		The dirt in these pots is different from each other. It seems that someone has carefully transplanted the vegetations with the dirts from their origins. 
		From the left to the right, they are labeled as, number one, Fang Flower, number two, Blackberry, and number three, Mandrake. 
		You can take some dirt from any of the pots and grab it in your hand. But you have no clue what to do with it.
	*then
		flag view_flower
		-> escape_puzzle_interaction

@escape_puzzle_view_portal
	*say
		You look at the portal. The portal is a circle on the floor with inscriptions that you can't understand painted around. 
		The paintings lead to a hole on the floor just in front of the circle. Along with the hole is a little inscription that reads: 
		long distance travel portal. It looks like something needs to be inserted into the hole to operate the portal. 
		You can use anything on the portal, or stand on the portal.
	*then
		flag view_portal
		-> escape_puzzle_interaction

@escape_puzzle_view_portal_wand
	*say
		You look at the portal. The portal is a circle on the floor with glowing inscriptions that you can't understand painted around. The paintings lead to a hole on the floor with a wand sticking into it. Along with the hole is a little inscription that reads: long distance travel portal. You may want to stand on the portal.
	*then
		-> escape_puzzle_interaction

@escape_puzzle_view_barrel
	*say
		You look at the wooden barrel. Removing the cover carefully. You see that it's filled up with ice. 
		Where did she get this much ice from the middle of a desert? You can use anything on the barrel to freeze it.
	*then
		flag view_barrel
		-> escape_puzzle_interaction

@escape_puzzle_view_alcohollamp
	*say
		You look at the alcohol burner. Judging by the marks and scratches on it, it seems like it has been used frequently. 
		You can use anything on the burner to heat it up.
	*then
		flag view_burner
		-> escape_puzzle_interaction

@escape_puzzle_view_newspaper
	*say
		You look at the newspaper. <audio src='https://koetest.s3.amazonaws.com/Act5/Act5Puzzle/newspaper_01.mp3'/> After Expanding it carefully. It reads, Magic Daily. Customer complaints about the wand containers from Juans Wonderful One-Stop Wand Warehouse are not strong enough to protect their luxury wands. Juan responded that all their containers are made by death metal, which is the hardest metal in the world. The problem must be caused by improper use.
	*then
		-> escape_puzzle_interaction

@escape_puzzle_view_trash
	*say
		You look at the trash bin. You find a crumbled piece, dirty piece of newspaper. It seems that he was using it to wipe his table. You can read the newspaper.
	*then
		-> escape_puzzle_interaction

@escape_puzzle_view_metalbox
	*say
		You look at the metal box. On the cover, it writes, Wand, of The Sylvan Forest. You flip it over. On the bottom, it has a stamp that reads, Juans Wonderful One-Stop Wand Warehouse. When you try to remove the cover, the box glows an alarming red. The man must have put some spells on the box, so he is the only one who can open it. If you want to open it, you need to find a way to break it.
	*then
		-> escape_puzzle_interaction

@escape_puzzle_view_chest
	*say
		You look at the chest. It isn't locked. You open it up easily. In the chest, you see a long metal box, and an alcohol burner.
	*then
		-> escape_puzzle_interaction

@escape_puzzle_open_notebook
	*say
		You look at the notebook. <audio src='https://koetest.s3.amazonaws.com/Act5/Act5Puzzle/openbook_01.mp3'/> What keyword do you want to search?
	*then
		-> escape_puzzle_notebook_search

@escape_puzzle_notebook_search
	*say
		
	*recap
		Sorry I couldn't find the word you are looking for. You can search for any keyword or close the notebook. 
	*reprompt
		You can search for any keyword or close the notebook. 
	*then
		hear ice, barrel, alcohol burner, alcohol, burn, death metal, metal, search metal, search death metal {
			-> escape_puzzle_notebook_search_deathmetal
		}
		hear black berry, search black berry {
			-> escape_puzzle_notebook_search_blackberry
		}

		hear fang flower, search fang flower {
			-> escape_puzzle_notebook_search_fangflower
		}

		hear mandrake, search mandrake {
			-> escape_puzzle_notebook_search_mandrake
		}

		hear long distance travel portal, portal, long distance, travel portal, search portal, search long distance {
			-> escape_puzzle_notebook_search_portal
		}
		hear close the notebook {
			-> escape_puzzle_notebook_close
		}

		hear chest, box, wand, wand of the sylvan forest, search wand {
			-> escape_puzzle_notebook_search_wand
		}
		hear flower stand, flower, flower, search flower, plant, search plants{
			-> escape_puzzle_notebook_flowerstand
		}

@escape_puzzle_notebook_flowerstand
	*say
		Here is the result of what you are searching: I stored three different types of flowers on the flower stand. They are: black berry, fang flower, and mandrake. I use the dirt of these flowers to locate the position that I wanna teleport to by the portal. 
	*then
		-> escape_puzzle_notebook_search

@escape_puzzle_notebook_cannotfind
	*say
		That bookmark doesn't exist.
	*then
		-> escape_puzzle_notebook_search

@escape_puzzle_notebook_search_destroy_box
	*say
		Here is the result of what you are searching: Sometimes I forget where the key of my death metal wand box, I'll destroy it directly. The method is very simple: use alcohol burner to heat it up, and then put it into the ice water. And that's why I always put one alcohol burner and one barrel of ice water inside the room.
	*then
		-> escape_puzzle_notebook_search

@escape_puzzle_notebook_search_wand
	*say
		You search if there's a book mark is relevant. It reads. This wand is hand carved from the trees of Sylvan Glade, it holds immense power. I use it to operate my long distance travel portal. This wand is well kept in a box made of death metal.
	*then
		-> escape_puzzle_notebook_search

@escape_puzzle_notebook_close
	*say
		<audio src='https://koetest.s3.amazonaws.com/Act5/Act5Puzzle/closebook_01.mp3'/> You close the notebook.
	*then
		-> escape_puzzle_interaction

@escape_puzzle_notebook_search_portal
	*say
		You search if there's a book mark about the long distance travel portal. It reads. I put a Transportalate spell on it, and use, wand of the sylvan forest to operate it. So I can travel through the world. As long as, I have the dirt from the place I want to travel to. Grab the dirt in the hand,  stand on the portal, and say, teleport. I will be there immediately. Easily say, teleport back, I will be on the portal again.
	*then
		flag readportal
		-> escape_puzzle_notebook_search

@escape_puzzle_notebook_search_mandrake
	*say
		You search if there's a book mark about mandrakes, and then you flip the notebook to that page. It reads. Mandrake can be found in the magic realm, my hometown. I transplanted it from the area around the broken down greenhouse.
	*then
		-> escape_puzzle_notebook_search

@escape_puzzle_notebook_search_fangflower
	*say
		You search if there's a book mark about the fang flower, and then you flip the notebook to that page. It reads. I brought the fang flower back from a strange place. Several years ago, I received a bottle of dirt from a spice market. I used the dirt to travel through the portal into another world. The sky over there was dark and the plants were glowing. I took the fang flower from there and teleport back immediately.
	*then
		-> escape_puzzle_notebook_search

@escape_puzzle_notebook_search_blackberry
	*say
		You search if there's a book mark about black berries, and then you flip the notebook to that page. It reads. blackberry is been found from oasis springs. But when I first stepped into this cave, I found it's also grows here. So I transplanted it into the pot to remember it is the only living form in this cave before I came.
	*then
		-> escape_puzzle_notebook_search

@escape_puzzle_notebook_search_deathmetal
	*say
		You search if there's a book mark is relevant, and then you flip the notebook to that page. It reads. Death metal is the hardest metal in the world. It will survive from any external force. But, research has found, an alternate hot and cold will destroy its form. I've been testing the firmness of death metal. In the test, I use the death metal on the alcohol burner and ice barrel alternatively, It breaks easily
	*then
		-> escape_puzzle_notebook_search

@escape_puzzle_view_notebook
	*say
		You look at the notebook. It's a heavy notebook. Dozens of bookmarks stick on pages. 
		You take it with you. So, 
		At anytime, you can look at the notebook to search different keywords.
	*then
		flag view_note_e
		-> escape_puzzle_interaction

@escape_puzzle_view_table
	*say
		You look at the table. It's right in front of you. On top of the table, you see a notebook, and a wooden barrel.
	*then
		-> escape_puzzle_interaction


// what can I do---------------------------------------------------------------------------------------------------------------------

@escape_puzzle_whatdo
	*say
		You can look around, or look at specific things. 
	*then
		-> escape_puzzle_whatdo_look_note

@escape_puzzle_whatdo_look_note
	*then
		if view_note_e {
			-> escape_puzzle_whatdo_look_note_Y
		}
		-> escape_puzzle_whatdo_look_note_N

@escape_puzzle_whatdo_look_note_Y
	*say 
		 look at the notebook, 
	*then
		-> escape_puzzle_whatdo_take_dirt

@escape_puzzle_whatdo_look_note_N
	*then
	-> escape_puzzle_whatdo_take_dirt

@escape_puzzle_whatdo_take_dirt
	*then
		if view_flower {
			-> escape_puzzle_whatdo_take_dirt_Y
		}
		-> escape_puzzle_whatdo_take_dirt_N

@escape_puzzle_whatdo_take_dirt_Y
	*say 
		 take some dirt from any flower pot, 
	*then
		-> escape_puzzle_whatdo_barrel

@escape_puzzle_whatdo_take_dirt_N
	*then
		-> escape_puzzle_whatdo_barrel

@escape_puzzle_whatdo_barrel
	*then
		if view_barrel {
			-> escape_puzzle_whatdo_barrel_Y
		}
		-> escape_puzzle_whatdo_barrel_N

@escape_puzzle_whatdo_barrel_Y
	*say 
		 use anything on the wooden barrel, 
	*then
		-> escape_puzzle_whatdo_burner

@escape_puzzle_whatdo_barrel_N
	*then
		-> escape_puzzle_whatdo_burner

@escape_puzzle_whatdo_burner
	*then
		if view_burner {
			-> escape_puzzle_whatdo_burner_Y
		}
		-> escape_puzzle_whatdo_burner_N

@escape_puzzle_whatdo_burner_Y
	*say 
		 use anything on the alcohol burner, 
	*then
		-> escape_puzzle_whatdo_portal

@escape_puzzle_whatdo_burner_N
	*then
		-> escape_puzzle_whatdo_portal

@escape_puzzle_whatdo_portal
	*then
		if view_portal {
			-> escape_puzzle_whatdo_portal_Y
		}
		-> escape_puzzle_whatdo_portal_N

@escape_puzzle_whatdo_portal_Y
	*say 
		 use anything on the portal, or stand on the portal 
	*then
		-> escape_puzzle_whatdo_end

@escape_puzzle_whatdo_portal_N
	*then
		-> escape_puzzle_whatdo_end

@escape_puzzle_whatdo_end
	*then
		-> escape_puzzle_interaction

