@resume
	*say
		Welcome back! Do you want to continue your story from where you last left
        off?
	*then
		hear yes,sure {
            >> RESUME
        }
        hear no {
            -> start
        }

@start
	*say
		Greetings, explorer. [Short_Pause] Welcome to the Desert Traveler experience! [Short_Pause] In this five-act interactive story, you can stop and come back at any time. Shall we start?
	*then
		set currentLocation as 'desert'
		hear yes, sure, of course {
		    -> Lost in Desert
	    }
	    hear no {
	        -> Quit Game
        }
@Quit Game
	*say
        OK. Bye~
    *then
        >> END

@Lost in Desert
	*say
		Oh dear, it's a hot, hot desert. You walk aimlessly in the sand, thirsty for water. The wind is hot, the sun is hot, and the air is burning hot. [Pause] [footstep] In the middle of the hot desert, you found a rusty, old signpost. It has two arrows pointing to the right and the left. However, the letters have faded away.
	*then
		-> Tutorial 1: Direction Questions

@Tutorial 1: Direction Questions
	*say
		[Action]When you hear this sound, you will be deciding which path, or direction, to take. In this case, try saying: go to the left, or go to the right.
	*then
		hear go to the left {
			-> Look Left
		}

		hear go to the right {
			-> Look Right
		}
	*reprompt
		You can say, look left or look right.
	*recap
		[Pause]

@Look Right
	*say
		You wiped your face with your dry hands and decided to turn right. Then, you keep treading the sea of sand wearily.
	*then
		-> Tutorial 1A: Check Around

@Tutorial 1A: Check Around
	*say
		[footstep] You walk under the hot sun until you reach the top of a little sand hill. It let's you see a little bit further away. Now you can see what's around you. [Pause] Sometimes, paths aren't obvious at first glance just like now. You can check around first by saying what's around me. Go on, give it a go.
	*then
		hear what's around me,check, what is around me, check what's around me, around me {
            -> Check Around the Hill
        }
	*reprompt
		You can check around by saying "what's around me".
	*recap
		You can check around by saying "what's around me".

@Check Around the Hill
	*say
		You look around, like a compass slowly spinning. You don't find anything particularly interesting. [Pause] Wait! You see a few freckles on the yellow surfaces of Earth. It shines under the burning sun! You squint your eyes and look closer. [Pause] <emphasis level="reduced">It's a town!</emphasis> [Short_Pause] There's a good chance that they have some water there.[Action]
	*then
		hear go to the town, go towards the town, town, the town {
		    set currentLocation as 'town'
             -> Go to Town
         }
	*reprompt
		You might want to go to a location?
	*recap
		You might want to go to a location? try say go to the town?

@Go to Town
	*say
		Quick! There might be water there.
	*then
		-> Town

@Town
	*say
		The urge of letting cold water pass enter you drags your weary feet to the entrance of the town. At the entrance, you thought the townspeople would step forward immediately to help a thirsty traveler, but instead. [Short_Pause] No-one came. What's happening? [Action] you can ask to check the environment. Try saying: "what's around me?"
	*recap
		you can ask to check the environment. Try saying: "what's around me?"
	*reprompt
		you can ask to check the environment. Try saying: "what's around me?"
	*then
		hear what's around me {
			-> Around 
		}

@Around
	*say
		You're at the entrance of the town. Some small buildings align on the sides of the street. But all of their doors are shut tight. Only a few people are walking on the streets. It's almost as if they're trying to avoid having eye-contact with you.
	*reprompt
		There are a few establishments right in front of you. a general store and the mayor's office. Could any of them have some water? Choose a location to go to.
	*recap
		There are a few establishments right in front of you. a general store and the mayor's office. Could any of them have some water? Choose a location to go to.
	*then
		-> Around_1

@Around_1
	*say
		There are a few establishments right in front of you. A general store and the mayor's office. Could any of them have some water? [Action]
	*recap
		There are a few establishments right in front of you. A general store and the mayor's office. Could any of them have some water? [Short_Pause] Choose a location to go to.
	*reprompt
		There are a few establishments right in front of you. A general store and the mayor's office. Could any of them have some water? [Short_Pause] Choose a location to go to.
	*then
		hear mayor's office, office, mayor, go to mayor's office {
		    set currentLocation as 'mayors office'
			-> Mayor Office
		}
		hear general store, general, store, go to the general store {
		    set currentLocation as 'general store'
			-> Store
		}

@Store
	*say
		Upon approaching the general store, you see a boy. He wears a red coat, and he looks very surprised. [Long_Pause][Kid] You are a new face here. Do you need help? [Short_Pause] You don't look well.[/Kid] [Long_Pause] Maybe the little boy has water. Perhaps you should try asking. [Conversation] When you hear this sound, you decide what to say to the other person next. For example, right now you can ask the boy for water. [Short_Pause] Try it! [Conversation]
	*then 
		hear water, can I have some water, can you give me water, do you have water, do you have any water, ask for water, ask the boy, ask the boy for water, give me some water, give me water {
			-> Boy
		}
	*recap
		Try ask the boy for water [Conversation]
	*reprompt
		 Try ask the boy for water [Conversation]

@Boy
	*say
		You asked the boy for some water. 
		[Kid] 
	    I can help you with that. [Short_Pause] But I must warn you before I take you into our place. [Short_Pause] You probably won't appreciate the conditions in the house. [Short_Pause] Just a heads up.[/Kid] [Pause]
		The boy takes you around the building and enters the store from the backdoor. [Pause] Oh dear. [Pause] It is far from being desirable. It stinks. Smelly, smelly, smelly, it's like wearing the same pair of socks for over a year. [Pause]
		[Kid] Yeah. Told you! [Pause] [/Kid] 
		[Pause] A bald, middle-aged man that looks like in his fifties are slowly walks down the stairs. [Kid] Papa! [Pause] [/Kid] Small pieces of tissue paper are rolled and stuck in his nose. He looks like he could use some more sunshine.
	*then
		-> Shopkeeper

@Shopkeeper
	*say
		[Man]
        Who is this person? [Pause] Why did you bring a stranger that looks like a dying cactus to this place? [EOA] 
        [Kid] 
        [Pause]Relax, papa. He's just a traveler. And he needs water. [Pause]A lot of water.[/Kid] 
        [Man] 
        Water? [Pause] Hah! I got lots of water. As if water would do anything to wash this stench away.[EOA] 
        [Pause] 
        The young boy's father handed you a big glass of water. 
        [Man] 
        Hey. [Pause] Don't worry. I know it smells bad in here. But I assure you, the water is clean. [Pause] Go on, drink up. Ahh. Yes, the water is fresh and good.[EOA]
        [Pause]
        Sometimes when appropriate, you can use an item, perform an action, or do nothing. For this instance, you can either say: [Short_Pause] use water or do nothing.[Action]
	*then
		hear drink water, use water, use the water, water, chug {
			-> Finding Out
		}
		hear don't drink the water, don't, no, do nothing {
			-> Don't Drink
		}
	*recap
		Sometimes when appropriate, you can use an item, perform an action, or do nothing. For this instance, you can either say: [Short_Pause] "use water", or "do nothing".
	*reprompt
		Sometimes when appropriate, you can use an item, perform an action, or do nothing. For this instance, you can either say: [Short_Pause] "use water", or "do nothing".

@Don't Drink
	*say
		You hold the glass of water at your hand, but you don't drink from it. [Pause]
    [Man]
    <emphasis level="strong">Hmmmm.</emphasis> [Pause] [EOA]
    The shopkeeper looks at the glass of water. He looks down on the dusty floor.
    [Man]
    Suit yourself. Thought you were really thirsty. [EOA]
    [Long_Pause] At least you're in the shade, so you're starting to feel a little bit less thirsty. But still, the stench is unbearable.
    [Man]
    Maybe the smell even went into the water. [Long_Pause] It wasn't like this before the incident. [EOA]
    [ActionQuestionSound]
	*recap
		Try say use water.
	*reprompt
		Try say use water.
	*then
		hear use water, drink water {
			-> Finding Out
		}
		hear talk to the shopkeeper, what incident, incident, ask about the incident, ask, talk, talk to the shopkeeper, ask papa {
			-> Ask Shopkeeper
		}

@Finding Out
	*say
		The father has given you his word that the water is clean for drinking. But even without his promise you'd still chug the whole glass of water, bottoms-up.
        [Pause]
        Ahhhh. Refreshing! Although the water smells a bit off, you don't care. What's important is, you're saved from becoming human beef jerky.
        [Man]
        Feel better? You really looked like the desert's going to get you.[EOA] 
        Now it's just the stench that's really
        giving you a headache.
        [Pause]
        [Man]
        Sorry for the bad manners back there. It's just this town has never had a single visitor for a long time. Not after the incident.[EOA]
        [Conversation]You should ask him.
	*reprompt
		You can talk to him by saying talk to the shopkeeper
	*recap
		You can talk to him by saying talk to the shopkeeper
	*then
		hear talk to the shopkeeper, what incident, incident, ask about the incident, ask, talk, talk to the shopkeeper, ask papa {
			-> Ask Shopkeeper
		}

@Ask Shopkeeper
	*say
		[Man]A while ago the town was famed for our Shawarma. People would come all the way from cities to this dune for a taste of it.[Pause] 
		//By the way. What's your name, traveler?
		[EOA]
		[Conversation]
	*then
		//slot playerName_ to 'AMAZON.US_FIRST_NAME'
		//hear {playerName_}, my name is {playerName_} {
			-> Ask for Help
		//}

@Ask for Help
	*say
		[Man] 
		//That's a rare name around here. 
		[Pause] Anyway, this is a desert so you could imagine it never rains here [Short_Pause] until that night. [Pause] On that night. We've seen the greatest thunderstorm of the town's history, [Short_Pause] but no-one anticipated what came after.[EOA]
        [Kid]
        [Long_Pause] And then the next morning, my dad started sweating like a cow. So did everyone else. [/Kid]
        [Man]
        Yeah. [Pause] What's worse was what happens afterward. [Short_Pause]That's right.The stench. This stench. It kept everyone from talking to each other. It drove tourists away. And now, no-one wants to come to our town anymore.[EOA]
        [Pause]
        The shopkeeper points to a poster on the left wall. It has some dust and the colors have started to fade away, but it's still pretty clear. 
        [Man]
        The mayor believed that it's a curse from some spell caster. He was trying to find people to help. Even set up a great reward for anyone who lifts the curse. 
        [Pause]
        Since you're here, why don't you help us? [Short_Pause] There's a lucrative treasure, and it could be all yours. In the meantime, you can look around the store. No worries.[EOA]
        It seems like they really need your help. Do you want to help them?
	*reprompt
		It seems like they really need your help.
	*recap
		It seems like they really need your help. Do you want to help them?
	*then
		hear yes, sure {
			-> Decide to Help
		}

@Mayor Office
	*say
		You arrive at the mayor's office. It's the largest building in the town, but it's doors and windows are tightly shut and locked. [Short_Pause] When you get close to the front door, there's a sharp smell of hot pepper. Looks like there's no way in. 
	*recap
		It looks like there's no way in to the mayor's office. Perhaps you should visit somewhere else and try again later. If you don't know where to go, remember to say What's around me.
    [Action]
	*then
		hear store, general store, go to the general store {
			-> Store
		}
		hear what is around me,around me {
			-> Around_1
		}
	*recap
		Pick the other place
	*reprompt
		If you don't know where to go, remember to say [Short_Pause] what's around me.

@Look Left
	*say
		You wipe your face with your dry hands and decide to turn left. [Pause] Then, you keep treading the sea of powdered rocks wearily.
	*then
		-> Tutorial 1A: Check Around

@Decide to Help
	*say
		[Man]
	    This is our lucky day, son. Finally a person who is willing to help us. Well, I guess I shouldn't be keeping you here for too long eh? [EOA]
		[Kid] 
		But papa, you haven't told him anything about how to solve the problem. [EOA]
		[Man]
		Oh yes, yes. hey, perhaps you can go ask if the mayor knows anything more. After all, he's the one who put up this poster. Maybe he knows more.[EOA]
		[Kid] 
		But the mayor is also locking himself up. No one has seen him for a while. [EOA]
		[Man] 
		Ha! This, my son, is when being the owner of the ONLY general store in the town comes in handy [Short_Pause] Kungh kungh, you see, the mayor has a secret craving for Super-Duper Hot Blue Pepper Sauce. [Short_Pause] And guess who's selling it? Me! Ha haaah! [EOA]
	*recap
		Pick the other place
	*then
		-> Decide to Help 2

@Decide to Help 2
	*say
		[Conversation]
		You can ask about the mayor, ask about the sauce, or ask for one bottle
	*recap
		You can ask about the mayor, ask about the sauce, or ask for one bottle
	*then
		hear buy, buy a bottle, can I have a bottle of hot sauce, could I, can you, can I, one, ask for one bottle, ask one, please give me {
	        -> One Bottle of Sauce
	    }
	    hear ask about the mayor, about the mayor, the mayor {
	        -> Ask Shopkeeper About the Mayor
	    }
	    hear ask about the sauce, about the sauce, the sauce {
	        -> Ask Shopkeeper About the Sauce
	    }
	*reprompt
		You can ask about the mayor, ask about the sauce, or ask for one bottle

@Ask Shopkeeper About the Mayor
	*say
		[Man]
        The mayor has a strange craving for hot sauce. The mayor has turned down guests since the incident. [Short_Pause] The mayor didn't do anything to help the town either. Nobody knows if he's even in his office anymore. What else would you like to know?[EOA] You can ask about the sauce, or ask for one bottle.
	*then
		hear buy, buy a bottle, can I have a bottle of hot sauce, could I, can you, can I, one, ask for one bottle, ask one, please give me  {
            -> One Bottle of Sauce
        }
        hear ask about the sauce, about the sauce, the sauce {
            -> Ask Shopkeeper About the Sauce
        }

@Ask Shopkeeper About the Sauce
	*say
		[Man]
        I can only say, the hot sauce is really hot, [Short_Pause] and it looks blue. Like the gas stoves you see in your kitchen, hot, hot, hot! Hmm, what else would you like to know?[EOA] You can ask about the mayor, or ask for one bottle.
	*then
		hear buy, buy a bottle, can I have a bottle of hot sauce, could I, can you, can I, one, ask for one bottle, ask one, please give me  {
            -> One Bottle of Sauce
        }
        hear ask about the mayor, about the mayor, the mayor {
            -> Ask Shopkeeper About the Mayor
        }

@One Bottle of Sauce
	*say
		[Man]  
        One bottle of Super-Duper Hot Blue Pepper Sauce, coming right up! [EOA] 
        <audio src="https://koetest.s3.amazonaws.com/new_demo_stereo/findingThings1.mp3"/> 
        [Man]  
        Hmmm, where is it? [EOA] 
        <audio src="https://koetest.s3.amazonaws.com/new_demo_stereo/findingThings2.mp3"/> 
        [Kid]  
        Dad, didn't you just sell one to Mrs. Chilirosa yesterday? [EOA] 
        [Man]  
        Hmm, Oh yes, yes! I did sell one to her. [Short_Pause] Oh dear. I guess that's our last bottle in a while. Next batch is not coming in a week, and I need to drive all the way out of town to get it because they can't stand our stench! [EOA] 
        [Kid]  
        Stop murmuring, dad. [Short_Pause] Anyways, if you go ask Mrs. Chilirosa, she might still have some left for you.[EOA]
	*then
		-> One Bottle of Sauce 2

@One Bottle of Sauce 2
	*say
		Now you can leave the store, or ask more about Mrs. Chilirosa.
	*recap
		Now you can leave the store or ask more about Mrs. Chilirosa.
	*then
		hear leave the store, leave {
            -> Leave the Store
        }
        hear ask more, tell me more about, ask more about Mrs Chilirosa, Misses Chilirosa, she, where {
            -> Ask more about Chilirosa
        }

@Ask more about Chilirosa
	*say
		[Man] 
        She's a stubborn old lady who works at the hair salon down the street. Like the mayor, she also has a craving for spicy things. [EOA]
        [Kid] 
        Yeah! All my friends who visited her shop came out with hair that smelled spicy for days! [EOA]
        [Man] 
        But I know what she also likes. [Short_Pause] As funny as it may sound, she also likes roses. But I doubt you'll be finding any of them around. Not in this desert.[EOA]
        Now you can leave the store, or ask again
	*recap
		Now you can leave the store, or ask again
	*then
		hear leave the store, leave {
            -> Leave the Store
        }
        hear ask again, ask {
            -> Ask more about Chilirosa
        }

@Leave the Store
	*say
		Just as you are about to leave the store, the shopkeeper stops you.
        [Man]
        Wait wait. The desert is hot and wide. Don't want you to starve or get thirsty out there. Take these. [EOA]
        The shopkeeper gives you a big bread and a full canteen of water. They both look edible, but at the same time the stench attaches to them. 
        <audio src='https://koetest.s3.amazonaws.com/new_demo_stereo/doorOpen2.mp3'/>
        You step out of the store.
	*then
		set currentLocation as 'a cross'
		-> The Cross

@The Cross
	*say
		//[Action]
		There are a few things that you may want to check: A signpost, the mayor's office to your left, or you can go find the beauty salon.
	*then
		hear signpost, check the signpost, read the signpost {
		    set currentLocation as 'signpost'
            -> Signpost
        }
        hear mayor's office, check mayor's office {
            set currentLocation as 'mayors office'
            -> Mayor's Office
        }
        hear salon,beauty salon, go find the beauty salon, find the beauty salon {
            set currentLocation as 'outside of the beauty saloon'
            -> Beauty Salon
        }
	*recap
		[Action]There are a few things that you may want to check: A signpost, the mayor's office to your left, or you can go find the beauty salon.
	*reprompt
		[Action]There are a few things that you may want to check: A signpost, the mayor's office to your left, or you can go find the beauty salon.

@Signpost
	*say
		You come forward to the signpost across the lonely street. There are a few items on it. [Short_Pause] It reads: the right leads to the mayor's office, Chilirosa's Beauty Salon, and the Eastern exit of the town. You've also noticed that there are a few strings of ivy tangling around the signpost. They look surprisingly healthy.
	*then
		hear salon, beauty salon, go to beauty salon, go find the beauty salon {
		    set currentLocation as 'outside of the beauty saloon'
			-> Beauty Salon
		}
		hear Mayor's office, left, go to mayor's office,office {
		    set currentLocation as 'mayors office'
			-> Mayor's Office
		}
		hear signpost,check the signpost again, again, check again {
			-> Signpost
		}
	*recap
		There are a few other things that you may want to check:  the mayor's office to your left, beauty salon. Or you can check the signpost again.
	*reprompt
		There are a few other things that you may want to check:  the mayor's office to your left, beauty salon. Or you can check the signpost again.

@Mayor's Office
	*say
		You're at the mayor's office. The doors are shut tight, and they seem like their locked. Somehow with the stench, it also smells very spicy. Besides knocking on the door, the office is so big that you probably need to shout to get his attention. 
           Now you can: Knock, bash, or try to open the door, check out the trash can, or go to another location. [Action]
	*then
		hear knock {
            -> Knock On Mayor's Office
        }
        hear bash {
            -> Bash On Mayor's Office
        }
        hear check out the trash can, trash can {
            -> Check Out the Trash Can
        }
        hear go to another location, another location {
            set currentLocation as 'a cross'
            -> The Cross
        }

		hear go to scene Mayor's Office_1 {
			-> Mayor's Office_anotherlocation
		}

@Mayor's Office_anotherlocation
	*say
		There are a few other things that you may want to check: A signpost, or you can go find the beauty salon.
	*then	
		hear salon, beauty salon, go to beauty salon, go find the beauty salon {
	    	set currentLocation as 'outside of the beauty saloon'
			-> Beauty Salon
		}
		hear signpost, check the signpost, read the signpost {
		    set currentLocation as 'signpost'
            -> Signpost
        }

@Knock On Mayor's Office
	*say
		You knocked on the door, but nobody answers.
	*then
		-> Mayor's Office

@Bash On Mayor's Office
	*say
		You bashed heavily on the door, but nothing happened.
	*then
		-> Mayor's Office

@Check Out the Trash Can
	*say
		You checked out the trash can, but it's empty.
	*then
		-> Mayor's Office

@Beauty Salon
	*say
		You started walking towards the end of the street.

        Nothing but the sandy gusts of wind blow into your ears. No one is visible on the street. The buildings on the way look pretty modern, but they are all coated with a thick layer of dust. While you're on your way, you noticed something peculiar in the corner of one of the buildings. It's a patch of green.
        <audio src="https://koetest.s3.amazonaws.com/new_demo_stereo/footsteps2.mp3"/>
You're at the front door of the beauty salon. Looks like its doors are shut tight, but they don't look locked, and you hear the sounds of radio inside. Anyways, you should talk to her, but what should you do?
	*then
		unflag flower
	    unflag angry
		-> Arrive Beauty Salon

@Arrive Beauty Salon
	*say
		Now you can: Knock on the door, bash on the door, open the door directly, or check on the green patch before.[Action]
	*then
		hear knock, knock on the door {
		    set currentLocation as 'inside of the beaty saloon'
            -> Knock On Beauty Salon
        }
        hear bash, bash on the door {
            set currentLocation as 'inside of the beaty saloon'
            -> Bash On Beauty Salon
        }
		hear open the door directly {
			-> Open the Beauty Salon Directly
        }
        hear check the green patch before, green patch, check {
            -> check the Green Patch
        }
	*recap
		Now you can: Knock on the door, bash on the door, open the door directly, or check on the green patch before.[Action]
	*reprompt
		Now you can: Knock on the door, bash on the door, open the door directly, or check on the green patch before.[Action]

@Knock On Beauty Salon
	*say
		No one responds. Knock again or bash on the door?[Action]
	*recap
		You can try knock again or knock harder
	*then
		hear knock, knock again{
	        -> Knock On Beauty Salon 2
	    }
	    hear bash, know harder, bash on the door {
	        -> Bash On Beauty Salon
	    }

@Knock On Beauty Salon 2
	*say
		You hear a crank in the house, but still no response. [Action]
	*recap
		You can try knock again or knock harder.
	*then
		hear knock again, again {
            flag angry
            -> Chilirosa Annoyed
        }

@Chilirosa Annoyed
	*say
		<audio src='https://koetest.s3.amazonaws.com/new_demo_stereo/peopleWalkingFast.mp3'/>
        [MrsChilirosa]
        Yes? What do you want?[EOA] 
        <audio src='https://koetest.s3.amazonaws.com/new_demo_stereo/doorOpen2.mp3'/>
	*then
		if flower {
            unflag angry
            -> Meet Mrs Chilirosa with flower
        }
        -> Meet Mrs Chilirosa

@Chilirosa Angered
	*say
		<audio src='https://koetest.s3.amazonaws.com/new_demo_stereo/peopleWalkingFast.mp3'/>
        [MrsChilirosa]
        WHATTT? Show some manners![EOA] 
        <audio src='https://koetest.s3.amazonaws.com/new_demo_stereo/doorOpen2.mp3'/>
	*then
		if flower {
            unflag angry
            -> Meet Mrs Chilirosa with flower
        }
        -> Meet Mrs Chilirosa

@Bash On Beauty Salon
	*say
		You bashed on the door.
	*then
		flag angry
		-> Chilirosa Angered

@Meet Mrs Chilirosa with flower
	*say
		[MrsChilirosa]
        Oh, my! Is THAT for me?[EOA]
	*recap
		[MrsChilirosa]
        I believe it is for me, right?[EOA]
	*then
		hear yes, sure {
            -> Give Mrs Chilirosa the flower
        }
        hear no, nope {
            -> Chilirosa Bargains
        }

@Chilirosa Bargains
	*say
		[MrsChilirosa]
        Please, roses are very hard to find in this stinky town. I can pay you.[EOA] [Conversation]
	*then
		hear yes, sure {
            -> Give Mrs Chilirosa the flower
        }
        hear Hot Sauce {
            -> Chilirosa Give Hot Sauce
        }
        hear no, nope {
            flag angry
            -> Chilirosa No Rose Annoyed
        }

@Chilirosa No Rose Annoyed
	*say
		[MrsChilirosa]
        What do you want? If you have nothing else please leave. This town is already a skunk and I would appreciate if you close the door to stop the stinky air coming in.[EOA] 
        [Conversation] 
        Now you can ask about the hot sauce, or leave.
	*then
		hear ask about the hot sauce, the sauce, hot sauce {
            -> Ask about the Sauce
        }

@Give Mrs Chilirosa the flower
	*say
		[MrsChilirosa]
        Why, thank you, dear... 
        //What's your name? 
        [EOA]
        //<amazon:effect name="whispered">say your name!</amazon:effect>.
	*recap
		//maybe try a more common one?
	*reprompt
		//<amazon:effect name="whispered">say your name!</amazon:effect>.
	*then
		//slot playerName to 'AMAZON.US_FIRST_NAME'
		//hear {playerName}, my name is {playerName} {
			-> Answer Your Name
        //}

@Answer Your Name
	*say
		[MrsChilirosa]
        //Oh, thank you, dear {playerName}. 
        What can I give you in exchange? [EOA]
	*then
		-> Meet Mrs Chilirosa

@Meet Mrs Chilirosa
	*say
		[Conversation]Now, it's time to ask her about the sauce.
	*recap
		You can try to say "Ask about the sauce".
	*reprompt
		She is waiting for your response.
	*then
		hear ask about the sauce, the sauce, hot sauce {
            if angry{
                -> Ask about the Sauce 1
            }
            -> Ask about the Sauce
        }

@Ask about the Sauce 1
	*say
		[MrsChilirosa]
        yeah, what about it? You want it? [EOA]
        [Conversation]
	*then
		hear yes, sure {
            -> Ask about the Sauce
        }

@Ask about the Sauce
	*say
		[MrsChilirosa]
        Give me a reason why you need hot sauce. You want hot sauce because? [EOA]
        [Conversation] So we have two plans here: first plan, You tell her how you like the sauce. second plan. tell her that you need it to get the mayor's attention. Which plan you do you want to go?
	*recap
		We have two plans here: First one, make up a reason and lie. Second one, tell her that you need it to get the mayor's attention. Which plan you do you want to go?
	*then
		hear one, first, make up, reason, lie {
            -> Tell Mrs Chilirose you like the Sauce
        }
		hear two, second, tell her that I need it to get the mayor's attention, need {
			-> Tell Mrs Chilirose Honestly
        }
        
// todo

@Tell Mrs Chilirose you like the Sauce
	*say
		Ok. Now make up a good reason why you like the sauce. You can say the sentence start with [Pause]"My reason is"[LongPause]
	*then
		-> Tell Mrs Chilirose you like the Sauce 2

@Tell Mrs Chilirose you like the Sauce 2
	*say
		[MrsChilirosa]
        Hmmmm. [Short_Pause] Weird reason, but ok. [EOA]
        She gleefully hands over the hot sauce to you. You exit the building.
	*then
		-> Get the Hot Sauce

@Tell Mrs Chilirose Honestly
	*say
		[MrsChilirosa]
        Don't mention the mayor to me. He's been dominating all the hot sauce. but seeing that you're not a hot sauce, i guess you have a good reason to meet him. I'll give you half a bottle. [EOA]
	*then
		-> Chilirosa Give Hot Sauce

@Chilirosa Give Hot Sauce
	*say
		[MrsChilirosa]
        Here is the hot sauce, take it.[EOA]
        She hands over the hot sauce to you. You exit the building.
	*then
		set currentLocation as 'mayors office'
		-> Get the Hot Sauce

@Open the Beauty Salon Directly
	*say
		You tried to open the door directly, you entered! Nobody is here. On your right side, there is a door. Then you noticed that it's connected to Misses Chilirosa's house.
	*then
		-> chilirosa_steal_puzzle_start

@check the Green Patch
	*say
		You walk back to the patch of green sitting in the corner of a building. Oh dear, in a dry desert like this, you found a rose with a bright red color on it. You pick up the rose and hold it in your hand, and go back to Misses Chilirosa's house. Now you can: Knock on the door, bash on the door, or open the door directly. [Action]
	*then
		flag flower
		hear knock, knock on the door {
		    set currentLocation as 'inside of the beaty saloon'
            -> Knock On Beauty Salon
        }
        hear bash, bash on the door {
            set currentLocation as 'inside of the beaty saloon'
            -> Bash On Beauty Salon
        }
		hear open the door directly {
			-> Open the Beauty Salon Directly
        }
	*recap
		Now you can: Knock on the door, bash on the door, or open the door directly. [Action]
	*reprompt
		Now you can: Knock on the door, bash on the door, or open the door directly. [Action]

@Get the Hot Sauce
	*say
		You're at the mayor's office. The doors are shut tight, and they seem like their locked. Somehow with the stench, it also smells very spicy. Besides knocking on the door, the office is so big that you probably need to shout to get his attention. Do you want to wave to the window, or shout to the his attention?[Action]
	*reprompt
		Wave to the window? Or shout at the mayor?
	*recap
		Wave to the window? Or shout at the mayor?
	*then
		hear wave to the window, wave {
			-> Wave To the Window
        }
        hear shout, shout at the mayor {
            -> Shout At the Mayor
        }

Get the Hot Sauce 1

@Wave To the Window
	*say
		You knocked the door, but no-one responded. You need to make a bigger noise. [Action]
	*reprompt
		It seems that shout at the mayor is the only way to get his attention
	*recap
		It seems that shout at the mayor is the only way to get his attention
	*then
		hear shout, shout at the mayor {
	        -> Shout At the Mayor
	    }

@Shout At the Mayor
	*say
		Ok then. Shout something loud and clear so that the mayor can hear you. Now let's shout![Conversation]
	*recap
		Seems like he is not interested in what you said. Shout something else? maybe mention that you have the super duper hot pepper sauce? [Conversation]
	*reprompt
		Ok then. Shout something loud and clear so that the mayor can hear you. Now let's shout![Conversation]
	*then
		hear super duper hot blue pepper sauce, sauce, hot , pepper, super duper, hot sauce, pepper sauce {
			-> Shout At the Mayor_1
		}

@Shout At the Mayor_1
	*say
		[Mayor]
        Oh, thank you for bringing me the hot sauce. What brings you here?[EOA] [Conversation]
	*then
		hear smell, incident, help, yes, right {
			-> Mayor Talks More About the Incident
		}
		hear who are you{
		    -> Mayor Self Introduction
		}
	*recap
		You come here because you need more information on the smell. right?
	*reprompt
		Wait, you come here because you need more information on the smell. right?

@Mayor Talks More About the Incident
	*say
		[Mayor]
        Yes. There is a cave that we know to the Eastern valleys, but all we know is that the cave is guarded by puzzles and challenges. But what's beyond that nobody knows.you can ask about: the cave, puzzles, eastern valleys, the town, or leave to the cave[EOA]
	*reprompt
		you can ask about: the cave, puzzles, eastern valleys, the town, or leave to the cave
	*then
		hear cave, about the cave {
            -> Ask Mayor The Cave
        }
        hear puzzles, challenges {
            -> Ask Mayor Challenges
        }
        hear valleys, eastern valleys {
            -> Ask Mayor the valleys
        }
        hear town, about the town {
            -> Ask Mayor The Town
        }
        hear leave, leave to the cave {
            -> Leave the Cave
        }

@Ask Mayor the valleys
	*say
		[Mayor]
        The Eastern valleys is a long way from here. You better bring food and water. Or else you'll not make it.[EOA]
	*then
		>> BACK

@Ask Mayor Challenges
	*say
		[Mayor]
        We sent our best guys into the cave. [Short_Pause] All they could remember when they returned was they were lost in a forest.[EOA]
	*then
		>> BACK

@Mayor Self Introduction
	*say
		[Mayor]
        I'm the Mayor. [EOA]
	*then
		>> BACK

//not using

@Agree to Help the Mayor
	*say
		[Mayor]Wait. [Short_Pause] Are you saying that you're willing to help us get rid of this disgusting smell? Oh please, sit down, sit down[EOA]

        You sit down on the old couch in the mayor's office. The couch releases a spicy smell that stings.  
      
    [Mayor]
        So, the legend out there says there's a precious gem hidden in the valleys to the East, and that the precious gem is the key ingredient to lifting the curse.[EOA]
        //<audio src="https://koetest.s3.amazonaws.com/new_demo_stereo/windBlowing2.mp3"/> 

    [Mayor]    that the don't know, is that the cavern is guarded by puzzles and challenges. But what's beyond that- nobody knows. Nobody remembers[EOA]
	*then
		unflag cave
	    unflag town
		-> Ask the Mayor

//not using

@Ask the Mayor
	*say
		[Conversation]You can ask about how he knows all this, about the cave, or about the town itself.
	*recap
		Well, the options are: A. ask about how he knows all this; B. ask about the cave; C. ask about the town it self.
	*then
		hear A, a, how he knows all this, all this {
			-> Ask Mayor How He knows
        }
        hear B, b, about the cave, cave {
            -> Ask Mayor The Cave
        }
        hear C, c, about the town, town {
            -> Ask Mayor The Town
        }

//not using

@Ask Mayor How He knows
	*say
		[Mayor]
        A while ago we sent our best people to go and retrieve the stone. When they returned, they were covered in smell even nastier than what we have in the town. But what's worse was that they could barely remember anything. The doctor said that probably the smell was too unbearable that they passed out at some point and lost all the memory. This is all they could remember.[EOA]
	*then
		>> BACK

@Ask Mayor The Cave
	*say
		[Mayor]
        Strangely, some plant roots lead into the cave.[EOA]
	*then
		>> BACK

@Ask Mayor The Town
	*say
		[Mayor]
        The town has a story. I think it's the alchemist who did it.[EOA]
	*then
		>> BACK

//not using

@Continue Ask Mayor The Town
	*say
		[mayor]
        Speaking of which, [Short_Pause] this reminds me of a character, [Short_Pause] yes, quite a character in our town. [EOA]
        The mayor pauses to sip a cup of water. He also spreads some of the hot sauce on his nose. 
        [Mayor] 
        We had this guy who worked in one of the most famous Shawarma places in town. Everything was normal except he sweats a lot, and a lot. It's like he wasn't born for the desert. [EOA]
        The hot sauce made the mayor to sweat a little bit, as he tries to wipe of some of them from his cheeks.
        [Mayor]
        But it doesn't just stop there. Oh dear, he has this odor. It was offending the guests. A great embarrassment. [EOA]
        The mayor leans back and waves his hands while he talks. 
        [Mayor] So, in the end, we had to make him leave. That's just a story. I don't know if anyone has hired him again, but that was just some time before this smell found its way into the town. [EOA]
	*then
		flag town
        -> Ask the Mayor

//not using

@Before Leave For the Cave
	*say
		and you can also heave for the cave.[Action]
	*recap
		Well, the options are: A. leave for the cave; B. ask mayor about something else
	*then
		hear A, a, leave, leave for the cave {
            -> Leave the Cave
        }
        hear B, b, ask, ask mayor about something else, something else {
            -> Ask Mayor The Cave
        }

@Leave the Cave
	*say
		[Mayor]
        I hope that these information are useful to you. We're all looking forward to seeing the town coming back to life some day. Good luck! [EOA]
        You leave the mayor's office, back on to the streets. The shopkeeper stands outside.
        [Man]
        are you leaving? bring some of these with you. If you're ready, the horse over there is ready for you; but if you are tired. take some rest. Would you like to leave or take some rest?[EOA]
	*then
		hear rest, take some rest {
	        >>END
	    }
	    hear ready,leave {
	        -> Been Walking For Days
	    }

@Been Walking For Days
	*say
		You've been walking for days, but still no sign of valleys, only desert. <audio src='https://koetest.s3.amazonaws.com/Act3/horseNeighing_01.mp3'/> It's been a couple of days since you left the town. Although having a horse to carry you across the wilderness is fortunate, but now it seems very tired as well. [Pause]<audio src='https://koetest.s3.amazonaws.com/Act3/smallWind_01.mp3'/> Your vision starts to get blurry again. Strangely, this blurriness seemed a bit, a bit yellow. You tried to muster your consciousness, only to find out that you're heading in to an inevitable sandstorm.<audio src='https://koetest.s3.amazonaws.com/Act3/strongWinds_01.mp3'/> As unwilling as you may be, this is the only way to the Eastern Valleys. You ride into the furious sandstorm. [Pause] 
		
		But soon, the sandstorm has devoured you into the yellow fog. The wind is so strong an unbearable that you couldn't go on anymore. You slowly close your eyes. 
		
		[SeedTrader]
	    Wake up! Wake up! Don't fall asleep! [EOA]
	    
	    A faint sound reaches your ear amidst the noise of the storm.
	    
	    [SeedTrader]
	    We're getting out now, so don't fall on me! [EOA]
        
        You feel like you were being carried onto a bed, so you close your eyes and let yourself drift away.
	*then
	-> cowplant_puzzle_start

@Waking Up In An Empty Tent
	*say
		You wake up finding yourself in a tent. The sunlight sprinkles on your face through the small holes in the ceiling. As you slowly gain consciousness, you hear a strange noise coming from outside.

	*then
		hear look around, around {
            -> Details of the Tent
        }
        hear leave, leave the tent {
            -> Leave the Tent
        }

@Details of the Tent
	*say
		It's a tent with many vials and plants.
	*then
		>> BACK

@Leave the Tent
	*say
		You're still in the desert. Beside the tent there is a mysterious plant wobbling around, and it's chewing a person. You can also hear someone yelling for help from the plant.
	*then
		hear check if there is anything I can throw, throw {
            -> Look Around
        }
        hear What is the thing, examine the thing {
            -> Examine the Thing
        }
        hear Help the person, help him {
            -> Help the Person
        }
        hear Leave {
            -> Warning to Leave
        }

@Look Around
	*say
		You looked around. But found nothing.
	*then
		>> BACK

@Warning to Leave
	*say
		[SeedTrader]
        I know why you're here, you need me! Don't leave me in this cowplant. [EOA]
        Are you sure you want to leave the man? Maybe we need to help him out.
	*then
		>> BACK

@Examine the Thing
	*say
		It looks like a cow's head, but it has sharp teeth.
	*then
		>> BACK

@Help the Person
	*say
		[SeedTrader]
        Is someone there? [Short_Pause] Thank God! You need to save me from this cowplant. [EOA]
	*then
		hear how, how to save {
            -> MysMan Explains
        }
        -> MysMan Explains

@MysMan Explains
	*say
		[SeedTrader]
        You need to milk the cowplant. [EOA]
	*then
		hear milk, milk the cowplant {  
            -> MysMan Saved
        }

@MysMan Saved
	*say
		[SeedTrader]
        Thanks.  
        //What's your name? 
        [EOA]
	*then
		//slot playerName__ to 'AMAZON.US_FIRST_NAME'
        
        //hear {playerName__}, my name is {playerName__} {
        //}

@MysMan Introduces Himself
	*say
		[SeedTrader]
        my name is Luke, nothing but a humble merchant in the desert. I sell seeds and plants. I also sell other fascinating little gimmicks that be found nowhere else but in my awesome tent. [EOA]
        
        Luke looks at the sun for a bit.
        
        [SeedTrader]
        The sun sure is hot. Let's head back in to the tent first.[Pause] [EOA]
    
        You hesitated a little because you still have to find your way to the cave. You still followed him.
        
        [SeedTrader]
        Hmm. That wasn't very clever for you to travel through the sandstorm like that. You may have become a part of the desert, you know. [EOA]
        
        As he enters the tent, he jumps into the center of tent, like a graceful dancer.
        
        You are inside Luke's tent. There is a giant brown seed on the table beside you. 

        
        [SeedTrader]
        //Welcome, to Luke's tent of peculiar collections. 
        //Would you be interested in any of the items I have? 
        //Would you be interested in a seed that grows nothing but more seeds? 
        [EOA]
        
        //Don't forget, you need to get to the cave, fast. 
        //What should you ask?
        
	*then
		unflag anotherItem
        unflag plot12
        unflag plot3
        unflag plot4
        -> MysMan Introduces Himself 2

@MysMan Introduces Himself 2
	*say
		//[SeedTrader]
        //This is a seed that grows more seeds. Would you like to know how it works? [EOA]
        
        You can ask more about the seed or ask how to get to the cave. You can also thank him and leave.
        
	*reprompt
        You can ask more about the seed or ask how to get to the cave. You can also thank him and leave.[Conversation]
	*then
		hear seed, tell me more about the seed {
            -> More About the Seed
        }
        hear thank him and leave, no, leave {
            -> MysMan Says Wait
        }
        hear how to get to the cave, the cave, cave {
            -> Another Item
        }

@More About the Seed
	*say
	    [SeedTrader]
		Ah, yes. This is a seed that makes more seeds. No plant roots, no flowers, just... seeds! I personally use it for seasoning. A great match for all dishes, even junk food. [EOA]
		
		//Luke eagerly waits for your response.

	*then
		>> BACK

@MysMan Says Wait
	*say
		[SeedTrader]
        Wait, wait, wait! What did I miss? [EOA]
	*then
		if anotherItem{
            -> Next Item
        }
        -> Another Item

@Another Item
	*say
		[SeedTrader]
        Uh, how about this? This is a plant that glows in the day! [EOA]
       
        He takes out a small flower that glows strongly in the tent. 
        
        You can ask more about the flower or ask how to get to the cave. You can also thank him and leave.[Conversation]
       
    *reprompt
        You can ask more about the flower or ask how to get to the cave. You can also thank him and leave.
        
	*then
		flag anotherItem
        hear ask more about the flower, tell me more, more, flower, tell me more about the flower {
            -> More About the Glowing Plant
        }
        hear about the cave, the cave {
            -> Next Item
        }
        hear go, leave, thank him and leave, leave {
            -> MysMan Says Wait
        }

@More About the Glowing Plant
	*say
	    [SeedTrader]
		Ha! Glad that you've asked. This plant is a tremendous existence in our world. It glows when there's sunlight. If there is no sun, it doesn't glow! Ha! [EOA]
		
		You can ask how to get to the cave. You can also thank him and leave.[Conversation]
		
	*reprompt
	    You can ask how to get to the cave. You can also thank him and leave.
	*then
		hear how to get to the cave, about the cave, the cave {
            -> Next Item
        }
        hear leave, thank him and leave {
            -> MysMan Says Wait
        }

@Next Item
	*say
	    Strangely, Luke starts to panic. He goes through all of his inventory, again and again. Then, he picks up a glass vial that was immediately in front of him before.
		
		[SeedTrader]
        There! Found you. This, oh my dear, is a rare find out here in the desert. This, is a stinky plant. [EOA]
    
        He seems really unsettled, but not because of the plant he's holding up to you. [Conversation]
    *reprompt
	    You can ask how to get to the cave. You can also thank him and leave.
	*then
		hear about the cave {
            -> MysMan Says Stop
        }
        hear leave {
            -> MysMan Says Wait I Know
        }
        hear more about the plant, the plant {
            -> MysMan Spills the Tea
        }

@MysMan Says Stop
	*say
		[SeedTrader]
        Stop! Stop asking me how to get to the cave! Can you not see me trying to avoid your question? How can you be so stupid? [EOA]

        As soon as the word stupid comes out of his mouth, he immediately knows that he said something that he shouldn't have.

        [SeedTrader]
        I'm sorry. It's just that I've waited so long for someone to come and ask me about the cave. I'm sorry. [EOA]
        
	*then
		hear it's OK, OK, alright, fine {
            -> MysMan Story
        }

@MysMan Story
	*say
		[SeedTrader]
        It all happened a long time ago. Do you know why the town was cursed? [EOA]
        
	*then
		hear yes {
            -> MysMan Story Plot 1
        }
        hear no {
            -> MysMan Story Plot 2
        }

@MysMan Story Plot 1
	*say
		[SeedTrader]
        So you've heard what the townsfolk and the mayor had to say. Well, they never mentioned to you about me, did they? [EOA] 
        
        Luke looks away into the holes in the tent.
        
        [SeedTrader]
        They say that it was the alchemist that was responsible for the curse. First of all, it wasn't a curse. It's merely an experiment gone wrong. We were trying to transform the smell of the stinky plant into something enjoyable. But instead, it went wrong. [EOA]
        
        Luke picks up the bottle with the stinky plant sealed within, and stares into it.
        
        [SeedTrader]
        The failed potion accidentally went into the soil and contaminated the land. That's how the stench got to everyone.
        
        He sighs and puts down the bottle.
        
        [SeedTrader]
        But that wasn't all. I wasn't thinking properly. I knew that the townsfolk will be angry at us, and I was afraid. I wasn't prepared to take the blame, so I went out and told the townsfolk all about it. I told that it was the alchemist's fault. I thought that would make me feel safer from the anger of these people. [EOA]
        
        The wind blows a little bit outside the tent. Luke holds his hands together and covers his face.
        
        [SeedTrader]
        The next thing I know was that when I came back, the alchemist was being yelled at, and banished from the town. 
        
        He breathes sharply, as if he's trying to get himself together.
        
        [SeedTrader]
        Well. I left the town soon after. Looking at his old place every day like that, it's just not possible. [EOA]
        
        Luke musters his strength and stands up, then look back at you.

	*then
		flag plot12
		-> Luke Explains the Cave

@Luke Explains the Cave
	*say
		[SeedTrader]
        The cave is guarded by a thick forest. You're probably wondering how a forest could grow in the middle of the desert. Well, the alchemist is an expert in botany. His knowledge allows him to grow anything anywhere, even in the desert. [EOA]
        
        //(Sound Effect: Going through shelves)
        <audio src='https://koetest.s3.amazonaws.com/Act3/goingThroughShelves_01.mp3'/>
        Luke goes through his shelf of specimens for a second, and returns with a compass, a small bottle of potion, and a vial of a small, but beautiful flower. Carefully, he uncovers the vial.
        
        [SeedTrader]
        Anyways, the forest is a maze. If you make the wrong turn, you'll get lost. This is where the leading flower comes in to play. [EOA]
        
        He holds up the flower.
        
        [SeedTrader]
        This flower tells directions. As long as you give it a clear destination, it will lead you to it accurately and timely. Here, hold these two for me, will you? [EOA]
        
        Luke then hands over the flower and the compass to you. Suddenly, with an exaggerating pose, Luke throws the potion into the air. But instead, the potion only traveled for a second or two before it landed. The potion breaks. Magically, a garden surrounded by bushes appears in the middle of nothing.
        
        [SeedTrader]
        Now. You will use this flower and guide yourself to garden, which is in the center of this maze. First, say to the flower [Pause] "Lead me to the garden." [EOA]
	*recap
		Try to say, lead me to the garden.
	*reprompt
	    Try to say, lead me to the garden.
	*then
	    hear lead me to the garden{
	    	-> leading_start
	    }

@MysMan Story Plot 2
	*say
		[SeedTrader]
        So you've heard what the townsfolk and the mayor had to say. Well, they never mentioned to you about me, did they? [EOA]
        
        Luke away into the holes in the ceiling. 
        
        [SeedTrader]
        They say that it was the alchemist who was responsible for the incident. And they were right, except for one spot: I was beside him when it took place. [EOA]
        
        Luke strokes his chin for a bit.
        [SeedTrader]
        It was merely an accident. We were experimenting with the stinky plant and see if its unbearable smell can become an extraordinary perfume. [EOA]
        
        Luke picks up the bottle with the plant sealed in.
        
        //(Sound Effect: Sigh)
        <audio src='https://koetest.s3.amazonaws.com/Act3/sigh_01.mp3'/>
        [SeedTrader]
        I knew that it was going to fail, but he disagreed. We had a big fight, and I left the lab for the night. The next thing I know, is that the town was flooded with the flower's smell, and the townsfolk were angry at the alchemist. In the end, they drove him away. [EOA]

        Luke pauses for a while, as if he was trying to talk to himself in his head.

        [SeedTrader]
        If I had been there to stop him, none of this would've happened. It was my fault. [EOA]

        Luke then puts the plant back on the table.
        
        [SeedTrader]
        I know why you're here. You came from the town, didn't you? You're here for the cave, where the alchemist resides. I can tell you about the puzzles in the cave.
        
	*then
		flag plot12
		-> Luke Explains the Cave

@One Last Thing
	*say
		[SeedTrader]
		That's pretty much it. Oh. Wait. [EOA]

		Luke goes to a locked chest and retrieves a purple seed.

		[SeedTrader]
		There's another thing about the citrine that you're looking for. The antidote cannot be made without this other ingredient. He probably doesn't know this yet, since he has never left the cave. [EOA]

		Luke hands the seed to you.
		
		[SeedTrader]
		Here, take it. After all I've done to him, I don't think I'm ready to confront him yet. Bring this seed to him for me. [EOA]
		
		Luke walks to the entrance and sticks his head out.

		[SeedTrader]
		The day is not young. You must go before the sandstorm comes and catch you again. Or if you want to, you can stay here for a while to wait for the storm to leave. [EOA]

		You can pause your journey and take some rest here, or you can continue and hurry to the cave. Would you like to leave for the cave? [Action]
	
	*reprompt
		Luke has handed you a purple seed that is crucial to producing the antidote. Now you may choose to pause your journey and take some rest here, or you may leave and continue to the cave. Would you like to leave for the cave? 
	*recap 
		You may choose to pause, or leave and continue to the cave. Would you like to leave for the cave?
	*then
		flag plot12
		hear yes, leave for the cave, continue {
            -> End of ACT III, 1&2
        }
        hear no, puase, rest {
            -> Quit Game
        }

@End of ACT III, 1&2
	*say
		//(Sound Effect: Horse Neighing)
		
		[SeedTrader]
		Very well then. Keep riding to the East. The valley is close. Follow the plant roots and you will reach the cave eventually. [EOA]

		Both of you walk slowly outside the tent. It looks like Luke has something to tell you, but he's trying to keep it to himself.

		[SeedTrader]
		Hey, [EOA]

		As you make yourself comfortable on the saddle, Luke calls you.

		[SeedTrader] 
		When you do meet the alchemist, tell him I'm sorry, will you? [EOA]

		He then gives your horse a big slap. The horse charges into the East, leaving Luke behind in the desert.

	*then
		-> End of ACT III, all

@MysMan Says Wait I Know
	*say
		Just as you're about to leave, Luke grabs your hand and stops you from leaving.

        [SeedTrader]
        Wait! Stop! You can't leave. If you leave, you won't make it to the cave. [EOA]
        
        He looks at you with determined eyes.

        [SeedTrader]
        Yes. I know why you're here. You're here because you need to get to the cave. You're here because you needed the citrine to lift the curse. And I'm the only one who knows how. [EOA]

        How did he know that you're going to the cave? And what does he know about it? You may want to ask him.

    *reprompt 
        Luke seems to know that you're going to the cave, and he knows something about it. You may want ask him.
	*then
		hear how did you know, how {
            -> Luke Explains How He Knows
        }
        hear cave, about the cave {
			flag plot3
            -> Luke Explains the Cave
        }

@Luke Explains How He Knows
	*say
		[SeedTrader]
        When I first met you, you still had that stinky smell that I could recognize anywhere. You came from the West, and there's only one reason for anyone to travel this far in the desert for a cave they've never heard before. I know all of this, because I was a part of the story. [EOA]
	*then
		-> Luke Explains Plot 3

@Luke Explains Plot 3
	*say
		[SeedTrader]
        I learned from the townsfolk that the curse was caused by an alchemist. I am also an alchemist, hence all these vials and bottles I carry; but any alchemist would know that a curse is not something that we would do. [EOA]
        
        Luke let's go of your hand. 
        
        [SeedTrader]
        Oh, I'm sorry. Anyways, as a fellow alchemist, I've been searching for ingredients that might help alleviate the situation. From time to time I've traveled back to the town and asked for any clues or information about the alchemist. [EOA]
        
        Luke then goes through the piles of notes on the ground and retrieves a black little book.
        
        [SeedTrader]
        From the information I gathered regarding the alchemist, the cave and what-not, I think I have a good guess on a challenge that lies in the cave.
        
    *reprompt
        Luke reveals that he is also an alchemist, volunteered to help with the cause whenever he can. He also knows what challenge is in the cave, which you might want to ask?

    *recap
        Luke looks confused and didn't understand. You might want to ask about the challenge in the cave.
        
	*then
		hear why, why don't you go {
            -> Luke Explains Why He Can't Go plot 3
        }
        hear what are the puzzles, the puzzles {
			flag plot3
            -> Luke Explains the Cave
        }

@Luke Explains Why He Can't Go plot 3
	*say
		[SeedTrader]
        I wanted to go, but I have my own business to look after. Living in the desert is not something particularly easy, you know? On the other hand, you are going, and I can tell you about the challenges, so let's get to it?[EOA] [Pause]
	*then
		hear what are the puzzles, the puzzles {
		    flag plot3
            -> Luke Explains the Cave
        }

@One More Thing Plot 3
	*say
		[SeedTrader]
        Oh, by the way. [EOA]
        
        Luke goes to an old wooden chest and takes out a purple seed.

        [SeedTrader]
        This is what you'll need for the antidote. It's called the Eureka seed. The townsfolk may have told you that the citrine is the key ingredient, but they were only half-right. Only combining the citrine and the Eureka seed can one brew a successful antidote. Take it with you. [EOA]
        
        Luke walks to the entrance and sticks his head out.

        [SeedTrader]
        The day is not young. You must go before the sandstorm comes and catch you again. Or if you want to, you can stay here for a while to wait for the storm to leave. [EOA]
        
        You can pause your journey and take some rest here, or you can continue and hurry to the cave. Would you like to leave for the cave?
    *reprompt
        uke has handed you a purple seed that is crucial to producing the antidote. Now you may choose to pause your journey and take some rest here, or you may leave and continue to the cave. Would you like to leave for the cave? 
        
    *recap 
        You may choose to pause, or leave and continue to the cave. Would you like to leave for the cave?
        
	*then
		flag plot3
        hear yes, leave for the cave, continue {
            -> End of ACT III, 3
        }
        hear no, puase, rest {
            -> Quit Game
        }

@End of ACT III, 3
	*say
		//(Sound Effect: Horse Neighing)
		<audio src='https://koetest.s3.amazonaws.com/Act3/horseNeighing_01.mp3'/>
        [SeedTrader]
		Very well then. Keep riding to the East. The valley is close. Follow the plant roots and you will reach the cave eventually. Both of you walk slowly outside the tent. [EOA]
		
		It looks like Luke has something to tell you, but he's trying to keep it to himself.
		
		[SeedTrader]
		Hey! [EOA]
		
		As you make yourself comfortable on the saddle, Luke calls you.

		[SeedTrader]
		If you do meet the alchemist in the end, I would imagine that he demanded the name of this seed. You know, alchemists are all alike, can't trust anything unless they know what it is. Make sure you tell him the name, won't you? [EOA]
		
		He then gives your horse a big slap. The horse charges into the East, leaving Luke behind in the desert.
	*then
		-> End of ACT III, all

@MysMan Spills the Tea
	*say
		[SeedTrader]
		Yes, this stinky plant emits a funny and unsettling smell. So unsettling that it can [Pause] it can [Pause] pollute the water. [EOA]

		//(Sound Effect, cloth flapping in the blowing wind)

		Luke silences for a long 3 seconds. All you can hear is the wind and the tent flapping in the wind. He doesn't look right. Is he ok?
		
	*then
		hear what happened, tell me more {
            -> Mysman Tells the Story Plot 4
        }

@Mysman Tells the Story Plot 4
	*say
		[SeedTrader]
		It's nothing. [EOA]

		Luke smirks a bit.

		[SeedTrader]
		Some time ago, a friend of mine was experimenting with this plant. [EOA]
		
		Luke points to the vial of stinky plant.

		[SeedTrader]
		He believes that he can turn this unpleasant smell into something lovable and out of this world. But he failed, very hard. The scent became so bad that he had to abandon his lab. [EOA]
		
		Luke looks to the ground for a bit, then turns away from you.

		[SeedTrader]
		That's the last time I heard from him. 
		//(Sound Effect: Your turn) (DOES NOT WAIT FOR RESPONSE)

		Before you could ask any questions, he presses on with the conversation.

		[SeedTrader]
		You, on the other hand. [Pause] I know what you want. Yes. You want to go to the cave, don't you? Some town in the west needs your help. I've heard travelers here and there trying to get into the cave, and I've seen it myself too. I know that a challenge awaits you in the cave. 
		
		//(Sound Effect: Your turn)

		*reprompt
		Luke tells you that the stinky plant reminded him of a friend who experimented with it, but ended up miserably. Then, he mentions a challenge that awaits you in the cave. You may want to ask him more on that.
		
		*recap
		Luke squints his eyes and puts his ears closer to you, like he didn't understand. You might want to ask him more about the challenge?

	*then
		hear what is the puzzle, tell me more, the puzzle {
			flag plot4
            -> Luke Explains the Cave
        }
        hear why didn't you enter the cave, why, you {
            -> Luke Explains Why He Can't Go plot 4
        }

@Luke Explains Why He Can't Go plot 4
	*say
		[SeedTrader]
        Why I can't go? Well, as you can see how I ended up with that cowplant out there, I'm not the physical type. [EOA]

	*then
		hear what is the puzzle, the puzzles, the puzzle {
			flag plot4
            -> Luke Explains the Cave
        }

@One Last Thing Plot 4
	*say
		[SeedTrader]
		Oh, almost forgot. [EOA]

		Luke heads under his bed and pulls out an old chest. In it he takes out a vial that contains a purple seed.

		[SeedTrader]
		I've been also researching on how to get rid of this mess. It seems like besides the Citrine, you would also need this seed to make the antidote. [EOA]
		
		Luke hands over the vial to you.
		
		[SeedTrader]
		This is the Eureka seed. Take it with you. You'll need it. [EOA]

		Luke walks to the entrance and sticks his head out.
		
		[SeedTrader]
		The day is not young. You must go before the sandstorm comes and catch you again. Or if you want to, you can stay here for a while to wait for the storm to leave. [EOA]

		You can pause your journey and take some rest here, or you can continue and hurry to the cave. Would you like to leave for the cave?

	*reprompt
		Luke has handed you a purple seed that is crucial to producing the antidote. Now you may choose to pause your journey and take some rest here, or you may leave and continue to the cave. Would you like to leave for the cave?

	*recap
		You may choose to pause, or leave and continue to the cave. Would you like to leave for the cave?
	*then
		flag plot4
		hear yes, leave for the cave, continue {
            -> End of ACT III, 4
        }
        hear no, puase, rest {
            -> Quit Game
        }

@End of ACT III, 4
	*say
		//(Sound Effect: Horse Neighing)
		[SeedTrader]
		Very well then. Keep riding to the East. The valley is close. Follow the plant roots and you will reach the cave eventually. [EOA]
		
		Both of you walk slowly outside the tent. It looks like Luke has something to tell you, but he's trying to keep it to himself.

		[SeedTrader]
		Hey, [EOA]

		As you make yourself comfortable on the saddle, Luke calls you.

		[SeedTrader]
		Good luck. I hope you find the solution and restore it to its former glory. [EOA]

		He then gives your horse a big slap. The horse charges into the East, leaving Luke behind in the desert.

	*then
		-> End of ACT III, all

@End of ACT III, all
	*then
		-> leading_puzzle_start

@global append
	*then
		hear restart, start over {
            >> RESTART
        }
        //hear jump to saloon {
        //    -> Leave the Store
        //}
        hear get the hot sauce, I have your sauce, I have the hot sauce {
            set currentLocation as 'Mayors Office'
            -> Get the Hot Sauce
        }
        hear where am I, current location, tell me my location {
            -> Where am I
        }
        hear help {
            -> Help
        }
        //hear enter puzzle {
        //    -> PuzzleDemoStart
        //}
        //hear puzzle hint, hint {
        //   -> puzzle_help
        //}
		hear test audio {
			-> Test Audio
		}

		hear jump {
			-> jumpto
		}

@jumpto
	*say
		Do you want to jump to puzzle or act?
	*then
	    hear act{
	        -> jumptoact
	    }
	    hear puzzle{
	        -> jumptopuzzle
	    }
@jumptoact
	*say
		which act
	*then
	    hear two{
	        -> The Cross
	    }
	    hear three{
	        -> MysMan Introduces Himself
	    }
	    hear four{
	        -> leading_puzzle_start
	    }
	    hear five{
	        -> Arrival At The Inner Cave
	    }
@jumptopuzzle
	*say
		which puzzle
	*then
	    hear hot sauce{
	        -> Open the Beauty Salon Directly
	    }
	    hear cow plant{
	        -> Been Walking For Days
	    }
	    hear leading flower{
	        -> leading_puzzle_start
	    }
	    hear escape room{
	        -> Escape The Room
	    }

@Test Audio
	*say
		ACT 5 puzzle test start [Pause]
		1 <audio src='https://koetest.s3.amazonaws.com/Act3/Act3+puzzle/radio.mp3'/>
		1 <audio src='https://koetest.s3.amazonaws.com/Act5/Act+5+puzzle/closebook_01.mp3'/>
		1 <audio src='https://koetest.s3.amazonaws.com/Act5/Act+5+puzzle/ice_01.mp3'/>
		1 <audio src='https://koetest.s3.amazonaws.com/Act5/Act+5+puzzle/metalcrack_01.mp3'/>
		1 <audio src='https://koetest.s3.amazonaws.com/Act5/Act+5+puzzle/newspaper_01.mp3'/>

	// 	ACT 3 test start
	// 	1  <audio src='https://koetest.s3.amazonaws.com/Act3/aPersonThrowingHimself_01.mp3'/>
	// 	2  <audio src='https://koetest.s3.amazonaws.com/Act3/clothFlapping_01.mp3'/>
	// 	3  <audio src='https://koetest.s3.amazonaws.com/Act3/cowHappy.mp3'/>
	// 	4  <audio src='https://koetest.s3.amazonaws.com/Act3/cowplantSounds_01.mp3'/>
	// 	5  <audio src='https://koetest.s3.amazonaws.com/Act3/cowplantThrowOut.mp3'/>
	*then
		hear continue {
		    -> TA2
	    }

@TA2
	*say
		
		1 <audio src='https://koetest.s3.amazonaws.com/Act5/Act+5+puzzle/openbook_01.mp3'/>
		1 <audio src='https://koetest.s3.amazonaws.com/Act5/Act+5+puzzle/portalopen_01.mp3'/>
		1 <audio src='https://koetest.s3.amazonaws.com/Act5/Act+5+puzzle/portaltravel_01.mp3'/>

		that's the end of ACT 5 puzzle sound test
		// 6  <audio src='https://koetest.s3.amazonaws.com/Act3/footstepsInSand_01.mp3'/>
		// 7  <audio src='https://koetest.s3.amazonaws.com/Act3/goingThroughShelves_01.mp3'/>
		// 8  <audio src='https://koetest.s3.amazonaws.com/Act3/handSmacking_01.mp3'/>
		// 9  <audio src='https://koetest.s3.amazonaws.com/Act3/horseNeighing_01.mp3'/>
		// 10  <audio src='https://koetest.s3.amazonaws.com/Act3/manscream_01.mp3'/>
		
	*then 
		hear continue {
			-> TA3
		}
@TA3
	*say
		11  <audio src='https://koetest.s3.amazonaws.com/Act3/milkingCowplant.mp3'/>
		12  <audio src='https://koetest.s3.amazonaws.com/Act3/sigh_01.mp3'/>
		13  <audio src='https://koetest.s3.amazonaws.com/Act3/smallWind_01.mp3'/>
		14  <audio src='https://koetest.s3.amazonaws.com/Act3/strongWinds_01.mp3'/>
		
		ACT 5 test start
		1  <audio src='https://koetest.s3.amazonaws.com/Act5/OasisAmbience.mp3'/>
		
	*then 
		hear continue {
			-> TA4
		}

@TA4
	*say
		2  <audio src='https://koetest.s3.amazonaws.com/Act5/PouringRain.mp3'/>
		3  <audio src='https://koetest.s3.amazonaws.com/Act5/PouringRain02.mp3'/>
		4  <audio src='https://koetest.s3.amazonaws.com/Act5/VinGrowing.mp3'/>
		5  <audio src='https://koetest.s3.amazonaws.com/Act5/explode01.mp3'/>
		6  <audio src='https://koetest.s3.amazonaws.com/Act5/explode02.mp3'/>
		
	*then
		hear continue {
			-> TA5
		}

@TA5
	*say	
		7  <audio src='https://koetest.s3.amazonaws.com/Act5/magicSound01.mp3'/>
		8  <audio src='https://koetest.s3.amazonaws.com/Act5/magicSound03.mp3'/>
		// 9  <audio src='https://koetest.s3.amazonaws.com/Act5/magicSound02.mp3'/>
		10  <audio src='https://koetest.s3.amazonaws.com/Act5/malecry01.mp3'/>
		11  <audio src='https://koetest.s3.amazonaws.com/Act5/malecry02.mp3'/>
		12  <audio src='https://koetest.s3.amazonaws.com/Act5/walkOnDirt.mp3'/>
		
	*then
		hear continue {
			-> TA6
		}

@TA6
	*say
		13  <audio src='https://koetest.s3.amazonaws.com/Act5/waterdrop2.mp3'/>
		action test
		1 <audio src='https://koetest.s3.amazonaws.com/actionsounds/as01.mp3'/>
		2 <audio src='https://koetest.s3.amazonaws.com/actionsounds/as02.mp3'/>
		3 <audio src='https://koetest.s3.amazonaws.com/actionsounds/as03.mp3'/>
		4 <audio src='https://koetest.s3.amazonaws.com/actionsounds/as04.mp3'/>
		
	*then
		hear continue {
			-> TA7
		}

@TA7	
	*say
		5 <audio src='https://koetest.s3.amazonaws.com/actionsounds/as05.mp3'/>
		// 6 <audio src='https://koetest.s3.amazonaws.com/actionsounds/as06.mp3'/>
	*then
		>> END
				
@Where am I
	*say
		Now you are in {currentLocation}.
	*then
		>> BACK

@Help
	*say
		Here is what you can do: 
            if you want to know your current location, say: where am I; 
            if you want to restart the whole game, say: restart; 
            if you want to revisit the saloon scene, say: jump to saloon.
            if you want to revisit the mayor's office scene, say: get the hot sauce.
	*then
		>> BACK


//TODO: ACT V Start

@Arrival At The Inner Cave
	*say
		You push through the stone doors.
		//(SE: stone doors)
		Immediately, you are greeted with glaring rays of light. 
		Isn't this supposed to be a cave?
		Yes, but none of your assumptions matter. Because right in
		front of you is a hollowed space beneath the earth, filled
		with all kinds of greens and plants. The center of the roof
		is a gigantic hole that allows sunlight to nurture the life
		in here.
		
		//(SE: sounds of bushes bristling)
		
		Suddenly, you hear the tall grass rustling. Something's
		coming towards you.
		
		//(SE: sounds of bushes, with dramatic effect)
		
		From the bushes, pops out the head of a man with faded purple
		hair. Should you tell him who you are and why you're here?
		
		//(SE: Your turn)
		
	*reprompt
		You passed the forest maze, into a hollowed space
		underground filled with natural sunlight, and life. Then, a
		man with faded purple hair showed up in your face.
		
	*recap
		The man stood there like a statue. You should try say 
		something to get his attention? maybe just a "hi"?
	*then
		hear hi, hello, I am, I need {
			-> Alchemist Grabs You
		}
		

@Alchemist Grabs You
	*say
		He stood there and looked at you as you speak. His eyes are
		connected to yours, but you can tell that he's thinking of
		something else.

		[Alchemist]
		Um. Here. Please. [EOA]

		Alchemist takes your hand suddenly and almost pulls you
		towards a little hut in the cave.
		
		[Alchemist]
		Oh welcome to the cave ok I need to
		work on something please don't come
		out I will be right with you in a
		moment please don't come out ok? [EOA]
		
		He puts you in the hut and closes the door.
		
		//(SE: Door closes)
		//(SE: something grows)
		
		As he closes the door, you hear something filling up and
		tying up the hinges of the door. You try to open it, but it
		didn't work. You're locked inside.
	*then
		->Escape The Room

@Escape The Room
	*then
		-> escape_puzzle_intro

@Exit The Room
	*say
		[Alchemist]
		Ah! [EOA]

		As you finally figured out a way to leave the hut, you see
		the man in your face, but terrified. He takes a few steps
		back, then stumbles on the ground.
		
		[Alchemist]
		Please don't hurt me! I've been trying
		to figure out a way to fix the problem
		I've caused. Wait, you don't look like
		you're from the town. [EOA]

		He looks at you for a moment. Then he stands up from the
		ground, getting the dirt off of his clothes. His clothes are
		still dirty, though.

		[Alchemist]
		Sorry, it's been a long time since
		I've anyone. My name is Berette, an
		alchemist, and a botanist. I'm working
		on the last step to my latest work,
		care to join? [EOA]

	*then
		hear yes, sure {
            -> Join The Alchemist At the Cauldron
        }
        hear no, nope {
            -> Alchemist Asks Again
        }
        hear hand him the seed, the seed {
            -> Alchemist Asks
        }
        hear hand him the eureka plant, the plant {
            -> Alchemist Asks More
        }

@Join The Alchemist At the Cauldron
	*say
		[Alchemist]
		Wonderful! I'll show you the way to my
		station. [EOA]

		Berette leads you to a cauldron set up outside. It's bubbling
		with many stuff that you don't know.

		[Alchemist]
		A long time ago, I did something
		terribly wrong. I've kept myself
		behind these stone doors so I can work
		on a solution to undo my mistakes. I
		think, today is my lucky day. [EOA]

		Berette walks to the cauldron.
		
		[Alchemist]
		Alright, ingredients, check. Solvent,
		check. Ok. Let's see if this works. [EOA]

		The alchemist walks into the pond in the middle, towards the
		floating citrine in the middle. He takes out a vial and puts
		it under the gemstone.
		
		//(SE: Miracles sounds)
		
		Miraculously, from the gemstone comes out a drop of a glowing
		substance. It's so bright that it could almost be a star in
		the night.
		Berette walks back to the cauldron, and adds in the drop of
		citrine.
		
		//(SE: Miracle sounds)
		
		The pot starts to glow. A golden color emits from the
		cauldron.
		
		// (SE: Explosion)
		
		Suddenly, the contents of the pot explodes into Berette's
		face. Berette slowly finds himself a chair, then sits down
		and cries.

		[Alchemist]

		I don't know! Why? I thought I had all
		of it solved. I was supposed to be
		ready when someone arrives. What
		ingredient am I missing? [EOA]

	*reprompt 
		Berette extracts a magical substance from the
		citrine in the middle, and adds it into the cauldron he is
		working on. But the content explodes and Berette's experiment
		has failed again. Disappointed and depressed, he asks what
		ingredient he is missing. Perhaps your seed may help?
		
	*recap
		Berette asks if he's missing anything in his potion.
	*then
		hear hand him the seed, the seed {
            -> Alchemist Asks
        }
        hear hand him the eureka seed, eureka, plant {
            -> Alchemist Asks More
        }

@Alchemist Asks Again
	*say
		[Alchemist]
		Are you sure? I'm pretty confident
		that you're about to see something
		that is beyond your knowledge. [EOA]

		Berette looks at you with confident eyes. Perhaps you should
		join him. What say you?
		
	*recap
		 You know, you've come this far, why not say yes?

	*then
		hear yes, sure {
            -> Join The Alchemist At the Cauldron
        }
        hear no {
            -> Alchemist Teel You to Stay Here
        }

@Alchemist Teel You to Stay Here
	*say
		[Alchemist]
        Ah, I see. You are the cautious and
		careful type of person. Got it. Well,
		you just stay here and enjoy the show.[EOA]

	*then
		-> Alchemist Performs At the Cauldron And Fails

@Alchemist Performs At the Cauldron And Fails
	*say
		Berette walks to the cauldron.
		[Alchemist]
		Alright, ingredients, check. Solvent,
		check. Ok. Let's see if this works. [EOA]

		The alchemist walks into the pond in the middle, towards the
		floating citrine in the middle. He takes out a vial and puts
		it under the gemstone.
		
		//(SE: Miracles sounds)

		Miraculously, from the gemstone comes out a drop of a glowing
		substance. It's so bright that it could almost be a star in
		the night.
		Berette walks back to the cauldron, and adds in the drop of
		citrine.
		
		//(SE: Miracle sounds)
		
		The pot starts to glow. A golden color emits from the
		cauldron.
		
		//(SE: Explosion)
		
		Suddenly, the contents of the pot explodes into Berette's
		face. Berette slowly finds himself a chair, then sits down
		and cries.

		[Alchemist]
		I don't know! Why? I thought I had all
		of it solved. I was supposed to be
		ready when someone arrives. What
		ingredient am I missing? [EOA]

	*reprompt 
		Berette extracts a magical substance from the
		citrine in the middle, and adds it into the cauldron he is
		working on. But the content explodes and Berette's experiment
		has failed again. Disappointed and depressed, he asks what
		ingredient he is missing. Perhaps your seed may help?
		
	*recap
		Berette asks if he's missing anything in his potion.

	*then
		hear hand him the seed, the seed {
            -> Alchemist Asks
        }
        hear hand him the eureka seed, eureka, plant {
            -> Alchemist Asks More
        }

@Alchemist Asks
	*say
		You gave the seed to the alchemist. The alchemist looks at it
		for a second, then stares at you with wide-opened eyes.

		[Alchemist]
		Who gave you this seed? [EOA]

	*reprompt
		You gave the purple seed you have to Berette. He
		now asks who gave you the seed.
		
	*recap 
		You gave the purple seed you have to Berette. He now
		asks who gave you the seed.
	
	*then
		hear luke {
            -> Alchemist Questions About Luke
        }
        hear desert trader {
            -> Alchemist Questions About the Seed
        }

@Alchemist Questions About Luke
	*say
		[Alchemist]
		What? Luke gave you this seed? Luke
		[Pause] gave [Pause] you [Pause] this
		[Pause] seed? Oh, now he knows how to
		be an apprentice. To not stab his
		master in the back? Did he tell you
		what happened? [EOA]

	*reprompt 
		You told Barette that it was Luke who gave you the
		seed, and he seemed to be very angry. He asks you if Luke
		told you what happened.
	
	*recap
		[Alchemist]
		What? Is that a yes or a no? [EOA]

	*then
		hear yes {
            -> Alchemist Continues to Scold Luke
        }
        hear no {
            -> None of It Matters Anyway
        }

@Alchemist Continues to Scold Luke
	*say
		[Alchemist] 
        So you knew all of it, right?
		Unbelievable. I thought we were
		partners and friends. And what did he
		do when the incident broke out? He
		went straight to the mayor and turned
		me in. [EOA]

		Barette walks around the room. You can almost see steam
		gushing out of his nose.
		
		[Alchemist] 
		Alright, what else did he say?[EOA]
	*then
		hear sorry {
            -> Alchemist Asks What Luke Says Again
        }
        hear nothing {
            -> Alchemist Scolds Luke Thrice
        }
        //TODO: update this part; shouldn't be 'anything else'
        hear anything else {
            -> Alchemist Scolds Luke For His Weird Behaviour
        }

@Alchemist Asks What Luke Says Again
	*say
		Barette looks astonished, as if he couldn't believe what he
		has heard.

		[Alchemist]
		What? Say that again? [EOA]

	*then
		hear sorry {
            -> Alchemist Sits Down
        }
        hear nothing {
            -> Alchemist Scolds Luke Thrice
        }
        //TODO: update this part; shouldn't be 'anything else'
        hear anything else {
            -> Alchemist Scolds Luke For His Weird Behaviour
        }

@Alchemist Scolds Luke Thrice
	*say
		Barette seems disappointed and furious.

		[Alchemist]
		This mandrake, well he ought to give
		it to me. [EOA]

		Barette looks at you. He realizes that you may not understand
		something. He holds up the seed to you.

		[Alchemist]
		This, my friend, is a Glimmerbrook
		Mandrake. You don't find this
		anywhere. It is basically impossible
		to get, like the citrine. If Luke
		managed to find this, well, he doesn't
		deserve it anyway. So I guess he made
		the right choice of giving it to you. [EOA]

		Barette suddenly realizes something.

		[Alchemist]
		Hmm. Given that this is hard to come
		by anywhere, perhaps we can try to add
		this into our mix? Come on, let's see
		what happens. [EOA]

	*then
		-> Alchemist Brews Potion

@Alchemist Scolds Luke For His Weird Behaviour
	*say
		[Alchemist]
		That's weird. Never thought Luke would
		say anything like that. Huh. anyways,
		he's not my apprentice anymore, and I
		deserve this Mandrake. [EOA]

		Barette looks at you for a second, then he realizes
		something.

		[Alchemist]
		Oh, yes. This seed, it's called the
		Glimmerbrook Mandrake. You don't come
		across this plant like you breathe
		air. It's basically as precious as the
		citrine. Not of this world. Magical.
		Judging by its rarity, and the fact
		that Luke gave you this, it's probably
		worth a shot. [EOA]

		Barette stops writing and closes his notebook swiftly

		[Alchemist]
		Today, I will go home. I will end this
		mess once and for all. [EOA]

	*then
		-> Alchemist Brews Potion

@Alchemist Sits Down
	*say
		[Alchemist]
		Oh. [EOA]

		Barette slowly moves to his hut, and looks at a photo on the
		wall. It is a photo of him and Luke in the lab, except the
		cauldron was on fire.

		[Alchemist]
		After all this time, huh? [EOA]
		
		Barette lets out a short sigh.
		
		[Alchemist]
		You know, you we used to be partners.
		Luke and I. Together, we've
		accomplished many things that no
		alchemist or botanist has ever done.
		He was a dear friend. [EOA]

		Barette then smiles a bit. He looks down on the ground.

		[Alchemist]
		We used to shout out Eureka! To each
		other. That was the phrase we use when
		we did something together. [EOA]

		Barette then realizes that he went off by himself.

		[Alchemist]
		You said this seed was from him? [EOA]

	*then
		hear yes, sure {
            -> Alchemist Accepts
        }
        hear no {
            -> Alchemist Smirks And Accepts
        }

@Alchemist Accepts
	*say
		[Alchemist]
		Oh pal. How long have I waited for
		you. [EOA]

		Then he turns around and looks at the seed.

		[Alchemist]
		If Luke gave you this, and knows that
		you're coming for me, then this has to
		be the key ingredient that I'm
		missing. Come, let's finish this once
		and for all. [EOA]

	*then
		-> Alchemist Brews Potion

@Alchemist Smirks And Accepts
	*say
		[Alchemist]
		Ha. Very much like what he would do.
		He would deny everything until you
		corner him, even when he did nothing
		wrong. [EOA]

		Then he looks at the seed in his hand.

		[Alchemist]
		If Luke gave you this precious plant,
		knowing that you'll end up meeting me
		eventually, then he probably knows.
		This plant must be the key ingredient
		that's missing. Come, let's finish
		this once and for all. [EOA]

	*then
		-> Alchemist Brews Potion

@None of It Matters Anyway
	*say
		[Alchemist]
		Huh. Can't say that I'm surprised by
		now. Took me so long to realize what
		kind of person he is. [EOA]

		Barette walks swiftly to his notebook by the table, with the
		seed in his hand. He talks to you while he puts down notes in
		his book.

		[Alchemist]
		Luke was my apprentice. Or should've
		been. The night the when the
		experiment went wrong, he left and
		turned my name in to the mayor. I
		mean, I admit, I messed it up, but was
		that really necessary? [EOA]

		Barette then stops for a moment as he continues to scribble.

		[Alchemist]
		None of it matters anyway now. What
		else did he say? [EOA]

	*then
		hear sorry {
            -> Alchemist Asks What Luke Says Again
        }
        hear nothing {
            -> Alchemist Scolds Luke Thrice
        }
        //TODO: update this part; shouldn't be 'anything else'
        hear anything else {
            -> Alchemist Scolds Luke For His Weird Behaviour
        }

@Alchemist Questions About the Seed
	*say
		Barette seems very, very amazed.
		
		[Alchemist]
		Wow. Do you even know what this seed
		is? It's a miracle that you come
		across it. It's called the
		Glimmerbrook Mandrake. You don't just
		find it here, or anywhere. Frankly,
		you can't find it in this world.
		Anyways, this person you meet, must be
		a great botanist, or a great magician,
		or both. [EOA]

		He takes another careful look at the seed. Suddenly, he jumps
		up and looks at you with shining eyes.

		[Alchemist]
		Given the rarity of this plant... this
		could be the key ingredient to our
		potion. Come on, this could be our
		only chance to set things right. [EOA]

	*then
		-> Alchemist Brews Potion

@Alchemist Asks More
	*say
		You gave the seed to the alchemist. The alchemist looks at it
		for a second, then looks at you with confused but trembling
		eyes.

		[Alchemist]
		What? This is called Eureka? Who told
		you that it's called Eureka? [EOA]

	*reprompt 
		You gave the Eureka seed you have to Berette. He
		now asks who told you that the seed is called Eureka.
		
	*recap 
		You gave the Eureka seed you have to Berette. He now
		asks who told you that the seed is called Eureka.

	*then
		hear yes {
            -> Alchemist Realizes
        }
        hear no {
            -> Alchemist Smirks
        }

@Alchemist Realizes
	*say
		[Alchemist]
		Oh. [EOA]

		The alchemist pauses for a second. Then he slowly walks back
		to the hut.
		
		//(SE: Walks on dirt)
		
		He looks at a photo on the wall. It's a photo of him with
		Luke when the cauldron in front of him explodes.

		[Alchemist]
		Oh. Partner. Why don't you just come
		to me directly? It's been so long. [EOA]
		
		Barette looks at you. He then smiles.

		[Alchemist]
		That man you just met outside the
		tent, well, he's officially known as
		an apprentice to me. But I see him as
		my partner. [EOA]

		Barette then hols up the Eureka seed to you.

		[Alchemist]
		This is not called Eureka. This, is a
		Glimmerbrook Mandrake. Eureka is a
		word we use back in the day to
		celebrate the progress we made. Dumb
		old friend, I'm not angry at him
		anymore. [EOA]

		Barette sits there quietly.
		
		[Alchemist]
		This plant. you don't just come across
		it here. Or anywhere. It's just as
		hard to find as the citrine is. If he
		gave this plant to you, and didn't ask
		for anything in return, this could
		only mean that it's the ingredient
		we're missing. [EOA]

		Barette then extend his hands to you.

		[Alchemist]
		C'mon, pull me up. Let's get this
		potion finished, and end this crisis
		once and for all.

	*reprompt 
		Barette realized something as soon as you told him
		who named the plant Eureka. It turns out that Luke was
		Barette's lab partner before, and the word Eureka is a word
		that only the two would use before; no matter what happened
		before, Barette is not angry with Luke anymore. Now, with the
		seed, Barette is ready to use the seed and end the stinky
		curse once and for all. He extends his arm and asks you to
		pull him up from the chair.
		
	*recap 
		You should pull him up from the chair.
		
	*then
		hear pull, pull him up, help, up, chair {
			-> Alchemist Brews Potion
		}

@Alchemist Smirks
	*say
		The Alchemist exhales deeply. He then looks at you with a
		smirk on his face.

		[Alchemist]
		This is not called Eureka, my friend.
		This, is a Glimmerbrook Mandrake. [EOA]

		Barette then looks up into the sky, and talks slowly.

		[Alchemist]
		You know, back in the day the word
		Eureka meant something to me. It's
		just a silly phrase that me and my old
		friend use all the time. Haven't seen
		him for a long time. [EOA]
		
		Barette walks back to his hut.
		
		//(SE: Walk on dirt)

		He looks at a photo on the wall. It's a photo of him and
		Luke, taken when the cauldron in front of him explodes.

		[Alchemist]
		We had a big fight one night over
		procedures of a certain experiment.
		Turned out he was right. I was too
		eager and too confident. After that
		night, the water and the soil of the
		town are all contaminated. [EOA]

		Barette looks down on the ground, then you.

		[Alchemist]
		That's why I fled away. I couldn't
		dare face the anger of the
		townspeople. I hid myself within these
		caves, and I told myself that I'd
		never come out until I figure out a
		solution. [EOA]

		He holds up the mandrake seed, and smiles at it.

		[Alchemist]
		Well, this could be our lucky day.
		Let's see if this works, shall we?
		Pull me up from this chair. [EOA]

		He extends his arm out and asks you to pull him up.

	*reprompt 
		Barette realized something as soon as you told him
		who named the plant Eureka. It turns out that Luke was
		Barette's lab partner before, and the word Eureka is a word
		that only the two would use before; no matter what happened
		before, Barette is not angry with Luke anymore. Now, with the
		seed, Barette is ready to use the seed and end the stinky
		curse once and for all. He extends his arm and asks you to
		pull him up from the chair.
		
	*recap 
		You should pull him up from the chair.
		
	*then
		hear pull, pull him up, help, up, chair, pull him up from the chair {
			-> Alchemist Brews Potion
		}

@Alchemist Brews Potion
	*say
        Barette quickly walks back to the cauldron. He extracts
		another drop of substance the citrine releases.
		After adding all the regular ingredients, there is one thing
		left to do: add the mandrake seed. 

		[Alchemist]
		Here goes nothing. [EOA]

		He allows the seed to slip and roll of his palm. The seed
		slowly falls and enters the pot.
		
		//(SE: Explode)
		
		Poof! Smoke emerges from the pot. Strangely, you see sparkles
		of purple within the fog. It swiftly rises and fills the roof
		.

		[Alchemist]
		Huh. This is unlike anything I've
		seen. Oh dear.[EOA]

		In just a few seconds, the fog gathers into clouds above
		their heads.

		[Alchemist]
		What was that?[EOA]

		Barette suddenly asks. You felt the same thing. Water.
		
		//(SE: starts to rain)
		
		The cave starts pouring rain. But it was no ordinary rain.
		The raindrops that are supposed to hit your harshly, instead
		felt like cool splashes of spring water.
		As you look to Barette, you noticed something else: he no
		longer smells.

		[Alchemist]
		The smell. It's gone. We did it! We
		did it, visitor! We've found the
		solution![EOA]

		Barette holds his hand tightly, and punches into the sky.

		[Alchemist]
		Eureka![EOA]

		Then he hugs you tightly, and dances around, as if joy is an
		emotion new to him.

		[Alchemist]
		Quick! Pack your stuff immediately. We
		will end this chaos once and for all.[EOA]

		//(SE: horses galloping)

		As you close in on the town, you could smell that stench
		again.

		[Alchemist]
		Don't worry guys, I'm here to correct
		everything.[EOA]

		A woman in the town shouts.
		
		[MrsChilirosa]
		Look! It's the alchemist![EOA]

		//(SE: Town bell)

		The town bell rang. Although they'd prefer not to, the
		townspeople all came out to check what's going on.

		[Mayor]
		Look who's back here, villain. Did you
		return only to give us yet another
		curse?[EOA]

		[Alchemist]
		No! People. I came back here because I
		knew I did something terrible. I came
		back because I've found a way to fix
		all of this.[EOA]

		[MrsChilirosa]
		Oh, is that so? How do you propose to
		fix this disaster?[EOA]

		[Alchemist]
		By this![EOA]

		Barette takes out the vial containing the purple potion.

		[Man]
		No! Not one of your tricks again,
		wizard! We don't trust you.[EOA]

		[Alchemist]
		Please! You must believe me.[EOA]

		[MrsChilirosa]
		Get out of here.[EOA]

		The crowd boos at Barette, chanting for his immediate
		banishment. The mayor seemed a little bit hesitant.
		Barette looks at you. He gives you the vial.

		[Alchemist]
		Open the vial. Show them that they're
		wrong.[EOA]

		Will you open the vial?

	*then
		hear yes, sure {
			-> Open the Vial
		}
		hear no, nope {
			-> Dont Open the Vial
		}

@Open the Vial
	*say	
		You opened the vial without hesitation. Smoke glittering
		purple comes out of the bottle, and into the sky. In no time,
		the blue sky is filled with purple clouds.
		As expected, it starts raining. The stench starts to wear
		away.

	*then
		-> After Opening the Vial

@Dont Open the Vial
	*say
		You stood there and do nothing.
		
		[Mayor]
		I'm sorry, Barette, but I think, we've
		seen what you're capable of. You even
		turned our visitor against us. You
		must leave. [EOA]

		[MrsChilirosa]
		Leave! Leave! Leave![EOA]
		
		[Man]
		Leave! Leave! Leave![EOA]
		
		[Kid]
		Wait![EOA]

		The shopkeeper's son yells at the crowd.

		[Kid]
		I believe him.[EOA]

		Slowly, he walks towards you, and takes over the potion.

		[Man]
		Boy, what are you doing?[EOA]

		[Kid]
		Fixing all of you.[EOA]

		In a blink of an eye, the boy opens the vial. Smoke
		glittering purple comes out of the bottle, and into the sky.
		In no time, the blue sky is filled with purple clouds.
		As expected, it starts raining. The stench starts to wear
		away.

	*then
		-> After Opening the Vial

@After Opening the Vial	
	*say
		
		[Man]
		Wa, what? What's going on?[EOA]

		[MrsChilirosa]
		Is my nose going crazy?[EOA]

		[Mayor]
		No.. it's the stench. It's getting
		washed away! Everyone! Come outside!
		The rain is washing away the stench![EOA]

		People started to come outside of their heavily-locked
		houses. No people like them has ever enjoyed the rain so
		much.
		By the time the rain ends, the stench is completely washed
		away. The town is saved.

		[Mayor]
		I'm sorry, Barette. It's just that
		we've been so scared and desperate
		about it. We are grateful for you
		coming back.[EOA]

		[MrsChilirosa]
		Hum. Had he not done those weird
		experiments, this would never have
		happened in the first place.[EOA]

		[Man]
		Come on, Chilirosa. It's all over. [EOA]
	*then	
		if plot12 {
            -> Luke Returns
        }
        if plot3 {
            -> Luke Watches From the Distance
        }
        -> Luke Is Nowhere To Be Found


@Luke Returns
	*say
		[MrsChilirosa]
		There's someone arriving from the
		East! [EOA]

		The soaked townspeople looked in to the East. A figure
		approaches the town on a camel. You squint your eyes as the
		visitor's shape reminds you of someone.
		It's Luke.
		The alchemist looks to the East as well. Then, he starts to
		walk towards Luke in big strides; Luke gets off the camel and
		walks in big strides as well. The two collided with each
		other into a big hug.
		They are too far for you to listen to what they're saying,
		but from the looks on their faces, you are sure that it's
		something worth celebrating.
		
		[Mayor]
		Well, (playername). Let's discuss
		about the reward I promised, shall we? [EOA]

		[Man]
		Wait, this is a perfect photo moment,
		isn't it? Everybody gather around.[EOA]

		As you try to find your spot in the crowd, the mayor grabs
		you upfront.

		[Mayor]
		No, my friend. You deserve to be at
		the very front.[EOA]

		You sit firmly on the ground. Everyone is happy. As if spring
		and life is coming back to the desert.

		[Man]
		3, 2, 1, say cheese! [EOA]

		//(SE: photo sound)

	*then
		>>END

@Luke Watches From the Distance
	*say
		[Mayor]
		Well, Let's discuss
		about the reward I promised, shall we? [EOA]

		[Man]
		Wait, this is a perfect photo moment,
		isn't it? Everybody gather around.[EOA]

		As you try to find your spot in the crowd, the mayor grabs
		you upfront.

		[Mayor]
		No, my friend. You deserve to be at
		the very front.[EOA]
		
		[Alchemist]
		Oh. How I wish Luke was here.[EOA]

		You sit firmly on the ground. Everyone is happy. As if spring
		and life is coming back to the desert.
		You spot someone in the distance. You could almost tell who
		the person is by the outline, but soon the figure turns
		around and leaves the town.

		[Man]
		3, 2, 1, say cheese![EOA]

		//(SE: photo sound)
	*then
		>>END

@Luke Is Nowhere To Be Found
	*say
		[Mayor]
		Well, (playername). Let's discuss
		about the reward I promised, shall we? [EOA]

		[Man]
		Wait, this is a perfect photo moment,
		isn't it? Everybody gather around. [EOA]

		As you try to find your spot in the crowd, the mayor grabs
		you upfront.

		[Mayor]
		No, my friend. You deserve to be at
		the very front. [EOA]

		[Man]
		3, 2, 1, say cheese![EOA]

		//(SE: photo sound)
		
	*then
		>>END

// the start of Chilirosa steal puzzle -------------------------------------------------------------------------------------------
@chilirosa_steal_puzzle_start
	*say
		You want to sneak into the Misses Chilirosa's house to grab the hot sauce, do you?
	*then
		hear yes {
		    set pot_count as 0
		    unflag turn_pot
		    unflag turn_kettle
		    unflag hide
			-> chilirosa_door
		}
		hear no {
			-> Arrive Beauty Salon
		}

@chilirosa_steal_puzzle_again
	*say
		You are in front of Misses Chilirosa's house. Do you want to sneak in again?
	*then
		hear yes, sure {
		    set pot_count as 0
		    unflag turn_pot
		    unflag turn_kettle
		    unflag hide
			-> chilirosa_door
		}

@chilirosa_door
	*say
		You decided to sneak into Misses Chilirosa's house to steal the hot sauce. You open the the door carefully, and sneak into the hallway. Suprisely, it connects to her house.At anytime, you can say look around me to explore the rooms. [Action]
	*then
		hear look around me, look around the hallway, around me {
			-> chilirosa_hallway_around
		}

@chilirosa_hallway_around
	*say
		You are in the hallway. There is a closet standing next to you, the main door behind you, and two rooms in front of you. They are, the living room, and the kitchen. You can look at different things and rooms from the hallway to see more details. [Action]
	*then
		-> chilirosa_hallway_interation

@chilirosa_hallway_interation
	*say
		
	*then
		hear view the door, look at the door {
			-> chilirosa_hallway_viewdoor
		}

		hear view the closet, look at the closet {
			-> chilirosa_hallway_viewcloset
		}

		hear view the living room, look at the living room {
			-> chilirosa_hallway_viewliving
		}

		hear view the kitchen, look at kitchen {
			-> chilirosa_hallway_viewkitchen
		}
		hear go to the kitchen, go to kitchen {
		    if turn_kettle{
		        -> chilirosa_kitchen_caught_kettle_back
		    }
		    if turn_pot and !hide{
		        -> chilirosa_kitchen_pot_back
		    }
		    if turn_pot and hide {
		        -> chilirosa_kitchen_caught_goto
		    }
			-> chilirosa_kitchen_goto
		}
		hear look around, look around me {
			-> chilirosa_hallway_around
		}
		hear leave, leave from the door {
			-> chilirosa_steal_puzzle_start
		}
		hear hide in the closet {
		    if !turn_pot and !turn_kettle{
			    -> chilirosa_hallway_hidenormal
			}
			if turn_pot and turn_kettle{
			    unflag turn_pot
			    unflag turn_kettle
		        set pot_count as 0
			    -> chilirosa_hallway_hidepotkettle
			}
			if turn_pot{
			    flag hide
			    -> chilirosa_hallway_hidepot
			}
			if turn_kettle{
			    unflag turn_kettle
			    -> chilirosa_hallway_hidekettle
			}
		}
		hear go to the living room, go to living room {
		    if turn_pot and hide{
			    -> chilirosa_living_goto
			}
			else{
			    -> chilirosa_living_caught
		    }
		}
	*recap
		You can look at different objects, look at different rooms to see more details, or look around.[Action]
	*reprompt
		You can look at different objects, look at different rooms to see more details, or look around.[Action]

@chilirosa_kitchen_pot_back
	*say
		You go to the kitchen. The pot is been heaten up. It will boil dry soon, and the pot will be burnt. You need to leave the kitchen right now. Otherwise, you will be caught.
	*then
		hear go to the hallway, go to hallway {
			-> chilirosa_hallway_pot_caught
		}
	*recap
		You should go to hallway.[Action] 
	*reprompt
		You should go to hallway.[Action]

@chilirosa_hallway_pot_caught
	*say
		As soon as you arrive at the hallway. The soup is been boiled dry and the pot is burnt. Misses Chilirosa comes over to check on the stove but finds you instead. You are caught. She throws you out of her house.
	*then
		-> chilirosa_steal_puzzle_again

@chilirosa_kitchen_caught_kettle_back
	*say
		You go to the kitchen. At the time you just arrived, the kettle whistles. Misses Chilirosa hears it, and arrives at the kitchen to find you, a stranger, wandering. She throws you out of her house.
	*then
		-> chilirosa_steal_puzzle_again

@chilirosa_hallway_hidekettle
	*say
		You hide into the closet.[Chilirosa_hide] Right after you close the closet, the kettle starts to whistle. Misses Chilirosa hears it, walks past the hallway to the kitchen, and turns the kettle off. She then goes back to the living room, muttering about the stench. You come out of the closet. You should find a way to leave her in the kitchen for a longer time.
	*then
		-> chilirosa_hallway_interation

@chilirosa_hallway_hidepotkettle
	*say
		You hide into the closet. [Chilirosa_hide]Right after you close the door, the kettle starts to whistle. Misses Chilirosa hears it, walks past the hallway to the kitchen. She turns the kettle off and finds that the pot is also on. The soup is not boiling dry yet. She turns the pot off, then goes back to the living room. Hearing that, you come out of the closet. You should find a way to leave her in the kitchen for a longer time.
	*then
	    
		-> chilirosa_hallway_interation

@chilirosa_living_caught
	*say
		You go to the living room. Misses Chilirosa is right there. You are caught. She throws you out of her house. Make sure you observe the room first, before you go in.
	*then
		-> chilirosa_steal_puzzle_again

@chilirosa_living_goto
	*say
		You go to the living room.
	*then
		-> chilirosa_living_around

@chilirosa_living_around
	*say
		You are in the living room. From the living room, you can see Misses Chilirosa's bedroom. The important thing is, the hot sauce is right on the table beside you.
	*then
		-> chilirosa_living_interaction

@chilirosa_living_interaction
	*recap
		You should take the hot sauce.[Action]
	*reprompt
		You should take the hot sauce.[Action] 
	*then
		hear take the sauce, take sauce, take hot sauce, take the hot sauce, take it {
			-> chilirosa_living_takesauce
		}

@chilirosa_hallway_out
	*say
		You go to the hallway, with the hot sauce in your hand. Misses chilirosa is still cleaning up the pot that was burnt. You leave her house from the door. Now you have the hot sauce!
	*then
		-> chilirosa_puzzle_end

@chilirosa_puzzle_end
	*then
		-> Get the Hot Sauce

@chilirosa_living_takesauce
	*say
		You got the hot sauce. Now, go to the hallway and leave from there.
	*then
		hear go to hallway, go to the hallway {
			-> chilirosa_hallway_out
		}

@chilirosa_hallway_hidepot
	*say
		You hide in the closet.[Chilirosa_hide] After a while you hear that the soup is bubbling, and gradually dries up. The next thing you smell is the mixture of the stench and the smoke. The pot is burnt. Misses Chilirosa rushes in from the living room, across the hallway, in to the kitchen. Hearing that, you come out of the closet.
	*then
		-> chilirosa_hallway_interation

@chilirosa_hallway_hidenormal
	*say
		You hide in the closet.[Chilirosa_hide] Nothing happened for a bit. So you come out of the closet.
	*then
		-> chilirosa_hallway_interation

@chilirosa_kitchen_caught_goto
	*say
		You go the the kitchen. Misses Chilirosa is right in the kitchen. You are caught.
	*then
		-> chilirosa_steal_puzzle_again

@chilirosa_kitchen_goto
	*say
		You go to the kitchen.
	*then
		-> chilirosa_kitchen_around

@chilirosa_kitchen_interaction
	*say
		
	*then
		hear view watertap, look at the watertap {
		    if pot_count is 1{
		        -> chilirosa_kitchen_caught_pot_stay
		    }
		    if turn_pot{
		        increase pot_count by 1
		    }
		    if turn_kettle{
		        -> chilirosa_kitchen_caught_kettle_stay
		    }
			-> chilirosa_kitchen_viewwatertap
		}

		hear view pot, look at the pot {
		    if pot_count is 1{
		        -> chilirosa_kitchen_caught_pot_stay
		    }
		    if turn_pot{
		        increase pot_count by 1
		        -> chilirosa_kitchen_viewpot_boil
		    }
		    if turn_kettle{
		        -> chilirosa_kitchen_caught_kettle_stay
		    }
			-> chilirosa_kitchen_viewpot
		}

		hear look around {
			-> chilirosa_kitchen_around
		}

		hear view kettle, look at the kettle {
		    if pot_count is 1{
		        -> chilirosa_kitchen_caught_pot_stay
		    }
		    if turn_pot{
		        increase pot_count by 1
		    }
		    if turn_kettle{
		        -> chilirosa_kitchen_caught_kettle_stay
		    }
			-> chilirosa_kitchen_viewkettle
		}
		hear go to hallway, hallway {
			    -> chilirosa_hallway_goto
		}
		hear turn on watertap, turn on water {
		    if pot_count is 1{
		        -> chilirosa_kitchen_caught_pot_stay
		    }
		    if turn_pot{
		        increase pot_count by 1
		    }
		    if turn_kettle{
		        -> chilirosa_kitchen_caught_kettle_stay
		    }
			-> chilirosa_kitchen_caught_turnwater
		}
		hear turn on the pot, turn on pot {
		    if pot_count is 1{
		        -> chilirosa_kitchen_caught_pot_stay
		    }
		    if turn_pot{
		        increase pot_count by 1
		        -> chilirosa_kitchen_viewpot_boil
		    }
		    if turn_kettle{
		        -> chilirosa_kitchen_caught_kettle_stay
		    }
			-> chilirosa_kitchen_turnpot
		}
		hear turn on the kettle, turn on kettle {
		    if pot_count is 1{
		        -> chilirosa_kitchen_caught_pot_stay
		    }
		    if turn_pot{
		        increase pot_count by 1
		    }
	    	if turn_kettle{
		        -> chilirosa_kitchen_caught_kettle_stay
		    }
			-> chilirosa_kitchen_turnkettle
		}
		hear turn on the stove, turn on stove {
		    if pot_count is 1{
		        -> chilirosa_kitchen_caught_pot_stay
		    }
		    if turn_pot{
		        increase pot_count by 1
		    }
	    	if turn_kettle{
		        -> chilirosa_kitchen_caught_kettle_stay
		    }
			-> chilirosa_kitchen_turnstove
		}
	*recap
		You can look at different objects, look around, or go to the hallway.
	*reprompt
		You can look at different objects, look around, or go to the hallway.

@chilirosa_kitchen_viewpot_boil
	*say
		You look at the pot. It's cooking on the stove. The soup will be boiled dry soon and the pot will be burnt.

@chilirosa_kitchen_caught_pot_stay
	*say
		The soup has been boiled dry and the pot is burnt. Misses Chilirosa comes over to check on the stove but finds you instead. You are caught. She throws you out of her house.

@chilirosa_kitchen_caught_kettle_stay
	*say
		Suddenly, the kettle whistles. Misses Chilirosa hears it, and arrives at the kitchen to find you, a stranger, wandering. She throws you out of her house.

@chilirosa_kitchen_turnstove
	*say
		Which stove? The kettle or the pot?
	*then
		hear kettle {
			-> chilirosa_kitchen_turnkettle
		}
		hear pot {
			-> chilirosa_kitchen_turnpot
		}

@chilirosa_kitchen_turnkettle
	*say
		You turn on the kettle.[Chilirosa_startfire] The water starts to boil.
	*then
		flag turn_kettle
	    -> chilirosa_kitchen_interaction

@chilirosa_hallway_goto
	*say
		You go to the hallway
	*then
		-> chilirosa_hallway_interation

@chilirosa_kitchen_turnpot
	*say
		You turn on the pot.[Chilirosa_startfire] The pot starts to heat up.
	*then
		flag turn_pot
		set pot_count to 0
	    -> chilirosa_kitchen_interaction

@chilirosa_kitchen_caught_turnwater
	*say
		You turn on the watertap. Water starts to flow. Misses Chilirosa rushes in to the kitchen to check out what's going on. Now she knows what's going on. There's a thief, and that means you. You are thrown out of her house.
	*then
		flag caught
		-> chilirosa_steal_puzzle_again

@chilirosa_kitchen_viewkettle
	*say
		You look at the kettle on the right. It is full of water. And it's quite hot. If you turn on the kettle, the kettle will whistle almost immediately. You can turn on the kettle.[Action]
	*then
		-> chilirosa_kitchen_interaction

@chilirosa_kitchen_around
	*say
		You are in the kitchen. From the kitchen, you can only see the hallway you came from. Inside the kitchen, there is a pair of stoves. On the left is a pot, and on the rightis a kettle. Beside the stoves is a water tap.  But, you didn't find the hot sauce in the kitchen. [Action]
	*then
		-> chilirosa_kitchen_interaction

@chilirosa_kitchen_viewpot
	*say
		You look at the pot on the left. Open up the cover carefully, you see a little bit of soup left in it. The pot is cold. If you turn on the pot, the soup will boil and dry, and the pot will be burnt. You can turn on the pot.[Action] 
	*then
		-> chilirosa_kitchen_interaction

@chilirosa_kitchen_viewwatertap
	*say
		You look at the watertap. You are sure that if you open it, it will make some noise.  You can turn on the water.[Action]
	*then
		-> chilirosa_kitchen_interaction

@chilirosa_hallway_viewkitchen
	*say
		You look at the kitchen. No one is in the kitchen. Some containers are on the stove. You can go to the kitchen if you want.[Action]
	*then
		-> chilirosa_hallway_interation

@chilirosa_hallway_viewliving
	*say
		You look at the living room. Misses Chilirosa is sitting next to the table and having her lunch. She is sprinkling sauce on her pasta. That's it! That's the hot sauce you want.  You can go to living room at anytime, but she is in it right now, you should do something to distract her away first.[Action]
	*then
		-> chilirosa_hallway_interation

@chilirosa_hallway_viewcloset
	*say
		You look at the closet. It's a large closet. You opened up the closet, a bunch of coats are hanging in it. Suprisely it's large enough for you to hide in. [Action] If you want to hide in the closet, you can say hide in the closet.
	*then
		-> chilirosa_hallway_interation

@chilirosa_hallway_viewdoor
	*say
		You look at the door. That's the door you sneaked in from. If you want to give up on stealing the hot sauce, you can come to the hallway and say leave from the door.[Action]
	*then
		-> chilirosa_hallway_interation
	
		

    
//Leading flower puzzle-----------------------------------------------------------------------------------

@leading_beforestart
	*say
		
	*then
		-> leading_start

@leading_puzzle_help
	*say
		If you are far away from the right direction. The flower will sing this song. [DirSound_Small]
If you are close to the right direction, the flower will sing. [DirSound_MRight]
If you are on the right direction, the flower will sing. [DirSound_Large]

@leading_start
	*say
		The flower suddenly stands up straight, like it has awoken from some sleep.
        
        [SeedTrader]
        Good. Then, grab some dust from the ground and sprinkle it on the flower.  [EOA]
	*recap
		Try use the dust on the flower. [Action]
	*reprompt
		Try use the dust on the flower. [Action]
	*then
		hear use the dust on the flower {
			-> leading_tutorial_start
		}

@leading_tutorial_start
	*say
		You use the dust on the leading flower. 
        The flower gently shakes for a second. 
        
        [SeedTrader]
        Great. That means the flower has locked on to the scent of a garden, and knows how to get to it now. Hold the flower and look at four directions: East, South, West, and North.[EOA] Try say, look south 
	*then
		hear look south, look at south {
			-> leading_tutorial_south
		}
	*recap
		Try say, look south. [Action]
	*reprompt
		Try say, look south. [Action]

@leading_tutorial_south
	*say
		You are looking at the south. [SeedTrader]
Listen, the leading flower is singing you the way .[EOA][DirSound_Small][SeedTrader]This song means that the direction you are looking is far away from the right direction.  [EOA]
 Now, try say look west. [Action]
	*then
		hear look west {
			-> leading_tutorial_west
		}
	*recap
		Now, try say look west.[Action]
	*reprompt
		Now, try say look west.[Action]

@leading_tutorial_west
	*say
		You are looking at the west.
[DirSound_MRight]
[SeedTrader] This song means you are close to the right direction. [EOA]
	*recap
		You can say look east or look north. [Action]
	*reprompt
		You can say look east or look north.
	*then
		hear look north {
			-> leading_tutorial_north
		}

		hear look east {
			-> leading_tutorial_east
		}

@leading_tutorial_east
	*say
		You are looking east. You are facing a wall.
	*recap
		You can say look north.
	*reprompt
		You can say look north.
	*then
		hear look north {
			-> leading_tutorial_north
		}

@leading_tutorial_north
	*say
		You are looking north.
[DirSound_Large]
[SeedTrader]
This song means you are right looking at the way out! Go toward that direction and you are free! [EOA]

Try say, go north.[Action]
	*then
		hear go north {
			-> leading_tutorial_end
		}
	*recap
		Try say, go north.[Action]
	*reprompt
		Try say, go north.[Action]

@leading_tutorial_end
	*say
		[SeedTrader] Hey, congrats! Now you are in my garden, do you understand how to use  the leading flower?[EOA][Conversation]
	*then
		hear yes {
			-> leading_tutorial_end_1
		}

		hear no {
			-> leading_tutorial_again
		}

@leading_tutorial_again
	*say
		[SeedTrader]Ok... No worry, I can put you back to the maze, and show you again. Do you wanna learn again?[EOA][Conversation]
	*then
		hear yes {
			-> leading_tutorial_start
		}
		hear no {
			-> leading_tutorial_end_1
		}

@leading_tutorial_end_1
	*say
		[SeedTrader] Ok, cool. It's simple to use, right? Here, take this bottle of dust. I grab it from the oasis you are looking for. And. You are ready to go! With the leading flower, you should be able to walk across the sandstorm! [EOA]
	*then
		if plot12 {
			-> One Last Thing
		}
		if plot3 {
			-> One More Thing Plot 3
		}
		-> One Last Thing Plot 4

@leading_puzzle_start
	*say
		You thank him and continute your journey. [Footsteps]Couple minutes later, you are standing in front of the foggy forest. You take out the leading flower. [Action]
	*recap
		Try use the dust on the flower[Action]
	*reprompt
		You should use the dust on the leading flower before you go into the sandstorm. [Action]
	*then
		hear use the dust on the flower, use , use dust {
			-> leading_puzzle_start_from_a
		}
		hear use the dust on the flower, use, use dust, use the dust on the leading flower {
			-> leading_puzzle_start_from_a
		}

@leading_puzzle_start_from_a
	*say
		You use the dust on the flower. The flower is reacting to it. Now you can look to different directions.
	*recap
		You can look east, look south, look west and look north. [Action] [Action]
	*reprompt
		You can look east, look south, look west and look north. [Action] [Action]
	*then
		//Node _a_
		-> leading_a_position

@leading_a_goto
	*say
		
	*then

@leading_a_position
	*then
		hear look north, look at north {
			-> leading_a_north
		}

		hear look east, look at east {
			-> leading_a_east
		}

		hear look south, look at south, go south, go to south {
			-> leading_a_south
		}

		hear look west, look at west, go west, go to west {
			-> leading_a_west
		}
		
		hear go north, go to north {
			-> leading_e_goto
		}
		
		hear go east, go to east {
			-> leading_b_goto
		}
	*recap
		You can look east, look south, look west and look north. [Action]
	*reprompt
		You can look east, look south, look west and look north. [Action]

@leading_a_north
	*say
		You are looking north.[DirSound_MRight]
	*then
		-> leading_a_position

@leading_a_east
	*say
		You are looking east.[DirSound_MLeft]
	*then
		-> leading_a_position

@leading_a_south
	*say
		You are looking south.[DirSound_Small] That's the entrance you came in before.
	*then
		-> leading_a_position

@leading_a_west
	*say
		You are looking west.[DirSound_Small] You see the outer edge of the sandstorm. That's definitely now the right way.
	*then
		-> leading_a_position
        
//Node _b_

@leading_b_goto
	*say
		[Footsteps] Couple minutes later. You come to a new spot.
	*then
		-> leading_b_position

@leading_b_position
	*then
		hear look north, look at north, go north, go to north {
			-> leading_b_north
		}

		hear look east, look at east {
			-> leading_b_east
		}

		hear look south, look at south, go to south, go south {
			-> leading_b_south
		}

		hear look west, look at west {
			-> leading_b_west
		}
		
		hear go east, go to east {
			-> leading_c_goto
		}
		
		hear go west, go to west {
			-> leading_a_goto
		}
	*recap
		You can look east, look south, look west and look north. [Action]
	*reprompt
		You can look east, look south, look west and look north. [Action]

@leading_b_north
	*say
		You are looking north. [DirSound_MRight] A dead forest blocks the way.
	*then
		-> leading_b_position

@leading_b_east
	*say
		You are looking east. [DirSound_MLeft]
	*then
		-> leading_b_position

@leading_b_south
	*say
		You are looking south. [DirSound_Small] You see the outer edge of the sandstorm. That's definitely now the right way.
	*then
		-> leading_b_position

@leading_b_west
	*say
		You are looking west. [DirSound_Small]
	*then
		-> leading_b_position

//Node _c_

@leading_c_goto
	*say
		[Footsteps] Couple minutes later. You come to a new spot.
	*then
		-> leading_c_position

@leading_c_position
	*then
		hear look north, look at north {
			-> leading_c_north
		}

		hear look east, look at east {
			-> leading_c_east
		}

		hear look south, look at south, go south, go to south {
			-> leading_c_south
		}

		hear look west, look at west {
			-> leading_c_west
		}
		
		hear go north, go to north {
			-> leading_g_goto
		}
		
		hear go east, go to east {
			-> leading_g_goto
		}
		
		hear go west, go to west {
			-> leading_c_goto
		}
	*recap
		You can look east, look south, look west and look north. [Action]
	*reprompt
		You can look east, look south, look west and look north. [Action]

@leading_c_north
	*say
		You are looking north.[DirSound_Large]
	*then
		-> leading_c_position

@leading_c_east
	*say
		You are looking east.[DirSound_MLeft]
	*then
		-> leading_c_position

@leading_c_south
	*say
		You are looking south.[DirSound_Small] You see the outer edge of the sandstorm. That's definitely now the right way.
	*then
		-> leading_c_position

@leading_c_west
	*say
		You are looking west. [DirSound_MRight]
	*then
		-> leading_c_position

//Node _d_

@leading_d_goto
	*say
		[Footsteps] Couple minutes later. You come to a new spot.
	*then
		-> leading_d_position

@leading_d_position
	*then
		hear look north, look at north {
			-> leading_d_north
		}

		hear look east, look at east, go east, go to east {
			-> leading_d_east
		}

		hear look south, look at south, go south, go to south {
			-> leading_d_south
		}

		hear look west, look at west {
			-> leading_d_west
		}
		
		hear go north, go to north {
			-> leading_h_goto
		}
		
		hear go west, go to west {
			-> leading_c_goto
		}
	*recap
		You can look east, look south, look west and look north. [Action]
	*reprompt
		You can look east, look south, look west and look north. [Action]

@leading_d_north
	*say
		You are looking north. [DirSound_MLeft]
	*then
		-> leading_d_position

@leading_d_east
	*say
		You are looking east. [DirSound_Small] You see the outer edge of the sandstorm. That's definitely now the right way.
	*then
		-> leading_d_position

@leading_d_south
	*say
		You are looking south. [DirSound_Small] You see the outer edge of the sandstorm. That's definitely now the right way.
	*then
		-> leading_d_position

@leading_d_west
	*say
		You are looking west. [DirSound_MRight]
	*then
		-> leading_d_position

//Node _e_

@leading_e_goto
	*say
		[Footsteps] Couple minutes later. You come to a new spot.
	*then
		-> leading_e_position

@leading_e_position
	*then
		hear look north, look at north {
			-> leading_e_north
		}

		hear look east, look at east {
			-> leading_e_east
		}

		hear look south, look at south {
			-> leading_e_south
		}

		hear look west, look at west, go west, go to west {
			-> leading_e_west
		}
		
		hear go north, go to north {
			-> leading_i_goto
		}
		
		hear go east, go to east {
			-> leading_f_goto
		}
		
		hear go south, go to south {
			-> leading_a_goto
		}
	*recap
		You can look east, look south, look west and look north. [Action]
	*reprompt
		You can look east, look south, look west and look north. [Action]

@leading_e_north
	*say
		You are looking north. [DirSound_MRight]
	*then
		-> leading_e_position

@leading_e_east
	*say
		You are looking east. [DirSound_MLeft]
	*then
		-> leading_e_position

@leading_e_south
	*say
		You are looking south. [DirSound_Small]
	*then
		-> leading_e_position

@leading_e_west
	*say
		You are looking west. [DirSound_Small] You see the outer edge of the sandstorm. That's definitely now the right way.
	*then
		-> leading_e_position


//Node _f_

@leading_f_goto
	*say
		[Footsteps] Couple minutes later. You come to a new spot.
	*then
		-> leading_f_position

@leading_f_position
	*then
		hear look north, look at north {
			-> leading_f_north
		}

		hear look east, look at east {
			-> leading_f_east
		}

		hear look south, look at south, go south, go to south {
			-> leading_f_south
		}

		hear look west, look at west {
			-> leading_f_west
		}
		
		hear go north, go to north {
			-> leading_j_goto
		}
		
		hear go east, go to east {
			-> leading_g_goto
		}
		
		hear go west, go to west {
			-> leading_e_goto
		}
	*recap
		You can look east, look south, look west and look north. [Action]
	*reprompt
		You can look east, look south, look west and look north. [Action]

@leading_f_north
	*say
		You are looking north. [DirSound_MRight]
	*then
		-> leading_f_position

@leading_f_east
	*say
		You are looking east. [DirSound_MLeft]
	*then
		-> leading_f_position

@leading_f_south
	*say
		You are looking south. [DirSound_Small] A dead forest blocks the way.
	*then
		-> leading_f_position

@leading_f_west
	*say
		You are looking west. [DirSound_Small]
	*then
		-> leading_f_position

//Node _g_

@leading_g_goto
	*say
		[Footsteps] Couple minutes later. You come to a new spot.
	*then
		-> leading_g_position

@leading_g_position
	*then
		hear look north, look at north {
			-> leading_g_north
		}

		hear look east, look at east {
			-> leading_g_east
		}

		hear look south, look at south {
			-> leading_g_south
		}

		hear look west, look at west {
			-> leading_g_west
		}
		
		hear go north, go to north {
			-> leading_g_north
		}
		
		hear go east, go to east {
			-> leading_h_goto
		}
		
		hear go south, go to south {
			-> leading_c_goto
		}
		
		hear go west, go to west {
			-> leading_f_goto
		}
	*recap
		You can look east, look south, look west and look north. [Action]
	*reprompt
		You can look east, look south, look west and look north. [Action]

@leading_g_north
	*say
		You are looking north. [DirSound_Large] A pond of water blocks the way. Look across the pond, you can almost see something different.
	*then
		-> leading_g_position

@leading_g_east
	*say
		You are looking east. [DirSound_MLeft]
	*then
		-> leading_g_position

@leading_g_south
	*say
		You are looking south. [DirSound_Small]
	*then
		-> leading_g_position

@leading_g_west
	*say
		You are looking west. [DirSound_MRight]
	*then
		-> leading_g_position

//Node _h_

@leading_h_goto
	*say
		[Footsteps] Couple minutes later. You come to a new spot.
	*then
		-> leading_h_position

@leading_h_position
	*then
		hear look north, look at north {
			-> leading_h_north
		}

		hear look east, look at east {
			-> leading_h_east
		}

		hear look south, look at south {
			-> leading_h_south
		}

		hear look west, look at west {
			-> leading_h_west
		}
		
		hear go north, go to north {
			-> leading_l_goto
		}
		
		hear go east, go to east {
			-> leading_e_east
		}
		
		hear go south, go to south {
			-> leading_d_goto
		}
		
		hear go west, go to west {
			-> leading_g_goto
		}
	*recap
		You can look east, look south, look west and look north. [Action]
	*reprompt
		You can look east, look south, look west and look north. [Action]

@leading_h_north
	*say
		You are looking north. [DirSound_MLeft]
	*then
		-> leading_h_position

@leading_h_east
	*say
		You are looking east. [DirSound_Small] You see the outer edge of the sandstorm. That's definitely now the right way. 
	*then
		-> leading_h_position

@leading_h_south
	*say
		You are looking south. [DirSound_Small]
	*then
		-> leading_h_position

@leading_h_west
	*say
		You are looking west. [DirSound_MRight]
	*then
		-> leading_h_position

//Node _i_

@leading_i_goto
	*say
		[Footsteps] Couple minutes later. You come to a new spot.
	*then
		-> leading_i_position

@leading_i_position
	*then
		hear look north, look at north {
			-> leading_i_north
		}

		hear look east, look at east {
			-> leading_i_east
		}

		hear look south, look at south {
			-> leading_i_south
		}

		hear look west, look at west {
			-> leading_i_west
		}
		
		hear go north, go to north {
			-> leading_m_goto
		}
		
		hear go east, go to east {
			-> leading_j_goto
		}
		
		hear go south, go to south {
			-> leading_e_goto
		}
		
		hear go west, go to west {
			-> leading_i_west
		}
	*recap
		You can look east, look south, look west and look north. [Action]
	*reprompt
		You can look east, look south, look west and look north. [Action]

@leading_i_north
	*say
		You are looking north. [DirSound_MRight]
	*then
		-> leading_i_position

@leading_i_east
	*say
		You are looking east. [DirSound_Large]
	*then
		-> leading_i_position

@leading_i_south
	*say
		You are looking south. [DirSound_MLeft]
	*then
		-> leading_i_position

@leading_i_west
	*say
		You are looking west. [DirSound_Small] You see the outer edge of the sandstorm. That's definitely now the right way.
	*then
		-> leading_i_position

//Node _j_

@leading_j_goto
	*say
		[Footsteps] Couple minutes later. You come to a new spot.
	*then
		-> leading_j_position

@leading_j_position
	*then
		hear look north, look at north {
			-> leading_j_north
		}

		hear look east, look at east {
			-> leading_j_east
		}

		hear look south, look at south {
			-> leading_j_south
		}

		hear look west, look at west {
			-> leading_j_west
		}
		
		hear go north, go to north {
			-> leading_j_north
		}
		
		hear go east, go to east {
			-> leading_j_east
		}
		
		hear go south, go to south {
			-> leading_f_goto
		}
		
		hear go west, go to west {
			-> leading_i_goto
		}
	*recap
		You can look east, look south, look west and look north. [Action]
	*reprompt
		You can look east, look south, look west and look north. [Action]

@leading_j_north
	*say
		You are looking north. [DirSound_MRight] A large field of marsh blocks the way.
	*then
		-> leading_j_position

@leading_j_east
	*say
		You are looking east. [DirSound_Large] A long hill blocks the way.
	*then
		-> leading_j_position

@leading_j_south
	*say
		You are looking south. [DirSound_MLeft]
	*then
		-> leading_j_position

@leading_j_west
	*say
		You are looking west. [DirSound_Small]
	*then
		-> leading_j_position

//Node _l_

@leading_l_goto
	*say
		[Footsteps] Couple minutes later. You come to a new spot.
	*then
		-> leading_l_position

@leading_l_position
	*then
		hear look north, look at north {
			-> leading_l_north
		}

		hear look east, look at east {
			-> leading_l_east
		}

		hear look south, look at south {
			-> leading_l_south
		}

		hear look west, look at west {
			-> leading_l_west
		}
		
		hear go north, go to north {
			-> leading_p_goto
		}
		
		hear go east, go to east {
			-> leading_l_east
		}
		
		hear go south, go to south {
			-> leading_h_goto
		}
		
		hear go west, go to west {
			-> leading_find_oasis
		}
	*recap
		You can look east, look south, look west and look north. [Action]
	*reprompt
		You can look east, look south, look west and look north. [Action]

@leading_l_north
	*say
		You are looking north. [DirSound_MLeft]
	*then
		-> leading_l_position

@leading_l_east
	*say
		You are looking east. [DirSound_Small] You see the outer edge of the sandstorm. That's definitely now the right way.
	*then
		-> leading_l_position

@leading_l_south
	*say
		You are looking south. [DirSound_MRight]
	*then
		-> leading_l_position

@leading_l_west
	*say
		You are looking west. [DirSound_Large]
	*then
		-> leading_l_position

//Node _m_

@leading_m_goto
	*say
		[Footsteps] Couple minutes later. You come to a new spot.
	*then
		-> leading_m_position

@leading_m_position
	*then
		hear look north, look at north {
			-> leading_m_north
		}

		hear look east, look at east {
			-> leading_m_east
		}

		hear look south, look at south {
			-> leading_m_south
		}

		hear look west, look at west {
			-> leading_m_west
		}
		
		hear go north, go to north {
			-> leading_m_north
		}
		
		hear go east, go to east {
			-> leading_n_goto
		}
		
		hear go south, go to south {
			-> leading_i_goto
		}
		
		hear go west, go to west {
			-> leading_m_west
		}
	*recap
		You can look east, look south, look west and look north. [Action]
	*reprompt
		You can look east, look south, look west and look north. [Action]

@leading_m_north
	*say
		You are looking north. [DirSound_Small] You see the outer edge of the sandstorm. That's definitely now the right way.
	*then
		-> leading_m_position

@leading_m_east
	*say
		You are looking east. [DirSound_MRight]
	*then
		-> leading_m_position

@leading_m_south
	*say
		You are looking south. [DirSound_MLeft]
	*then
		-> leading_m_position

@leading_m_west
	*say
		You are looking west. [DirSound_Small] You see the outer edge of the sandstorm. That's definitely now the right way.
	*then
		-> leading_m_position

//Node _n_

@leading_n_goto
	*say
		[Footsteps] Couple minutes later. You come to a new spot.
	*then
		-> leading_n_position

@leading_n_position
	*then
		hear look north, look at north {
			-> leading_n_north
		}

		hear look east, look at east {
			-> leading_n_east
		}

		hear look south, look at south {
			-> leading_n_south
		}

		hear look west, look at west {
			-> leading_n_west
		}
		
		hear go north, go to north {
			-> leading_n_north
		}
		
		hear go east, go to east {
			-> leading_o_goto
		}
		
		hear go south, go to south {
			-> leading_n_south
		}
		
		hear go west, go to west {
			-> leading_m_goto
		}
	*recap
		You can look east, look south, look west and look north. [Action]
	*reprompt
		You can look east, look south, look west and look north. [Action]

@leading_n_north
	*say
		You are looking north. [DirSound_Small] You see the outer edge of the sandstorm. That's definitely now the right way.
	*then
		-> leading_n_position

@leading_n_east
	*say
		You are looking east. [DirSound_MRight]
	*then
		-> leading_n_position

@leading_n_south
	*say
		You are looking south. [DirSound_MLeft] A large field of marsh blocks the way.
	*then
		-> leading_n_position

@leading_n_west
	*say
		You are looking west. [DirSound_Small]
	*then
		-> leading_n_position

//Node _o_

@leading_o_goto
	*say
		[Footsteps] Couple minutes later. You come to a new spot.
	*then
		-> leading_o_position

@leading_o_position
	*then
		hear look north, look at north {
			-> leading_o_north
		}

		hear look east, look at east {
			-> leading_o_east
		}

		hear look south, look at south {
			-> leading_o_south
		}

		hear look west, look at west {
			-> leading_o_west
		}
		
		hear go north, go to north {
			-> leading_o_north
		}
		
		hear go east, go to east {
			-> leading_p_goto
		}
		
		hear go south, go to south {
			-> leading_find_oasis
		}
		
		hear go west, go to west {
			-> leading_n_goto
		}
	*recap
		You can look east, look south, look west and look north. [Action]
	*reprompt
		You can look east, look south, look west and look north. [Action]

@leading_o_north
	*say
		You are looking north. [DirSound_Small] You see the outer edge of the sandstorm. That's definitely now the right way.
	*then
		-> leading_o_position

@leading_o_east
	*say
		You are looking east. [DirSound_MRight]
	*then
		-> leading_o_position

@leading_o_south
	*say
		You are looking south. [DirSound_Large]
	*then
		-> leading_o_position

@leading_o_west
	*say
		You are looking west. [DirSound_MLeft]
	*then
		-> leading_o_position

//Node _p_

@leading_p_goto
	*say
		[Footsteps] Couple minutes later. You come to a new spot.
	*then
		-> leading_p_position

@leading_p_position
	*then
		hear look north, look at north {
			-> leading_p_north
		}

		hear look east, look at east {
			-> leading_p_east
		}

		hear look south, look at south {
			-> leading_p_south
		}

		hear look west, look at west {
			-> leading_p_west
		}
		
		hear go north, go to north {
			-> leading_p_north
		}
		
		hear go east, go to east {
			-> leading_p_east
		}
		
		hear go south, go to south {
			-> leading_l_goto
		}
		
		hear go west, go to west {
			-> leading_o_goto
		}
	*recap
		You can look east, look south, look west and look north. [Action]
	*reprompt
		You can look east, look south, look west and look north. [Action]

@leading_p_north
	*say
		You are looking north. [DirSound_Small] You see the outer edge of the sandstorm. That's definitely now the right way.
	*then
		-> leading_p_position

@leading_p_east
	*say
		You are looking east. [DirSound_Small] You see the outer edge of the sandstorm. That's definitely now the right way.
	*then
		-> leading_p_position

@leading_p_south
	*say
		You are looking south. [DirSound_MRight]
	*then
		-> leading_p_position

@leading_p_west
	*say
		You are looking west. [DirSound_MLeft]
	*then
		-> leading_p_position

@leading_find_oasis
	*say
		Your sight becomes clear. You see the oasis.
	*then
	    -> Arrival At The Inner Cave



// cowplant puzzle---------------------------------------------------------------------------------------------

@cowplant_puzzle_start
	*say
		You wake up finding yourself in a tent. The sunlight sprinkles on your face through the small holes in the ceiling. As you slowly gain consciousness, you hear a strange shouting coming from outside.<audio src='https://koetest.s3.amazonaws.com/Act3/manscream_01.mp3'/> But before you get the sound, it's strange enough that you ended up in this tent. What's inside this tent?
	*recap
		You can look around.
	*reprompt
		You can look around.
	*then
		hear look around {
			-> cowplant_puzzle_tent_around_tutorial
		}

@cowplant_puzzle_tent_around_tutorial
	*say
		Surprisingly, it's a fairly large tent, and a messy one. Books and papers are scattered everywhere on the floor. There is also a cabinet full of plants and seeds and mysterious materials contained in vials and glass jars. A leather book that reads Cowplant Observation Notes is present on the small table beside it. That's pretty much it in the tent.  And then you hear another sound. <audio src='https://koetest.s3.amazonaws.com/Act3/cowplantThrowOut.mp3'/> What's outside?
	*recap
		You should go outside.
	*then
		hear go outside {
			-> cowplant_puzzle_outside_around_tutorial
		}
	*reprompt
		You should go outside.

@cowplant_puzzle_outside_around_tutorial
	*say
		As you exit the tent, you see the familiar, infinite desert. Oh. You're still in the desert. As you look back at the tent, you immediately noticed a strange plant. This plant is the size of a big refrigerator, and it has a mouth. That's right, a mouth. A man is lying on the ground, fainted.
	*then
		-> cowplant_puzzle_outside_interaction

@cowplant_puzzle_outside_interaction
	*say
		
	*recap
		You can look at different things, look around, or go to the tent. [Action]
	*reprompt
		You can look at different things, look around, or go to the tent. [Action]
	*then
		hear look around, look around me {
		    if wakeman {
		        -> cowplant_puzzle_outside_around_noman
		    }
			-> cowplant_puzzle_outside_around_man
		}
		hear look at the man {
		    if wakeman{
		        -> cowplant_puzzle_outside_view_man_gone
		    }
			-> cowplant_puzzle_outside_view_man
		}

		hear wake up the man {
		    flag wakeman
			-> cowplant_puzzle_outside_wake_man
		}

		hear look at the plant {
		    flag viewplant
			-> cowplant_puzzle_outside_view_plant
		}

		hear interact with the plant {
			-> cowplant_puzzle_cowplant_interact
		}

		hear look at the basket, look at the swordfish {
			-> cowplant_puzzle_outside_view_basket
		}

		hear look at the stereo {
			-> cowplant_puzzle_outside_view_stereo
		}

		hear turn on the stereo {
			-> cowplant_puzzle_outside_stereo_on
		}

		hear go to the tent {
		    if getmilk and wakeman{
		        -> cowplant_puzzle_tent_getmilk
		    }
			-> cowplant_puzzle_tent_goto
		}
		hear open the notebook {
		    set currentplace to 1
			if !getnotebook{
		        -> cowplant_puzzle_tent_nonote
		    }
			-> cowplant_puzzle_notebook_open
		}

		hear look at the tent {
			-> cowplant_puzzle_outside_view_tent
		}

@cowplant_puzzle_cowplant_interact
	*say
		What do you want to do to the plant? [Action]
	*then
		-> cowplant_puzzle_cowplant_interaction

@cowplant_puzzle_outside_view_man_gone
	*say
		You look at the man. He is already gone to the tent. You can probably go to the tent to find him.
	*then
		-> cowplant_puzzle_outside_interaction

@cowplant_puzzle_outside_view_tent
	*say
		You look at the tent. That's the tent you came from. You can go to the tent at anytime.
	*then
		-> cowplant_puzzle_outside_interaction

@cowplant_puzzle_tent_goto
	*say
		You go to the tent.
	*then
		-> cowplant_puzzle_tent_interaction

@cowplant_puzzle_tent_interaction
	*say
		
	*then
		hear look around {
		    if wakeman {
			    -> cowplant_puzzle_tent_around_man
			}
			
			-> cowplant_puzzle_tent_around_noman
		}

		hear look at the man {
		    if !wakeman{
		        -> cowplant_puzzle_tent_view_man_out
		    }
			-> cowplant_puzzle_tent_view_man
		}
		hear look at the notebook, look at the note, look at the book, look at the observation {
		    if getnotebook{
		        -> cowplant_puzzle_tent_note_already
		    }
			-> cowplant_puzzle_tent_view_notebook
		}
		hear pick up the notebook, pick up the note, pick up the book {
		    if getnotebook{
		        -> cowplant_puzzle_tent_note_already
		    }
		    flag getnotebook
		    set currentplace to 0
			-> cowplant_puzzle_tent_pickup_notebook
		}
		hear open the notebook {
		    set currentplace to 0
		    if !getnotebook{
		        -> cowplant_puzzle_tent_nonote
		    }
			-> cowplant_puzzle_notebook_open
		}
		hear go outside {
			-> cowplant_puzzle_outside_go
		}
		hear look at the door {
			-> cowplant_puzzle_tent_view_door
		}

	*recap
		You can look around, look at different things, or go outside. [Action]
	*reprompt
		You can look around, look at different things, or go outside. [Action]

@cowplant_puzzle_tent_note_already
	*say
		You already pucked up the notebook. You can search keywords by open notebook.
	*then
	    -> cowplant_puzzle_tent_interaction

@cowplant_puzzle_tent_view_man_out
	*say
		You try to look at the man. But then you realize that he is still lying outside. You should probably go outside t o wake him up.
	*then
		-> cowplant_puzzle_tent_interaction

@cowplant_puzzle_tent_view_door
	*say
		You look at the door. It leads to outside. You can go outside as you want.
	*then
		-> cowplant_puzzle_tent_interaction

@cowplant_puzzle_outside_go
	*say
		You go outside
	*then
		-> cowplant_puzzle_outside_interaction

@cowplant_puzzle_notebook_open
	*say
		You open the notebook.<audio src='https://koetest.s3.amazonaws.com/Act5/Act+5+puzzle/openbook_01.mp3'/> What keyword do you want to search?
	*then
		-> cowplant_puzzle_notebook_seedtrader

@cowplant_puzzle_tent_nonote
	*say
		You didn't pick up a notebook yet
	*then
		if currentplace is 0 {
			    -> cowplant_puzzle_tent_interaction
			}
		if currentplace is 1 {
		        -> cowplant_puzzle_outside_interaction
		    }

@cowplant_puzzle_tent_pickup_notebook
	*say
		You grab the notebook. It is heavy. Dozens of bookmarks are stuck on different pages. To look into details you can open the notebook.
	*recap
		To look into details you can open the notebook.
	*reprompt
		To look into details you can open the notebook.
	*then
		hear open the notebook {
			-> cowplant_puzzle_grab_notebook
		}

@cowplant_puzzle_tent_view_notebook
	*say
		You look at the notebook. It’s thick and heavy. Dozens of bookmarks are sticking on pages. You can pick up the notebook as you want.
	*then
		-> cowplant_puzzle_tent_interaction

@cowplant_puzzle_tent_view_man
	*say
		You look at the man. He is sitting in front of the table. Looking at nowhere. His eyes are out of focus. You should ask what happened. [Conversation]
	*then
		hear what happened {
			-> cowplant_puzzle_tent_view_man_talk
		}

@cowplant_puzzle_tent_view_man_talk
	*say
		He is muttering no sense words. You probably need to figure out what happened to him by yourself. And hopefully you can find how to cure him. Possiblly from the notebook?
	*then
		-> cowplant_puzzle_tent_interaction

@cowplant_puzzle_tent_around_noman
	*say
		You are in a messy tent. A leather book that reads Cowplant Observation Notes is present on the small table.
	*then
		-> cowplant_puzzle_tent_interaction

@cowplant_puzzle_tent_around_man
	*say
		You are in a messy tent. A man is sitting in front of a  small table. A leather book that reads Cowplant Observation Notes is present on it. Behind you, it's the door.
	*then
		-> cowplant_puzzle_tent_interaction

@cowplant_puzzle_outside_stereo_on
	*say
		You turn on the stereo. <audio src='https://koetest.s3.amazonaws.com/Act3/Act3+puzzle/radio.mp3'/> Oh, my, god. The plant is swagging along the music.
	*then
		-> cowplant_puzzle_outside_interaction

@cowplant_puzzle_outside_view_stereo
	*say
		You look at the stereo. It is placed on the ground beside the plant. Looks like someone listens to it frequently.
 You can turn on the stereo.
	*then
		-> cowplant_puzzle_outside_interaction

@cowplant_puzzle_outside_view_basket
	*say
		You look at the basket of swordfish on the corner. It seems like someone is feeding this creature by swordfish. You can probably interact with the plant, to feed it.
	*then
		-> cowplant_puzzle_outside_interaction

@cowplant_puzzle_cowplant_interaction
	*say
		
	*recap
		If you don't know what to do to it, you should probably leave and come back later.[Action]
	*reprompt
		You an do anything to the cowplant, or you can leave. If you don't know what to do to it, you should probably leave to explore more and come back later.[Action]
	*then
		hear play with the plant, play with it, play {
			-> cowplant_puzzle_plant_play
		}
		hear feed the cowplant, feed it, feed, feed the plant {
			-> cowplant_puzzle_plant_feed
		}
		hear milk the cowplant, milk the plant, milk, milk it {
		    flag getmilk
			-> cowplant_puzzle_plant_milk
		}
		hear grab the cake, go for the cake, take the cake, look into the cake {
			-> cowplant_puzzle_plant_cake
		}
		hear leave {
			-> cowplant_puzzle_outside_interaction
		}

@cowplant_puzzle_outside_view_plant
	*say
		You look at the plant. It is a bizarre plant.  It has a cow head but roots of plants. A bell is hanging on its stem, or, you should say, neck. Staring closer at the plant, a tinny label is taped on, reads, cow-plant. It is waving as it is attracting your attention. It sticks out its tongue to you, and the weirdest thing is, the tongue is a cake! You can do anything to the cowplant by saying, interact with the plant. If you don't know what to do to the plant, you should probably go look around first.
	*then
		-> cowplant_puzzle_outside_interaction

@cowplant_puzzle_outside_wake_man
	*say
		You wake up the man. He stares at you for a second and walks straight to the tent. He is muttering some nosense words. You wonder if he is the one who saved you from the sandstorm, and what damaged his mind. You can probably go to the tent to discover more, or you can look at other things.
	*then
		-> cowplant_puzzle_outside_interaction

@cowplant_puzzle_outside_view_man
	*say
		You look at the man. He is fainted, and lying on the ground. He is wet and smelly. Some sort of liquid sticks on all of his body. You can wake up the man.
	*then
		-> cowplant_puzzle_outside_interaction

@cowplant_puzzle_outside_around_man
	*say
		You look around. You are outside. Looking at far away, you can only see the infinite desert. In front of you, there is a tent, and a plant. A man is lying on the ground. Besides the plant, there is a basket of swordfish, and a stereo.
	*then
		-> cowplant_puzzle_outside_interaction

@cowplant_puzzle_outside_around_noman
	*say
		You look around. You are outside. Looking at far away, you can only see the infinite desert. In front of you, there is a tent, and a plant. Besides the plant, there is a basket of swordfish, and a stereo.
	*then
		-> cowplant_puzzle_outside_interaction

@cowplant_puzzle_tent_getmilk
	*say
		You go to the tent. The man is still stumbled. You forced him to drink the milk. [SeedTrader]Ahhh... What is that! en... Thanks. You bring me back![EOA]
	*then
		hear go to scene cowplant_puzzle_tent_getmilk_1 {
			-> cowplant_puzzle_end_connect_to_act_three
		}

@cowplant_puzzle_end_connect_to_act_three
	*say
	
	*then
	    -> MysMan Introduces Himself

@cowplant_puzzle_plant_milk
	*say
		You milk the plant, <audio src='https://koetest.s3.amazonaws.com/Act3/milkingCowplant.mp3'/> and get a bottle of potion. That's it! That is the potion which can heal the man.
	*then
		-> cowplant_puzzle_cowplant_interaction

@cowplant_puzzle_plant_cake
	*say
		You go for the cake but then you find that grabing its cake tongue is too disgusting to do.
	*then
		-> cowplant_puzzle_outside_interaction

@cowplant_puzzle_plant_play
	*say
		You play with the cowplant.<audio src='https://koetest.s3.amazonaws.com/Act3/cowHappy.mp3'/> It seems happy.
	*then
		-> cowplant_puzzle_cowplant_interaction

@cowplant_puzzle_plant_feed
	*say
		You picked up a swordfish from the basket and feed the plant with it. <audio src='https://koetest.s3.amazonaws.com/Act3/cowplantSounds_01.mp3'/>
	*then
		-> cowplant_puzzle_outside_interaction

@cowplant_puzzle_grab_notebook
	*say
		You open the notebook. You wonder what cowplant is. So, you find the bookmark that reads, Introduction, and you flip the notebook to that page. It reads. Cowplant is a bizarre, partly bovine form of vegetation. It usually has 4 growth states. You can search for any keyword that you found from the previous pages. For example, try to say, search growth states.
	*then
		hear search growth states {
			-> cowplant_puzzle_notebook_seedtrader_states_tutorial
		}

@cowplant_puzzle_notebook_seedtrader
	*say
		
	*then
		hear baby {
			-> cowplant_puzzle_notebook_seedtrader_baby
		}

		hear mature {
			-> cowplant_puzzle_notebook_seedtrader_mature
		}

		hear state, states {
			-> cowplant_puzzle_notebook_seedtrader_states
		}

		hear feed {
			-> cowplant_puzzle_notebook_seedtrader_feed
		}

		hear cake, tongue, cake tongue {
			-> cowplant_puzzle_notebook_seedtrader_cake
		}

		hear eat, swallow {
			-> cowplant_puzzle_notebook_seedtrader_swallow
		}

		hear milk {
			-> cowplant_puzzle_notebook_seedtrader_milk
		}

		hear death {
			-> cowplant_puzzle_notebook_seedtrader_death
		}
		hear hungry {
			-> cowplant_puzzle_notebook_seedtrader_hungry
		}

		hear cowplant berry, berry {
			-> cowplant_puzzle_notebook_seedtrader_berry
		}
		hear sprout stage, sprout {
			-> cowplant_puzzle_notebook_seedtrader_sprout
		}
		hear allergic symtoms, allergic  {
			-> cowplant_puzzle_notebook_seedtrader_allergic
		}
		hear dementia, severe dementia {
			-> cowplant_puzzle_notebook_seedtrader_dementia
		}
		hear devour {
			-> cowplant_puzzle_notebook_seedtrader_devour
		}
		hear close the notebook {
		    -> cowplant_puzzle_notebook_close
		}
	*reprompt
		What keyword do you want to search? You can search for any keyword that you found from the previous pages. Or you can close the notebook if you are finish searching.[Action]
	*recap
		You can't find that bookmark.

@cowplant_puzzle_notebook_seedtrader_devour
	*say
		You searched the keyword, devour, and opened up the notebook from that bookmark. If a person attempts to take the cake again, the cowplant will devour them. Which means, they are killed forever.
	*then
		-> cowplant_puzzle_notebook_seedtrader

@cowplant_puzzle_notebook_seedtrader_dementia
	*say
		You searched the keyword, severe dementia, and opened up the notebook from that bookmark. It reads. Allergic to cowplant can possiblly cause severe dementia to certain people. Syptoms include eyes out of focus, memery lost, and loss of ability to speak. Drinking the cowplant milk will release the bad mood, as the same time, cure the allergic symtoms.
	*then
		-> cowplant_puzzle_notebook_seedtrader

@cowplant_puzzle_notebook_seedtrader_allergic
	*say
		You searched the keyword, allergic symtoms, and opened up the notebook from that bookmark. It reads. A few people are allergic to be swallowed by the cowplant. Allergic symtoms are different from person to person. Possiblly causing severe dementia to certain people.
	*then
		-> cowplant_puzzle_notebook_seedtrader

@cowplant_puzzle_notebook_seedtrader_sprout
	*say
		You searched the keyword, sprout, and opened up the notebook from that bookmark. It reads.
 When you plant a Cowplant Berry, there are tiny horns appearing through the soil.
	*then
		-> cowplant_puzzle_notebook_seedtrader

@cowplant_puzzle_notebook_seedtrader_berry
	*say
		You searched the keyword, cowplant berry, and opened up the notebook from that bookmark. It reads. Cowplant berry is a black and white berry. Once you plant the cowplant berry into the soil, it will gow up as a sprout stage cowplant.
	*then
		-> cowplant_puzzle_notebook_seedtrader

@cowplant_puzzle_notebook_seedtrader_hungry
	*say
		You searched the keyword, hungry, and opened up the notebook from that bookmark. It reads.
When cowplant is hungry, it will stick its cake tongue out. You can feed them at this moment. Cowplant will swallow whoever go for the cake.
	*then
		-> cowplant_puzzle_notebook_seedtrader

@cowplant_puzzle_notebook_seedtrader_death
	*say
		You searched the keyword, death state, and opened up the notebook from that bookmark. It reads. Twelve hours after a Cowplant shows its cake tongue, and is not fed, it will die, A dead Cowplant has a dead stem with a hanging Cowplant skull. Cowplants cannot be saved after this stage.
	*then
		-> cowplant_puzzle_notebook_seedtrader

@cowplant_puzzle_notebook_seedtrader_milk
	*say
		You searched the keyword, milk, and opened up the notebook from that bookmark. It reads. If people were swallowed for the first time, the cowplant will produce milk. Milking a cowplant, you will get a potion to release the mood, and give the emotions back to the patient. The study found, drinking the milk can also cure the allergic symptoms.
	*then
		-> cowplant_puzzle_notebook_seedtrader

@cowplant_puzzle_notebook_seedtrader_swallow
	*say
		You search the bookmark that writes, swallow, and opened up from that page. It reads.
When a person is swallowed for the first time, the Cowplant will spit them out, and they will recieve a drained mood, which will last two days. The mood
will make people feels like an emotionless shell. Different allergic symptoms causing by swallowed have been found to a few people. If attempt to go for the cake again, the cowplant will devour them. But, if people survive from the first swallowing, the cowplant will produce milk.
	*then
		-> cowplant_puzzle_notebook_seedtrader

@cowplant_puzzle_notebook_seedtrader_cake
	*say
		You searched the keyword, cake tongue, and opened up the notebook from that bookmark. It reads. Cowplant has a cake shaped tongue. When it is hungry, it will stick its tongue out to attract people's attention, so cowplant can swallow them.
	*then
		-> cowplant_puzzle_notebook_seedtrader

@cowplant_puzzle_notebook_seedtrader_feed
	*say
		You searched the keyword, feed, and opened up the notebook from that bookmark. It reads. A Cowplant can  be fed  by meat when its hungry and its cake- shape- tongue sticks out.
	*then
		-> cowplant_puzzle_notebook_seedtrader

@cowplant_puzzle_notebook_seedtrader_states
	*say
		You searched the keyword, growth states, and opened up the notebook from that bookmark. It reads. Cowplants usually have three growth states, and can die. They are sprout state, baby state, mature state, and death state.
	*then
		-> cowplant_puzzle_notebook_seedtrader

@cowplant_puzzle_notebook_seedtrader_states_tutorial
	*say
		You searched the keyword, growth states, and opened up the notebook from that bookmark. It reads. Cowplants usually have three growth states, and can die. They are sprout state, baby state, mature state, and death state. To finish searching, you should close the notebook.
	*then
		hear close the notebook {
			-> cowplant_puzzle_notebook_close
		}
	*recap
		To finish searching, you should close the notebook.
	*reprompt
		To finish searching, you should close the notebook.

@cowplant_puzzle_notebook_seedtrader_mature
	*say
		You searched the keyword, mature state, and opened up the notebook from that bookmark. It reads. In this stage, the Cowplant is fully matured. You can feed it, or at certain moment, you can milk it.
	*then
		-> cowplant_puzzle_notebook_seedtrader

@cowplant_puzzle_notebook_seedtrader_baby
	*say
		You searched the keyword, baby state, and opened up the notebook from that bookmark. It reads. A few days after you plant the cowplant berry. You can see a tiny cowplant. In this state, you can't do much things with it.
	*then
		-> cowplant_puzzle_notebook_seedtrader

@cowplant_puzzle_notebook_close
	*say
		You close the notebook. <audio src='https://koetest.s3.amazonaws.com/Act5/Act+5+puzzle/closebook_01.mp3'/>
	*then
		if currentplace is 0 {
		    -> cowplant_puzzle_tent_interaction
		}
		if currentplace is 1 {
		    -> cowplant_puzzle_outside_interaction
		}

//escape hut puzzle --------------------------------------------------------------------------------------------------------

@escape_puzzle_intro
	*say
	    What should you do?
    *reprompt
        You have arrived at the cave, only to be locked in a small hut by a man with faded purple hair. The door seems to be stuck by something, so you're trapped inside. What should you do to get out?
    *recap
        You've been locked in the hut. Perhaps you should look around?
	*then
		hear look around, what's around me, check what's around me, anything around {
			-> escape_puzzle_around
		}

@escape_puzzle_around
	*say
		You looked around the small hut. In front of you, there is a table with some stuff stacked on top. Beside the table, you see a trash bin. Right across
 the table, there is a flower stand. On your right, there is a strange equipment that looks like a machine. And on your left, you see a chest. You can look at 
different things to see more details.
	*then
		set dirt to 0
		-> escape_puzzle_interaction

@escape_puzzle_interaction
	*recap
		You can view different things to see more details.
	*reprompt
		You can look at differen things to see more details.
	*then
		hear view the table, view table, look at the table, look at table, table, check the table, check table {
			-> escape_puzzle_view_table
		}
		hear view the notebook, view notebook, look at the notebook, look at notebook, notebook, check the notebook, check notebook {
			-> escape_puzzle_view_notebook
		}

		hear open notebook, open the notebook, open up the notebook {
			-> escape_puzzle_open_notebook
		}
		hear look around, what's around me, check what's around me, check around {
			-> escape_puzzle_around
		}
		hear view the chest, look at the chest, look at chest, view chest, check the chest, check chest {
			-> escape_puzzle_view_chest
		}

		hear view the box, view the metal box, look at the box, box, metal box, box, look at metal box, look at box, check the box, check metal box, check box {
			-> escape_puzzle_view_metalbox
		}

		hear view the trash bin, look at the trash bin, look at trash bin, check the trash bin, check trash bin {
			-> escape_puzzle_view_trash
		}

		hear view the newspaper, look at the newspaper, look at newspaper, check newspaper, check the newspaper, read newspaper, read the newspaper {
			-> escape_puzzle_view_newspaper
		}

		hear view the alcohol burner, look at the alcohol burner, look at alchohol burner, burner, alcohol burner, the burner, the alcohol burner {
			-> escape_puzzle_view_alcohollamp
		}

		hear view the wooden barrel, view the barrel, looka at the barrel, look at the wooden barrel, look at wooden barrel, look at barrel {
			-> escape_puzzle_view_barrel
		}

		hear view the portal, look at the portal, look at portal, check the portal, check portal {
		    if insertwand{
		        -> escape_puzzle_view_portal_wand
		    }
			-> escape_puzzle_view_portal
		}

		hear view the flower stand, view flower stand, look at flower stand, look at stand, look at the stand, look at the flower stand {
		    if readportal{
		        -> escape_puzzle_vew_flower_dirt
		  }
			-> escape_puzzle_view_flower
		}

		hear heat up the metal box, heat up the wand, heat up the box, use the alcohol lamp on the metal box, use the metal box on the alcohol lamp {
		    if getwand{
		        -> escape_puzzle_damage_wand
		    }
			-> escape_puzzle_heatup_metalbox
		}
		hear freeze the metal box, freeze the box, freeze the wand, use the metal box on the barrel, put the metal box into the barrel {
		      if getwand{
		        -> escape_puzzle_damage_wand
		    }
			-> escape_puzzle_freeze_metalbox
		}

		hear stand on the portal, stand on portal {
		    if insertwand and dirt!=0 { 
		        -> escape_puzzle_stand_portal_ready
	    	}
		    if insertwand{
		       -> escape_puzzle_stand_portal_nodirt
	    	}
		    -> escape_puzzle_stand_portal_nothing
		}

		hear insert the wand to the portal, insert the wand to the hole, insert the wand into the hole, insert the wand into the portal, on the wand on the portal, use the wand on the hole {
		    if getwand{
			-> escape_puzzle_insert_wand
			}
			-> escape_puzzle_interaction
		}

		hear freeze the notebook, use the notebook on the barrel, use the notebook on the ice, put the notebook into the ice {
			-> escape_puzzle_freeze_note
		}

		hear heat up the notebook, heat the notebook, use the notebook on the alcohol lamp, use the notebook on the lamp, burn the notebook {
			-> escape_puzzle_heat_note
		}

		hear heat up the barrel, heat barrel, use the barrel on the alcohol lamp, use the barrel on the lamp {
			-> escape_puzzle_heat_barrel
		}

		hear freeze the alcohol lamp, freeze the lamp, use the lamp on the barrel, put the lamp in the barrel  {
			-> escape_puzzle_freeze_lamp
		}

		hear insert the metal box into the hole, use the metal box on the hole, use the box on the hole {
			-> escape_puzzle_insert_metalbox
		}

		hear insert the notebook into the hole, use the notebook on the hole {
			-> escape_puzzle_insert_note
		}
		
		hear grab the dirt from number two pot, grab the dirt from black berry, two, take dirt from pot number two, take the dirt from pot number two, grab dirt from pot number two, grab the dirt from pot number two, take some dirt from pot number two, take some dirt from number two {
			-> escape_puzzle_vew_flower_dirt_2
		}

		hear grab the dirt from number three pot, grab the dirt from mandrake, three, take dirt from pot number three, take the dirt from pot number three, grab dirt from pot number three, grab the dirt from pot number three, take some dirt from pot number three, take some dirt from number three {
			-> escape_puzzle_vew_flower_dirt_3
		}
		hear grab the dirt from number one pot, grab the dirt from fang flower, one, take dirt from put number one, take the dirt from put number one, grab dirt from put number one, grab the dirt from put number one, take some dirt from pot number one, take some dirt from number one {
			-> escape_puzzle_vew_flower_dirt_1
		}
		
		hear grab dirt{
		    -> escape_puzzle_grab_dirt
		}

		hear use the flower on the machine, use the barrel on the portal {
			-> escape_puzzle_insert_wrong
		}
@escape_puzzle_insert_wrong
	*say
		You tried to insert it into the portal, but it doesn't fit.

@escape_puzzle_insert_note
	*say
		You insert the notebook into the portal. It obviously doesn’t go there.
	*then
		-> escape_puzzle_interaction

@escape_puzzle_insert_metalbox
	*say
		You insert the metal box into the portal. It doesn’t seem to fit in the hole. But what about the wand inside?
	*then
		-> escape_puzzle_interaction

@escape_puzzle_freeze_lamp
	*say
		You want to freeze the alcohol burner, but putting an alcohol burner into ice water will either do nothing or damage it.
	*then
		-> escape_puzzle_interaction

@escape_puzzle_heat_barrel
	*say
		You heat up the barrel. But a little alcohol burner will do nothing to a large barrel of ice water.
	*then
		-> escape_puzzle_interaction

@escape_puzzle_heat_note
	*say
		You want to heat up the notebook, but then you realize that it will set the notebook on fire. It probably isn't a good idea to set the house on fire.
	*then
		-> escape_puzzle_interaction

@escape_puzzle_freeze_note
	*say
		It's probably not a good idea to freeze someone's notebook. You'll probably destroy it.
	*then
		-> escape_puzzle_interaction

@escape_puzzle_damage_wand
	*say
		You already got the wand out of the metal box. Either heating up the wand or freezing the wand will damage it. Don't do that.

@escape_puzzle_insert_wand
	*say
		You insert the wand into the portal. It fits into the hole perfectly. The inscriptions around the portal start to glow.
	*then
		flag insertwand
	    -> escape_puzzle_interaction

@escape_puzzle_stand_portal_ready
	*say
		You stand on the portal. The wand is reacting to the dirt in your hand.
	*recap
		You can say, teleport, or you can step back.
	*reprompt
		You can say, teleport, or you can step back.
	*then
		hear step back {
			-> escape_puzzle_stand_portal_stepback
		}
		
		hear teleport {
		    if dirt == 1{
			-> escape_puzzle_stand_portal_alien
			}
			if dirt == 2{
			-> escape_puzzle_stand_portal_out
			}
			if dirt == 3{
			-> escape_puzzle_stand_portal_realm
			}
		}

@escape_puzzle_stand_portal_out
	*say
		You are traveling through the portal. In a blink of an eye, you are standing in the inner cave. You made your way out!
	*then
	    -> Exit The Room

@escape_puzzle_stand_portal_realm
	*say
		//magic realm
		You are traveling through the portal. After a short time, you appear in a different space. You are on top of a floating island.
	*recap
		This is not the right place to go, you should travel back.
	*reprompt
		This is not the right place to go, you should travel back.
	*then
		hear travel back {
			-> escape_puzzle_stand_portal_travelback
		}

@escape_puzzle_stand_portal_alien
	*say
		//alien planet Sixam
		You are traveling through the portal. After a long time, you appear in a strange space. All the plant are glowing.
	*recap
		This is not the right place to go, you should travel back.
	*reprompt
		This is not the right place to go, you should travel back.
	*then
		hear travel back {
			-> escape_puzzle_stand_portal_travelback
		}

@escape_puzzle_stand_portal_travelback
	*say
		You travel back through the same tunnel.
	*then
		-> escape_puzzle_interaction

@escape_puzzle_stand_portal_stepback
	*say
		You step back from the portal.
	*then
		-> escape_puzzle_interaction

@escape_puzzle_stand_portal_nodirt
	*say
		You stand on the portal. The wand activates the portal, but nothing really happened. Seems like you are still missing something important to make it fully work. You step back from the portal. You may want to look for a description of this long distance travel portal from somewhere.
	*then
		-> escape_puzzle_interaction

@escape_puzzle_stand_portal_nothing
	*say
		You stand on portal. Nothing happened. It seems like you need to insert something into the hole to make it operate. You step back from the portal. You might need to find a full desciption of this long distance travel portal.
	*then
		-> escape_puzzle_interaction

@escape_puzzle_vew_flower_dirt
	*say
		You look at the flower stand. You see three pots with plants in them. The dirt in these pots look different to each other. Seems like someone carefully transplanted those vegetation with the dirt from their origins. From the left to the right, they are labeled as, number one,  Fang Flower, number two, Blackberry, and number three, Mandrake. You can take some dirt from one of these pots.
	*then
		-> escape_puzzle_interaction

@escape_puzzle_grab_dirt
	*say
		From the left to the right, they are labeled as, number one,  Fang Flower, number two, Blackberry, and number three, Mandrake. You can grab the dirt from any pot. Which number of pot do you want to grab the dirt from?
	*then
		hear grab the dirt from number two pot, grab the dirt from black berry, two {
			-> escape_puzzle_vew_flower_dirt_2
		}
		hear grab the dirt from number three pot, grab the dirt from mandrake, three {
			-> escape_puzzle_vew_flower_dirt_3
		}
		hear grab the dirt from number one pot, grab the dirt from fang flower, one {
			-> escape_puzzle_vew_flower_dirt_1
		}
		hear do nothing {
			-> escape_puzzle_interaction
		}
	*recap
		Which number of pot do you want to grab the dirt from? or you can do nothing.
	*reprompt
		Which number of pot do you want to grab the dirt from? or you can do nothing.

@escape_puzzle_vew_flower_dirt_3
	*say
		You grab the dirt from pot number three, mandrake, and hold it in your hand.
	*then
		set dirt to 3
	    -> escape_puzzle_interaction

@escape_puzzle_vew_flower_dirt_2
	*say
		You grab the dirt from pot number two, black berry, and hold it in your hand.
	*then
		set dirt to 2
	    -> escape_puzzle_interaction

@escape_puzzle_vew_flower_dirt_1
	*say
		You grab the dirt from pot number one, fang flower, and hold it in your hand.
	*then
		set dirt to 1
	    -> escape_puzzle_interaction

@escape_puzzle_box_break
	*say
		The metal box is broken. From the container, you retrieve a wand.
	*then
		flag getwand
	-> escape_puzzle_interaction

@escape_puzzle_heatup_metalbox
	*say
		You heat up the metalbox with the alcohol burner.
	*then
		flag heatbox
		if freezebox{
	        -> escape_puzzle_box_break
	   }
	    -> escape_puzzle_interaction

@escape_puzzle_freeze_metalbox
	*say
		You freeze the metalbox by putting it into the ice barrel.
	*then
		flag freezebox
		if heatbox{
		    -> escape_puzzle_box_break
		}
	    -> escape_puzzle_interaction

@escape_puzzle_view_flower
	*say
		You look at the flower stand. You see three pots with plants in them. The dirt in these pots look different to each other. Seems like someone carefully transplanted those vegetations with the dirts from their origins. From the left to the right, they are labeled as, number one,  Fang Flower, number two, Blackberry, and number three, Mandrake. You have no idea what you can do with those plants yet.
	*then
		-> escape_puzzle_interaction

@escape_puzzle_view_portal
	*say
		You look at the portal. The portal is a cirle on the floor with inscriptions that you can't understand painted around. The paintings lead to a hole on the floor just in front of the circle. Along with the hole is a little inscription that reads: long distance travel portal. It looks like something needs to be inserted into the hole to operate the portal. You can use anything on the portal, or stand on the portal.
		
	*then
		-> escape_puzzle_interaction

@escape_puzzle_view_portal_wand
	*say
		You look at the portal. The portal is a cirle on the floor with glowing inscriptions that you can't understand painted around. The paintings lead to a hole on the floor with a wand sticking into it. Along with the hole is a little inscription that reads: long distance travel portal. You may want to stand on the portal.
	*then
		-> escape_puzzle_interaction

@escape_puzzle_view_barrel
	*say
		You look at the wooden barrel. Removing the cover carefully. You see that it's filled up with ice. Where did he get so many ice in a cave in the middle of a desert? You can use anything on the barrel to freeze it.
	*then
		-> escape_puzzle_interaction

@escape_puzzle_view_alcohollamp
	*say
		You look at the alcohol burner. Judging by the marks and scratches on it, it seems like it has been used frequently. You can use anything on the burner to heat it up.
	*then
		-> escape_puzzle_interaction

@escape_puzzle_view_newspaper
	*say
		You look at the newspaper. After Expanding it carefully. It reads, Magic Daily. Customer complaints about the wand containers from Juan’s Wonderful One-Stop Wand Warehouse are not strong enough to protect their luxury wands. Juan responded that all their containers are made by death metal, which is the hardest metal in the world. The problem must be caused by improper use.
	*then
		-> escape_puzzle_interaction

@escape_puzzle_view_trash
	*say
		You look at the trash bin. You find a crumbled piece, dirty piece of newspaper. It seems that he was using it to wipe his table. You can read the newspaper.
	*then
		-> escape_puzzle_interaction

@escape_puzzle_view_metalbox
	*say
		You look at the metal box. On the cover, it writes, Wand, of The Sylvan Forest. You flip it over. On the bottom, it has a stamp that reads, Juan’s Wonderful One-Stop Wand Warehouse. When you try to remove the cover, the box glows an alarming red. The man must have put some spells on the box, so he is the only one who can open it. If you want to open it, you need to find a way to break it.
	*then
		-> escape_puzzle_interaction

@escape_puzzle_view_chest
	*say
		You look at the chest. It isn't locked. You open it up easily. In the chest, you see a long metal box, and an alcohol burner.
	*then
		-> escape_puzzle_interaction

@escape_puzzle_open_notebook
	*say
		You open up the notebook. What keyword do you want to search?
	*then
		-> escape_puzzle_notebook_search

@escape_puzzle_notebook_search
	*say
		
	*recap
		You can search different keywords to flip the notebook according to bookmarks. Or you can close the notebook if you finish searching.
	*reprompt
		You can search different keywords to flip the notebook according to bookmarks. Or you can close the notebook if you finish searching.
	*then
		hear death metal, metal {
			-> escape_puzzle_notebook_search_deathmetal
		}
		hear black berry {
			-> escape_puzzle_notebook_search_blackberry
		}

		hear fang flower {
			-> escape_puzzle_notebook_search_fangflower
		}

		hear mandrake {
			-> escape_puzzle_notebook_search_mandrake
		}

		hear long distance travel portal, portal, long distance, travel portal {
			-> escape_puzzle_notebook_search_portal
		}
		hear close the notebook {
			-> escape_puzzle_notebook_close
		}

		hear wand, wand of the sylvan forest {
			-> escape_puzzle_notebook_search_wand
		}

		hear juan, ice, barrel, flower, alcohol lamp, flower stand, machine, chest, box {
			-> escape_puzzle_notebook_cannotfind
		}

@escape_puzzle_notebook_cannotfind
	*say
		That bookmark doesn't exist.
	*then
		-> escape_puzzle_interaction

@escape_puzzle_notebook_search_wand
	*say
		You search if there's a book mark about the Wand of The Sylvan Forest, and then you flip the notebook to that page. It reads. This wand is Hand carved from the trees of Sylvan Glade, it holds immense power. I use it to operate my long distance travel portal.
	*then
		-> escape_puzzle_notebook_search

@escape_puzzle_notebook_close
	*say
		You close the notebook.
	*then
		-> escape_puzzle_interaction

@escape_puzzle_notebook_search_portal
	*say
		You search if there's a book mark about the long distance travel portal, and then you flip the notebook to that page. It reads. I put a Transportalate spell on it, and use, wand of the sylvan forest to operate it. So I can travel through the world. As long as, I have the dirt from the place I want to travel to. Grab the dirt in the hand,  stand on the portal, and say, travel. I will be there immediately. Easily say, travel back, I will be on the portal again.
	*then
		flag readportal
		-> escape_puzzle_notebook_search

@escape_puzzle_notebook_search_mandrake
	*say
		You search if there's a book mark about mandrakes, and then you flip the notebook to that page. It reads. Mandrake can be found in the magic realm, my hometown. I transplanted it from the area around the broken down greenhouse.
	*then
		-> escape_puzzle_notebook_search

@escape_puzzle_notebook_search_fangflower
	*say
		You search if there's a book mark about the fang flower, and then you flip the notebook to that page. It reads. I brought the fang flower back from a strange place. Several years ago, I recieved a bottle of dirt from a spice market. I used the dirt to travel through the portal into another world. The sky over there was dark and the plants were glowing. I took the fang flower from there and travel back immediately.
	*then
		-> escape_puzzle_notebook_search

@escape_puzzle_notebook_search_blackberry
	*say
		You search if there's a book mark about black berries, and then you flip the notebook to that page. It reads. blackberry is been found from oasis springs. But when I first steped into this cave, I found it's also grows here. So I transplanted it into the pot to remember it is the only living form in this cave before I came.
	*then
		-> escape_puzzle_notebook_search

@escape_puzzle_notebook_search_deathmetal
	*say
		You search if there's a book mark about death metal, and then you flip the notebook to that page. It reads. Death metal is the hardest metal in the world. It will survive from any external force. But, research found, an alternated hot and cold will destory its form.
	*then
		-> escape_puzzle_notebook_search

@escape_puzzle_view_notebook
	*say
		You look at the notebook. It's a heavy notebook. Dozens of bookmarks stick on pages. At anytime, you can open the notebook to search different keywords, so you can flip the notebook according to bookmarks.
	*then
		-> escape_puzzle_interaction

@escape_puzzle_view_table
	*say
		You look at the table. It's right in front of you. On top of the table, you see a notebook, and a wooden barrel.
	*then
		-> escape_puzzle_interaction

